{"version":3,"sources":["lib/randInt.js","lib/clipboard.js","generator/modules/index.js","generator/modules/roll.js","generator/modules/rand.js","generator/modules/randInt.js","generator/modules/regex.js","generator/modules/isInRange.js","generator/modules/permutate.js","generator/modules/evalAtCtx.js","generator/modules/createExecutor.js","storage/Entry.js","storage/Table.js","generator/appendModifiers.js","storage/NpcSchema.js","storage/TableCollection.js","lib/str.js","components/StorageAccordion.jsx","components/NPC/EDisplayModes.js","storage/Filter.js","components/TableFilter.jsx","storage/GeneratedEntry.js","storage/NpcData.js","components/NPC/DetailViewEntry.jsx","components/NPC/ArticleContent.jsx","components/NPC/MenuBar.jsx","components/NPC/DetailView.jsx","components/NPC/ArticleView.jsx","view/NpcView.jsx","storage/Session.js","components/DataTableView.jsx","view/DataView.jsx","view/HomeView.jsx","routes.js","components/HeaderBarLink.jsx","components/HeaderBar.jsx","view/ViewContainer.jsx","App.jsx","index.js","lib/rand.js","data sync /^/tables.*/.json$"],"names":["module","exports","min","max","Math","ceil","floor","random","html","container","document","createElement","innerHTML","style","position","pointerEvents","opacity","body","appendChild","window","getSelection","removeAllRanges","range","createRange","selectNode","addRange","execCommand","err","console","error","removeChild","roll","tablePath","data","table","TableCollection","get","getTable","filter","ignore","rand","match","value","require","split","randInt","preset","undefined","params","map","str","parseInt","ret","includes","regex","RegExp","test","rangeParams","permutate","log","result","length","push","splice","VARIABLE_REGEX","PURE_VARIABLE_REGEX","inlineEval","text","context","replace","group","code","ctx","fullText","lodash","assign","Function","call","e","evalAtCtx","parseMacro","macro","execFunc","args","createExecutor","executor","evaledArgs","Execs","accumulateEntries","onUndefinedKey","reduce","accum","entryData","i","entry","Entry","from","key","getKey","this","weight","redirect","source","modifiers","stringify","description","articleContent","children","canReroll","collection","idx","readFrom","index","childrenWithoutKeys","hasSource","tableCollection","evaluateWithData","getSourceTableKey","Object","keys","Table","events","EventTarget","valueMacro","entries","keyPath","obj","entriesWithoutKeys","rows","getKeyPathFromTablePath","values","dispatchOnChangedRowCount","indexOf","prev","next","dispatchEvent","CustomEvent","detail","callback","addEventListener","removeEventListener","getRows","hasFilter","type","getFilterType","getOptions","current","toAppend","cloneDeep","hasValueMacro","filterContext","getDefaultFilter","hasRedirector","redirector","getRedirector","rollable","Array","isArray","shift","presetEntry","find","totalWeight","row","getWeight","weight_sum","warn","chooseRandomWithWeight","getKeyPath","hasGlobalModifiers","getGlobalModifiers","globalModifierEntry","matched","toPairs","modifier","hasOwnProperty","concat","mapValues","modifierList","targetProperty","curve","keyframes","currentIndex","nextIndex","valueInt","getInt","lowerIndex","higherIndex","lowerInput","higherInput","t","lerped","toIntOp","intOp","EVENT_ONCHANGEDFILTER","COLUMNS","accessor","Header","Field","category","NpcSchema","fields","fieldOrder","generationOrder","categories","schema","fieldData","field","addField","getCategory","sort","loadItem","directory","fileName","isIndex","content","itemPath","accumulator","itemPathSplit","slice","join","immediateDirectory","item","assignIn","mapKeys","_","loadTableEntry","TABLE_COLLECTION_CACHE","tables","npcSchema","loadTables","EVENT_ONCHANGED","initialize","event","missingKeyDatum","getTablePathFromKeyPath","getTableKeys","set","camelCaseToTitle","word","toUpperCase","substr","toLowerCase","StorageAccordion","storageKey","entryComponentType","active","useState","storage","expandedEntryKeys","setExpandedEntryKeys_state","setExpandedEntryKeys","remove","isEntryExpanded","handleAccordionClick","removeExpandedEntryKey","Accordion","margin","entryKey","entryProps","React","storageAccordianComponent","onClick","DISPLAY_MODES","Readable","Detailed","getDisplayIconForMode","displayMode","getNextDisplayMode","Filter","all","allFilters","TableFilter","tableKey","setValue","onDropdownChanged","isValueAValidFilter","defaultFilter","marginTop","marginBottom","minValue","maxValue","onChange","Dropdown","fluid","search","selection","multiple","placeholder","options","EntryLinker","owner","property","onEvent","subscribingTo","subscribed","entryPath","npc","getEntry","entryPaths","uniq","forEach","path","getEntryForPath","add","evt","appendArgsForEntry","a","linker","onEvt","GeneratedEntry","npcData","schemaEntry","stringifyLinker","onStringifyLinkerEvent","bind","stringifyCached","generationDependencyLinker","onGenerationDependencyEvent","modifyingLinker","onModifiersChanged","collectionLinker","onCollectionEntriesChanged","modifierSources","totalModifyingValue","forcedFilter","postOperationModifiers","generated","generatedChildren","parent","getField","name","toPath","getSource","globalData","sourceTableKey","getCanReroll","dispatchToSubscriptions","getModifierFor","unsubscribe","getModifyingEntryKeys","getGenerationDependencies","getStringifyDependencies","getOurCollections","getPreset","clearSaveState","child","clearLinking","presetData","prevValueOrKey","getFilterValue","redirectPath","getGenerationMacro","hasChildren","getChildren","clone","readEntry","updateString","subscribe","getModifiedData","writeSaveState","dispatchToSubscribers","regenerate","onChildGenerated","localValue","getModifiedValue","toString","asString","tmpValues","generatedObjValue","getModifyingEntryData_internal","getModifierInternal","rawModifier","localData","getChildModifiedData","multiplier","m","multiply","adder","getModifyingEntryData","v","applyModifier","objectEqualityDeepRecursive","b","Error","getRawValue","postOperations","retVal","genEntry","getGeneratedEntry","getStringifyTemplate","getDescription","template","matchAll","getChild","localizedGlobalData","string","getArticleContent","assert","deps","getSubscribedKeys","entryKeys","getCollectionEntryKeys","subpath","NpcData","sever","items","remaining","has","updateSaveState","saveState","getSaveState","NPC_TEMPORARY_DATA","state","save","fullKey","itemCount","status","EVENTS","EVENT_INITIALIZED","getNpcSchema","onInitialized","getSchema","getFields","addEntry","sessionStorage","removeItem","regenerateAll","getState","JSON","parse","getItem","npcDataInUrl","queryString","location","stateString","encoded","encodeURIComponent","href","getGenerationOrder","loop","forAllEntries","setItem","makeModifierPopup","title","popupTitle","itemMap","Popup","trigger","as","EntryView","propertyKey","parentEntry","npcModifiedData","isMissingSourceTable","k","refresh","useEffect","onChanged","details","shortid","addListenerOnChanged","addListenerOnUpdateString","addListenerOnModified","addListenerOnUpdateCollection","removeListenerOnChanged","removeListenerOnUpdateString","removeListenerOnModified","removeListenerOnUpdateCollection","rawValue","modifiedValue","modifiersFromEntry","hasModifiers","modifiersOfEntry","getModifiedByEntryKeys","isModified","stringifyDeps","stringifySubscribed","generationDependencies","generationDependedOnBy","canRegenerate","collectionEntryKeys","collectionEntryObj","collectionEntry","isValueEquivalentToNone","Menu","secondary","Item","fitted","Title","Icon","Button","icon","Content","borderLeft","paddingLeft","marginLeft","Form","Group","widths","hasValue","label","control","color","stringified","childKey","childEntry","DataViewEntry","toSentenceCase","sentence","getRenderedText","InlineEntryComponent","getComponent","InlineEntryItem","rerollAs","renderedText","hoverable","fontWeight","size","getName","ArticleContent","usePlainText","createEntryItem","strength","dexterity","constitution","intelligence","wisdom","charisma","ethicalPositive","ethicalNeutral","ethicalNegative","moralPositive","moralNeutral","moralNegative","surname","pronouns","genderIdentity","genderExpression","sex","romanticIdentity","sexualIdentity","sexualOrientation","profession","occupationalArea","age","eyeColor","height","face","race","hair","skin","physicalTraitsMap","physicalTraits","List","deity","worship","quirkList","getLink","bulleted","desc","getDescriptionString","singular","n","realFeet","feet","toFeet","compact","striped","textAlign","Body","Row","Cell","MenuBar","switchDisplayMode","menuItemsRight","getEntryLink","borderless","pointing","copyToClipboard","renderToString","clear","marginRight","corner","DetailViewCategory","categoryFields","fieldKey","DetailView","props","getCategories","getEntriesForCategory","ArticleView","CURRENT_DISPLAYMODE_STORAGE","NpcView","parsedNpcData","getCurrentLinkData","protocol","host","pathname","refreshWith","setDisplayMode","nextMode","onTableCollectionChanged","generate","addOnChanged","removeOnChanged","onNpcInitialized","toggleOnInitialized","setState","Loader","View","view","getDataTable","getTableAtPath","DataTableView","dataTable","columns","useMemo","DataTable","rowCount","setRowCount","subscribeOnChangedRowCount","onChangedRowCount","unsubscribeOnChangedRowCount","useTable","getTableProps","getTableBodyProps","headerGroups","prepareRow","Container","headerGroup","getHeaderGroupProps","headers","column","HeaderCell","getHeaderProps","render","getRowProps","cells","cell","getCellProps","DataView","urlParams","getTableTree","makeTreeNode","pathItem","nodeDetails","allNodeProperties","subNodeProperties","hasTable","propKey","HomeView","Component","routes","HeaderBarLink","HeaderBar","onClearStorage","ViewContainer","page","App","onViewChanged","subscribeOnChanged","unsubscribeOnChanged","id","Routes","react","version","node","process","versions","ReactDOM","getElementById","webpackContext","req","webpackContextResolve","__webpack_require__","o","resolve"],"mappings":"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","file":"static/js/main.3a49a328.chunk.js","sourcesContent":["/**\r\n * Returns a random integer between min (inclusive) and max (inclusive).\r\n * The value is no lower than min (or the next integer greater than min\r\n * if min isn't an integer) and no greater than max (or the next integer\r\n * lower than max if max isn't an integer).\r\n * Using Math.round() will give you a non-uniform distribution!\r\n */\r\nmodule.exports = (min, max) =>\r\n{\r\n\tmin = Math.ceil(min);\r\n\tmax = Math.floor(max);\r\n\treturn Math.floor(Math.random() * (max - min + 1)) + min;\r\n}","\r\nfunction copyTextToClipboard(html)\r\n{\r\n\t// Create an iframe (isolated container) for the HTML\r\n  var container = document.createElement('div');\r\n  container.innerHTML = html;\r\n  \r\n  // Hide element\r\n  container.style.position = 'fixed';\r\n  container.style.pointerEvents = 'none';\r\n\tcontainer.style.opacity = 0;\r\n\t\r\n  // Mount the iframe to the DOM to make `contentWindow` available\r\n  document.body.appendChild(container);\r\n\r\n\t// Clear all selected nodes\r\n  window.getSelection().removeAllRanges();\r\n  \r\n  // Add the container as the only selected node\r\n  var range = document.createRange();\r\n  range.selectNode(container);\r\n  window.getSelection().addRange(range);\r\n\r\n  // Copy selected nodes to clipboard\r\n\ttry\r\n\t{\r\n\t\tdocument.execCommand('copy');\r\n\t}\r\n\tcatch (err)\r\n\t{\r\n\t\tconsole.error(err);\r\n\t}\r\n  \r\n  // Remove the iframe\r\n  document.body.removeChild(container);\r\n}\r\n\r\nmodule.exports = copyTextToClipboard;","import roll from './roll';\r\nimport rand from './rand';\r\nimport randInt from './randInt';\r\nimport regex from './regex';\r\nimport isInRange from './isInRange';\r\nimport permutate from './permutate';\r\n\r\nexport default {\r\n\troll: roll,\r\n\trand: rand,\r\n\trandInt: randInt,\r\n\tregex: regex,\r\n\trange: isInRange,\r\n\tpermutate: permutate,\r\n};","import TableCollection from '../../storage/TableCollection';\r\n\r\nexport default function exec(tablePath, data)\r\n{\r\n\tconst table = TableCollection.get().getTable(tablePath);\r\n\tif (!table)\r\n\t{\r\n\t\t//console.error(`Could not find table for path ${tablePath}`);\r\n\t\treturn undefined;\r\n\t}\r\n\treturn table.roll(data.filter, data, data.ignore);\r\n}","export default function exec(match)\r\n{\r\n\treturn {\r\n\t\tvalue: require('../../lib/rand')(match.split(','))\r\n\t};\r\n}","export default function exec(match, {preset, ignore})\r\n{\r\n\tif (preset !== undefined) return { value: preset };\r\n\tconst randInt = require('../../lib/randInt');\r\n\tconst params = match.split(',').map(str => parseInt(str, 10));\r\n\tlet ret = undefined;\r\n\tdo\r\n\t{\r\n\t\tret = randInt(params[0], params[1]);\r\n\t} while (ignore !== undefined && ignore.includes(ret))\r\n\treturn { value: ret };\r\n}","export default function exec(match, data)\r\n{\r\n\tif (data === undefined) return false;\r\n\tconst value = `${data.value}`;\r\n\treturn new RegExp(match).test(value);\r\n}","export default function exec(match, data)\r\n{\r\n\tconst rangeParams = match.split(',').map((str) => parseInt(str, 10));\r\n\treturn data !== undefined\r\n\t\t&& typeof data.value === 'number'\r\n\t\t&& rangeParams[0] <= data.value\r\n\t\t&& data.value <= rangeParams[1];\r\n}","export default function exec(match)\r\n{\r\n\tconsole.log(match);\r\n\tconst params = match.split(',');\r\n\tconst result = [];\r\n\twhile (params.length > 0)\r\n\t{\r\n\t\t// remove a random item from params, and add to the end of result\r\n\t\tresult.push(params.splice(\r\n\t\t\t// index of the next value\r\n\t\t\tMath.floor(Math.random() * params.length),\r\n\t\t\t1\r\n\t\t)[0]);\r\n\t}\r\n\tconsole.log(result);\r\n\treturn {\r\n\t\tvalue: result\r\n\t};\r\n}","import lodash from 'lodash';\r\nimport randInt from '../../lib/randInt';\r\n\r\n// https://stackoverflow.com/questions/8403108/calling-eval-in-particular-context\r\n// https://stackoverflow.com/questions/543533/restricting-eval-to-a-narrow-scope\r\nfunction evalAtCtx(code, ctx, fullText)\r\n{\r\n\t// Ignore the eslint warning about the Function contructor just being eval.\r\n\t// Yes eval is 'evil', but this is a controlled usage with pre-approved input.\r\n\t/*eslint no-new-func: 0*/\r\n\tconst context = lodash.assign({}, ctx, {\r\n\t\trandInt: randInt\r\n\t});\r\n\ttry\r\n\t{\r\n\t\treturn (new Function(`with(this) { return ${code}; }`).call(context));\r\n\t}\r\n\tcatch (e)\r\n\t{\r\n\t\t//console.error(`Error parsing \"${code}\" in text \"${fullText}\" for context`, lodash.cloneDeep(context), e);\r\n\t\treturn undefined;\r\n\t}\r\n}\r\n\r\n// if grouping has periods ('.'), then it definitely relies on another value external to the hierarchy\r\n// (all non-lineage values have at least a category and key, separated by a period)\r\nexport const VARIABLE_REGEX = new RegExp(/\\$\\((.*?)\\)/, 'g');\r\nexport const PURE_VARIABLE_REGEX = new RegExp(/\\$\\(([.a-zA-Z]*?)\\)/, 'g');\r\n\r\nexport function inlineEval(text, context)\r\n{\r\n\treturn text.replace(VARIABLE_REGEX, (match, group) => evalAtCtx(group, context, text));\r\n}","import Execs from './index';\r\nimport {inlineEval} from './evalAtCtx';\r\n\r\nexport function parseMacro(macro)\r\n{\r\n\tconst regex = new RegExp(`^\\\\{(.*):(.*)\\\\}$`);\r\n\tconst match = macro.match(regex);\r\n\tif (match && match.length >= 2)\r\n\t{\r\n\t\treturn {\r\n\t\t\texecFunc: match[1],\r\n\t\t\targs: match[2],\r\n\t\t};\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nexport function createExecutor(macro)\r\n{\r\n\tconst executor = parseMacro(macro);\r\n\tif (executor)\r\n\t{\r\n\t\treturn (data) => {\r\n\t\t\tconst evaledArgs = inlineEval(executor.args, data);\r\n\t\t\treturn Execs[executor.execFunc](evaledArgs, data);\r\n\t\t};\r\n\t}\r\n\treturn undefined;\r\n}","import {parseMacro} from '../generator/modules/createExecutor';\r\n\r\nexport function accumulateEntries(data, context, onUndefinedKey=undefined)\r\n{\r\n\treturn data.reduce((accum, entryData, i) =>\r\n\t{\r\n\t\tconst entry = Entry.from(entryData, i);\r\n\t\tif (entry.key === undefined)\r\n\t\t{\r\n\t\t\tif (onUndefinedKey !== undefined && typeof onUndefinedKey === 'function')\r\n\t\t\t{\r\n\t\t\t\tonUndefinedKey(entry);\r\n\t\t\t}\r\n\t\t}\r\n\t\taccum[entry.getKey()] = entry;\r\n\t\treturn accum;\r\n\t}, {});\r\n}\r\n\r\nexport class Entry\r\n{\r\n\r\n\tstatic from(data, idx)\r\n\t{\r\n\t\tconst entry = new Entry();\r\n\t\tentry.readFrom(data, idx);\r\n\t\treturn entry;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.weight = undefined;\r\n\t\tthis.key = undefined;\r\n\r\n\t\tthis.redirect = undefined;\r\n\t\tthis.source = undefined;\r\n\r\n\t\tthis.value = undefined;\r\n\t\tthis.modifiers = {};\r\n\r\n\t\tthis.stringify = undefined;\r\n\t\tthis.description = undefined;\r\n\t\tthis.articleContent = undefined;\r\n\r\n\t\tthis.children = [];\r\n\r\n\t\tthis.canReroll = undefined;\r\n\t\t/**\r\n\t\t * The key for another entry, whose value is an array,\r\n\t\t * which GeneratedEntries that this entry is a schema for,\r\n\t\t * are considered a part of during `GeneratedEntry#getModifiedData`.\r\n\t\t**/\r\n\t\tthis.collection = undefined;\r\n\t}\r\n\r\n\treadFrom(data, idx)\r\n\t{\r\n\t\tthis.weight = data.weight || 1;\r\n\t\tthis.key = data.key;\r\n\t\tthis.index = idx;\r\n\r\n\t\tthis.redirect = data.redirect;\r\n\t\tthis.source = data.source;\r\n\r\n\t\tthis.value = data.value;\r\n\t\tthis.modifiers = data.modifiers || {};\r\n\r\n\t\tthis.stringify = data.stringify;\r\n\t\tthis.description = data.description;\r\n\t\tthis.articleContent = data.articleContent;\r\n\r\n\t\tthis.childrenWithoutKeys = [];\r\n\t\tthis.children = accumulateEntries(data.children || [], `entry '${this.key}'`, (i) => this.childrenWithoutKeys.push(i));\r\n\r\n\t\tthis.canReroll = data.canReroll;\r\n\t\tthis.collection = data.collection;\r\n\t}\r\n\r\n\tgetKey()\r\n\t{\r\n\t\treturn this.key || this.index;\r\n\t}\r\n\r\n\thasSource()\r\n\t{\r\n\t\treturn typeof this.source === 'string';\r\n\t}\r\n\r\n\tgetSource()\r\n\t{\r\n\t\treturn this.source;\r\n\t}\r\n\r\n\tgetWeight()\r\n\t{\r\n\t\t// TODO: fetch from local storage\r\n\t\treturn this.weight;\r\n\t}\r\n\r\n\tgetSourceTableKey()\r\n\t{\r\n\t\tif (!this.hasSource()) return undefined;\r\n\t\tconst executor = parseMacro(this.source);\r\n\t\tif (executor.execFunc !== 'roll') return undefined;\r\n\t\treturn executor.args;\r\n\t}\r\n\r\n\tisMissingSourceTable(tableCollection, evaluateWithData)\r\n\t{\r\n\t\tif (!this.hasSource()) return false;\r\n\t\tconst tablePath = this.getSourceTableKey();\r\n\t\tif (!tablePath) return false;\r\n\t\treturn tableCollection.getTable(evaluateWithData(tablePath)) === undefined;\r\n\t}\r\n\r\n\thasRedirector()\r\n\t{\r\n\t\treturn typeof this.redirect === 'string';\r\n\t}\r\n\r\n\tgetRedirector()\r\n\t{\r\n\t\treturn this.redirect;\r\n\t}\r\n\r\n\thasChildren()\r\n\t{\r\n\t\treturn Object.keys(this.children).length > 0;\r\n\t}\r\n\r\n\tgetChildren() { return this.children; }\r\n\r\n\tgetStringifyTemplate()\r\n\t{\r\n\t\treturn this.stringify;\r\n\t}\r\n\r\n\tgetArticleContent()\r\n\t{\r\n\t\treturn this.articleContent;\r\n\t}\r\n\r\n\tgetDescription()\r\n\t{\r\n\t\treturn this.description;\r\n\t}\r\n\r\n\tgetCanReroll()\r\n\t{\r\n\t\treturn this.canReroll === undefined || this.canReroll === true;\r\n\t}\r\n\r\n}","import lodash from 'lodash';\r\nimport { accumulateEntries, Entry } from './Entry';\r\nimport { createExecutor } from '../generator/modules/createExecutor';\r\nimport appendModifiers from '../generator/appendModifiers';\r\nimport { inlineEval } from '../generator/modules/evalAtCtx';\r\n\r\n/**\r\n * Picks a random item from `entries`, using `entry.getWeight()` to get the weight for any\r\n * given item (assuming a weight of 1 if the function returns a falsey value).\r\n * Returns null if it was unable to determine a value. Assumes `entries` is non-empty.\r\n*/\r\nfunction chooseRandomWithWeight(entries)\r\n{\r\n\tconst totalWeight = entries.reduce((accum, row) => accum + (row.getWeight() || 1), 0);\r\n\tconst randInt = require('../lib/randInt')(1, totalWeight);\r\n\r\n\tvar weight_sum = 0;\r\n\tvar i;\r\n\tfor (i = 0; i < entries.length; i++)\r\n\t{\r\n\t\tweight_sum += entries[i].getWeight() || 1;\r\n\t\tif (randInt <= weight_sum)\r\n\t\t{\r\n\t\t\treturn entries[i];\r\n\t\t}\r\n\t}\r\n\r\n\tconsole.warn(`'Returning null from \\`chooseRandomWithWeight\\`. i=${i} weight_sum=${weight_sum}`, entries);\r\n\treturn null;\r\n}\r\n\r\n/**\r\n * A READONLY collective of randomizable entries with modifiers. It is loaded by a TableCollection,\r\n * and can be used to get a weighted random entry that it contains (see the `roll` function).\r\n*/\r\nexport default class Table\r\n{\r\n\r\n\tstatic EVENT_ONCHANGEDFILTER = 'onChangedFilter';\r\n\r\n\tstatic getTablePathFromKeyPath(keyPath)\r\n\t{\r\n\t\treturn keyPath.replace(/\\./g, '/');\r\n\t}\r\n\r\n\tstatic getKeyPathFromTablePath(tablePath)\r\n\t{\r\n\t\treturn tablePath.replace(/\\//g, '.');\r\n\t}\r\n\r\n\t// takes a json object\r\n\tstatic from(obj, key)\r\n\t{\r\n\t\tconst table = new Table();\r\n\t\ttable.key = key;\r\n\t\ttable.filter = obj.filter;\r\n\t\t// turn json data for a table's entry rows into objects\r\n\t\ttable.entriesWithoutKeys = [];\r\n\t\tif (obj.valueMacro)\r\n\t\t{\r\n\t\t\ttable.valueMacro = obj.valueMacro;\r\n\t\t\ttable.entries = null;\r\n\t\t}\r\n\t\telse if (obj.rows)\r\n\t\t{\r\n\t\t\ttable.entries = accumulateEntries(obj.rows, `table '${key}'`, (i) => table.entriesWithoutKeys.push(i));\r\n\t\t}\r\n\t\ttable.modifiers = obj.modifiers;\r\n\t\ttable.redirect = obj.redirect;\r\n\t\ttable.entry = obj.entry !== undefined ? Entry.from(obj.entry, -1) : undefined;\r\n\t\treturn table;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.events = new EventTarget();\r\n\r\n\t\tthis.key = undefined;\r\n\t\tthis.filter = undefined;\r\n\t\t// The macro used to generate a value based on the filter\r\n\t\tthis.valueMacro = undefined;\r\n\t\t// All the possible options available for randomization (and filtering)\r\n\t\tthis.entries = {};\r\n\t\t// Global modifiers that can (and should) be applied to any entry after being rolled.\r\n\t\tthis.modifiers = {};\r\n\r\n\t\tthis.redirect = undefined;\r\n\t}\r\n\r\n\tgetKey()\r\n\t{\r\n\t\treturn this.key;\r\n\t}\r\n\r\n\tgetKeyPath()\r\n\t{\r\n\t\treturn Table.getKeyPathFromTablePath(this.getKey());\r\n\t}\r\n\r\n\thasValueMacro()\r\n\t{\r\n\t\treturn this.valueMacro !== undefined;\r\n\t}\r\n\r\n\tlength()\r\n\t{\r\n\t\treturn this.entries !== null ? Object.keys(this.entries).length : 1;\r\n\t}\r\n\r\n\tgetRows()\r\n\t{\r\n\t\treturn this.entries !== null ? Object.values(this.entries) : [];\r\n\t}\r\n\r\n\taddRow(entry)\r\n\t{\r\n\t\tif (this.entries === null) { return; }\r\n\t\tthis.entries.push(entry);\r\n\t\tthis.dispatchOnChangedRowCount(this.entries.length - 1, this.entries.length);\r\n\t}\r\n\r\n\tremoveRow(entry)\r\n\t{\r\n\t\tif (this.entries === null) { return; }\r\n\t\tthis.entries.splice(this.entries.indexOf(entry), 1);\r\n\t\tthis.dispatchOnChangedRowCount(this.entries.length, this.entries.length - 1);\r\n\t}\r\n\r\n\tdispatchOnChangedRowCount(prev, next)\r\n\t{\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onChangedRowCount', {\r\n\t\t\tdetail: { prev, next }\r\n\t\t}));\r\n\t}\r\n\r\n\t// TODO: This will never work because Tables are deserialized from the local storage\r\n\tsubscribeOnChangedRowCount(callback)\r\n\t{\r\n\t\tconsole.error('Changed callbacks will never work on tables');\r\n\t\tthis.events.addEventListener('onChangedRowCount', callback);\r\n\t}\r\n\r\n\tunsubscribeOnChangedRowCount(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onChangedRowCount', callback);\r\n\t}\r\n\r\n\t// Viewing the table via react\r\n\r\n\tgetOptions()\r\n\t{\r\n\t\treturn this.getRows().map((entry) => ({\r\n\t\t\tkey: entry.getKey(), text: entry.getKey(), value: entry.getKey()\r\n\t\t}));\r\n\t}\r\n\r\n\thasFilter()\r\n\t{\r\n\t\treturn this.filter === undefined || this.filter !== false;\r\n\t}\r\n\r\n\tgetFilterType()\r\n\t{\r\n\t\treturn this.hasFilter() && this.filter !== undefined ? this.filter.type : undefined;\r\n\t}\r\n\r\n\tgetDefaultFilter()\r\n\t{\r\n\t\tswitch (this.getFilterType())\r\n\t\t{\r\n\t\t\tcase 'minMaxRange':\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmin: this.filter.min,\r\n\t\t\t\t\tmax: this.filter.max,\r\n\t\t\t\t};\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.getOptions();\r\n\t\t}\r\n\t}\r\n\r\n\thasGlobalModifiers()\r\n\t{\r\n\t\treturn this.modifiers !== null && this.modifiers !== undefined && Object.keys(this.modifiers).length > 0;\r\n\t}\r\n\r\n\tgetGlobalModifiers()\r\n\t{\r\n\t\treturn this.modifiers;\r\n\t}\r\n\r\n\thasRedirector()\r\n\t{\r\n\t\treturn this.redirect !== undefined;\r\n\t}\r\n\r\n\tgetRedirector()\r\n\t{\r\n\t\treturn this.redirect;\r\n\t}\r\n\r\n\t// Performing ops\r\n\r\n\troll(filter, context, ignore)\r\n\t{\r\n\t\tlet result = { value: undefined, modifiers: {} };\r\n\t\t\r\n\t\tif (this.entry !== undefined)\r\n\t\t{\r\n\t\t\tresult.value = lodash.cloneDeep(this.entry.value.value);\r\n\t\t\tresult.modifiers = lodash.cloneDeep(this.entry.value.modifiers);\r\n\t\t\tresult.entry = this.entry;\r\n\t\t}\r\n\t\telse if (this.hasValueMacro())\r\n\t\t{\r\n\t\t\tconst filterContext = { ...context, filter: (filter || this.getDefaultFilter()) };\r\n\t\t\tconst macro = createExecutor(this.valueMacro);\r\n\t\t\tif (macro === undefined) result.value = inlineEval(this.valueMacro, filterContext);\r\n\t\t\telse result.value = macro(filterContext).value;\r\n\t\t}\r\n\t\telse if (this.hasRedirector())\r\n\t\t{\r\n\t\t\tlet redirector = this.getRedirector();\r\n\r\n\t\t\tconst macro = createExecutor(`{roll:${redirector}}`);\r\n\t\t\tif (macro)\r\n\t\t\t{\r\n\t\t\t\tresult = macro({...context, filter: undefined});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tconst entry = (() => {\r\n\t\t\t\tconst rollable = this.getRows();\r\n\t\t\t\tif (context.preset !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\tconst preset = Array.isArray(context.preset) ? context.preset.shift() : context.preset;\r\n\t\t\t\t\tconst presetEntry = rollable.find((entry) => entry.getKey() === preset);\r\n\t\t\t\t\tif (presetEntry !== undefined) return presetEntry;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconsole.error(`Could not find entry with preset key ${preset} in table ${this.getKey()}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn chooseRandomWithWeight(\r\n\t\t\t\t\trollable.filter((entry) => (\r\n\t\t\t\t\t\t(filter === undefined || filter.includes(entry.getKey()))\r\n\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t(ignore === undefined || !ignore.includes(entry.getKey()))\r\n\t\t\t\t\t))\r\n\t\t\t\t);\r\n\t\t\t})();\r\n\t\t\tif (entry === null)\r\n\t\t\t{\r\n\t\t\t\tconsole.warn('Received null generated value. Maybe there are missing keys?', this.entriesWithoutKeys, this.getKeyPath());\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tresult.value = lodash.cloneDeep(entry.value);\r\n\t\t\tresult.modifiers = lodash.cloneDeep(entry.modifiers);\r\n\t\t\tresult.entry = entry;\r\n\t\t}\r\n\r\n\t\t// Modifiers which are determined based on scales or regexs on the generated value\r\n\t\tif (this.hasGlobalModifiers())\r\n\t\t{\r\n\t\t\tfor (let globalModifierEntry of this.getGlobalModifiers())\r\n\t\t\t{\r\n\t\t\t\tlet matched = globalModifierEntry.match === undefined;\r\n\t\t\t\tconst macro = globalModifierEntry.match !== undefined ? createExecutor(globalModifierEntry.match) : undefined;\r\n\t\t\t\tif (macro)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet matchResult = macro({ ...context, value: result.value });\r\n\t\t\t\t\tmatched = matchResult === true;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmatched = result.value === globalModifierEntry.match;\r\n\t\t\t\t}\r\n\t\t\t\tif (matched)\r\n\t\t\t\t{\r\n\t\t\t\t\tresult.modifiers = appendModifiers(result.modifiers, globalModifierEntry.modifiers);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tresult.modifiers = lodash.mapValues(result.modifiers, (modifierList, targetProperty) => {\r\n\t\t\tif (!Array.isArray(modifierList)) modifierList = [modifierList];\r\n\t\t\treturn modifierList.map((modifier) => {\r\n\t\t\t\t// Preprocess each modifier to ensure that the modifiers remaining are either numbers or strings\r\n\t\t\t\tif (typeof modifier === 'object')\r\n\t\t\t\t{\r\n\t\t\t\t\tswitch (modifier.type)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'curve':\r\n\t\t\t\t\t\t\tswitch (modifier.curve)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcase 'step':\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tconst keyframes = Object.keys(modifier.values);\r\n\t\t\t\t\t\t\t\t\t\tlet currentIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\tlet nextIndex = keyframes.length > 0 ? 0 : undefined;\r\n\t\t\t\t\t\t\t\t\t\twhile (nextIndex !== undefined\r\n\t\t\t\t\t\t\t\t\t\t\t&& parseInt(result.value, 10) > parseInt(keyframes[nextIndex], 10))\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tcurrentIndex = nextIndex;\r\n\t\t\t\t\t\t\t\t\t\t\tnextIndex++;\r\n\t\t\t\t\t\t\t\t\t\t\tif (nextIndex >= keyframes.length) nextIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn currentIndex ? modifier.values[keyframes[currentIndex]] : 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcase 'lerp':\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tconst valueInt = parseInt(result.value, 10);\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst keyframes = Object.keys(modifier.values);\r\n\t\t\t\t\t\t\t\t\t\tconst getInt = (i) => parseInt(keyframes[i], 10);\r\n\t\t\t\t\t\t\t\t\t\tlet lowerIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\tlet higherIndex = keyframes.length > 0 ? 0 : undefined;\r\n\t\t\t\t\t\t\t\t\t\twhile (higherIndex !== undefined\r\n\t\t\t\t\t\t\t\t\t\t\t&& valueInt > getInt(higherIndex))\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tlowerIndex = higherIndex;\r\n\t\t\t\t\t\t\t\t\t\t\thigherIndex++;\r\n\t\t\t\t\t\t\t\t\t\t\tif (higherIndex >= keyframes.length) higherIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (lowerIndex === undefined)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tlowerIndex = higherIndex;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse if (higherIndex === undefined)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\thigherIndex = lowerIndex;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst lowerInput = getInt(lowerIndex);\r\n\t\t\t\t\t\t\t\t\t\tconst higherInput = getInt(higherIndex);\r\n\t\t\t\t\t\t\t\t\t\tconst lowerMod = modifier.values[keyframes[lowerIndex]];\r\n\t\t\t\t\t\t\t\t\t\tconst higherMod = modifier.values[keyframes[higherIndex]];\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst t = (valueInt - lowerInput) / (higherInput !== lowerInput ? higherInput - lowerInput : higherInput);\r\n\t\t\t\t\t\t\t\t\t\tconst lerped = (1 - t) * lowerMod + (t * higherMod);\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (modifier.toIntOp === undefined) return lerped;\r\n\t\t\t\t\t\t\t\t\t\tconst intOp = Math[modifier.toIntOp];\r\n\t\t\t\t\t\t\t\t\t\tif (intOp === undefined)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.warn('Encountered unimplemented curve int cast operator:', modifier.toIntOp);\r\n\t\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\treturn intOp(lerped);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdefault: break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: break;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn modifier;\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n}\r\n\r\nTable.COLUMNS = [\r\n\t{\r\n\t\taccessor: 'weight',\r\n\t\tHeader: 'Weight',\r\n\t},\r\n\t{\r\n\t\taccessor: 'key',\r\n\t\tHeader: 'Key',\r\n\t}\r\n];\r\n","import lodash from 'lodash';\r\n\r\nexport default function appendModifiers(current, toAppend) {\r\n\treturn lodash.toPairs(toAppend).reduce((accum, [key, modifier]) => {\r\n\t\t\r\n\t\tif (!accum.hasOwnProperty(key)) accum[key] = [];\r\n\t\telse if (!Array.isArray(accum[key])) accum[key] = [accum[key]];\r\n\t\t\r\n\t\tif (Array.isArray(modifier)) accum[key] = accum[key].concat(modifier);\r\n\t\telse accum[key].push(modifier);\r\n\r\n\t\treturn accum;\r\n\t}, current);\r\n};","import lodash from 'lodash';\r\nimport { Entry } from './Entry';\r\n\r\nclass Field extends Entry\r\n{\r\n\r\n\tstatic from(data)\r\n\t{\r\n\t\tconst entry = new Field();\r\n\t\tentry.readFrom(data);\r\n\t\tentry.category = data.category;\r\n\t\treturn entry;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tsuper();\r\n\t\tthis.category = undefined;\r\n\t}\r\n\r\n\tgetKeyPath()\r\n\t{\r\n\t\treturn `${this.category}.${this.getKey()}`;\r\n\t}\r\n\r\n\tgetCategory()\r\n\t{\r\n\t\treturn this.category;\r\n\t}\r\n\r\n}\r\n\r\nexport default class NpcSchema\r\n{\r\n\r\n\t// takes a json object\r\n\tstatic from(obj)\r\n\t{\r\n\t\tconst schema = new NpcSchema();\r\n\r\n\t\tschema.generationOrder = obj.generationOrder;\r\n\t\t\r\n\t\tfor (let fieldData of obj.fieldOrder)\r\n\t\t{\r\n\t\t\tconst field = schema.addField(fieldData);\r\n\t\t\tschema.fieldOrder.push(field.getKeyPath());\r\n\t\t}\r\n\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.fields = {};\r\n\t\tthis.fieldOrder = [];\r\n\t\tthis.generationOrder = [];\r\n\t\tthis.categories = {};\r\n\t}\r\n\r\n\taddField(data)\r\n\t{\r\n\t\tconst field = Field.from(data);\r\n\t\tthis.fields[field.getKeyPath()] = field;\r\n\t\tthis.categories[field.getCategory()] = (this.categories[field.getCategory()] || []).concat([field.getKey()]);\r\n\t\treturn field;\r\n\t}\r\n\r\n\tgetFields()\r\n\t{\r\n\t\treturn lodash.values(this.fields);\r\n\t}\r\n\r\n\tgetField(keyPath)\r\n\t{\r\n\t\treturn this.fields[keyPath];\r\n\t}\r\n\r\n\tgetCategories()\r\n\t{\r\n\t\treturn Object.keys(this.categories).sort();\r\n\t}\r\n\r\n\tgetFieldsForCategory(category)\r\n\t{\r\n\t\treturn (this.categories[category] || []).sort();\r\n\t}\r\n\r\n\tgetFieldForCategory(category, key)\r\n\t{\r\n\t\treturn this.categories[category][key];\r\n\t}\r\n\r\n\tgetGenerationOrder()\r\n\t{\r\n\t\treturn this.generationOrder;\r\n\t}\r\n\r\n}\r\n","import lodash from 'lodash';\r\nimport Table from './Table';\r\nimport NpcSchema from './NpcSchema';\r\n\r\nfunction loadItem(directory, fileName)\r\n{\r\n\tconst data = require(`../data/tables${directory}${fileName}.json`);\r\n\tconst isIndex = Array.isArray(data);\r\n\tlet content = !isIndex ? data : data.reduce((accum, itemPath) => loadTableEntry(accum, directory, itemPath), {});\r\n\treturn { content, isIndex };\r\n}\r\n\r\nfunction loadTableEntry(accumulator, directory, itemPath)\r\n{\r\n\tconst itemPathSplit = itemPath.split('/');\r\n\tconst fileName = itemPathSplit.slice(-1).join('/');\r\n\tconst immediateDirectory = itemPathSplit.slice(0, -1).join('/');\r\n\tconst fullDirectory = `${directory}${itemPath}`.split('/').slice(0, -1).join('/') + '/';\r\n\tconst item = loadItem(fullDirectory, fileName);\r\n\tif (item.isIndex)\r\n\t{\r\n\t\tlodash.assignIn(accumulator, lodash.mapKeys(item.content, (_, key) => `${immediateDirectory}/${key}`));\r\n\t}\r\n\telse\r\n\t{\r\n\t\taccumulator[itemPath] = item.content;\r\n\t}\r\n\treturn accumulator;\r\n}\r\n\r\nconst events = new EventTarget();\r\nlet TABLE_COLLECTION_CACHE = undefined;\r\n\r\n/**\r\n * A collection of Tables which is loaded once at application start (or on demand after initial load).\r\n * This data is meant to be READONLY at runtime and does not reliably support changing or adding data.\r\n*/\r\nexport default class TableCollection\r\n{\r\n\r\n\t/** Event key for when the table collection is finished loading - either at app launch or user initiated. */\r\n\tstatic EVENT_ONCHANGED = 'onChanged';\r\n\r\n\t/** Returns the current iteration/collection of tables loaded from data. */\r\n\tstatic get()\r\n\t{\r\n\t\treturn TABLE_COLLECTION_CACHE;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a new table collection object and loads collection from data.\r\n\t*/\r\n\tstatic initialize()\r\n\t{\r\n\t\tconsole.log('Initializing table collection');\r\n\t\tTABLE_COLLECTION_CACHE = new TableCollection();\r\n\t\tTABLE_COLLECTION_CACHE.loadTables();\r\n\t\tTableCollection.dispatchEvent(TableCollection.EVENT_ONCHANGED, null, TABLE_COLLECTION_CACHE);\r\n\t}\r\n\r\n\t/**\r\n\t * Wipes the table collection singleton and immediately reinitializes.\r\n\t*/\r\n\tstatic clear()\r\n\t{\r\n\t\tconst prev = TableCollection.get();\r\n\t\tTABLE_COLLECTION_CACHE = null;\r\n\t\tTableCollection.dispatchEvent(TableCollection.EVENT_ONCHANGED, prev, null);\r\n\r\n\t\t// Re-Initialize\r\n\t\tTableCollection.initialize();\r\n\t}\r\n\r\n\tstatic addEventListener(event, callback)\r\n\t{\r\n\t\tevents.addEventListener(event, callback);\r\n\t}\r\n\r\n\tstatic removeEventListener(event, callback)\r\n\t{\r\n\t\tevents.removeEventListener(event, callback);\r\n\t}\r\n\r\n\tstatic addOnChanged(callback)\r\n\t{\r\n\t\tTableCollection.addEventListener(TableCollection.EVENT_ONCHANGED, callback);\r\n\t}\r\n\r\n\tstatic removeOnChanged(callback)\r\n\t{\r\n\t\tTableCollection.removeEventListener(TableCollection.EVENT_ONCHANGED, callback);\r\n\t}\r\n\r\n\t// NOTE: `prev` is outdated\r\n\tstatic dispatchEvent(event, prev, next)\r\n\t{\r\n\t\tevents.dispatchEvent(new CustomEvent(event, {\r\n\t\t\tdetail: { prev, next }\r\n\t\t}));\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.tables = {};\r\n\t\tthis.npcSchema = undefined;\r\n\t}\r\n\r\n\tloadTables()\r\n\t{\r\n\t\tthis.tables = lodash.mapValues(loadItem('/', 'index').content, Table.from);\r\n\t\tconsole.log(this.tables);\r\n\t\tconsole.log('Missing Keys:', lodash.values(this.tables).reduce((accum, table) => {\r\n\t\t\tconst missingKeyDatum = {};\r\n\t\t\tif (table.entriesWithoutKeys.length > 0)\r\n\t\t\t{\r\n\t\t\t\tmissingKeyDatum.entries = table.entriesWithoutKeys;\r\n\t\t\t}\r\n\t\t\tfor (let entry of lodash.values(table.entries))\r\n\t\t\t{\r\n\t\t\t\tif (entry.childrenWithoutKeys.length > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tmissingKeyDatum[entry.getKey()] = entry.childrenWithoutKeys;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (Object.keys(missingKeyDatum).length > 0)\r\n\t\t\t{\r\n\t\t\t\taccum[table.getKey()] = missingKeyDatum;\r\n\t\t\t}\r\n\t\t\treturn accum;\r\n\t\t}, {}))\r\n\r\n\t\tthis.npcSchema = NpcSchema.from(loadItem('/', 'npc').content);\r\n\t}\r\n\r\n\tgetNpcSchema()\r\n\t{\r\n\t\treturn this.npcSchema;\r\n\t}\r\n\r\n\tgetTableKeys()\r\n\t{\r\n\t\treturn Object.keys(this.tables).sort();\r\n\t}\r\n\r\n\tgetTables()\r\n\t{\r\n\t\treturn Object.values(this.tables);\r\n\t}\r\n\r\n\tgetTable(key)\r\n\t{\r\n\t\treturn this.tables.hasOwnProperty(key) ? this.tables[key] : undefined\r\n\t}\r\n\r\n\tgetTableAtPath(keyPath)\r\n\t{\r\n\t\treturn this.getTable(Table.getTablePathFromKeyPath(keyPath));\r\n\t}\r\n\r\n\tgetTableTree()\r\n\t{\r\n\t\treturn this.getTableKeys().reduce((accum, key) => {\r\n\t\t\treturn lodash.set(accum, this.tables[key].getKeyPath() + '.table', this.tables[key]);\r\n\t\t}, {});\r\n\t}\r\n\r\n}","export function camelCaseToTitle(str)\r\n{\r\n\treturn str\r\n\t\t.split(/(?=[A-Z])/)\r\n\t\t.map(\r\n\t\t\t(word) => `${word[0].toUpperCase()}${word.substr(1).toLowerCase()}`\r\n\t\t).join(' ');\r\n}","import React, { useState } from 'react';\r\nimport storage from 'local-storage';\r\nimport lodash from 'lodash';\r\nimport { Accordion } from 'semantic-ui-react';\r\n\r\nexport function StorageAccordion({\r\n\tstorageKey,\r\n\tentryComponentType,\r\n\tentries,\r\n\tactive, // if the item the accordion is in is currently rendering (not collapsed)\r\n})\r\n{\r\n\tconst [expandedEntryKeys, setExpandedEntryKeys_state] = useState(storage.get(storageKey) || []);\r\n\tfunction setExpandedEntryKeys(keys)\r\n\t{\r\n\t\tif (keys.length > 0) storage.set(storageKey, keys);\r\n\t\telse storage.remove(storageKey);\r\n\t\tsetExpandedEntryKeys_state(keys);\r\n\t}\r\n\tfunction addExpandedEntryKey(key) { setExpandedEntryKeys(expandedEntryKeys.concat([key])); }\r\n\tfunction removeExpandedEntryKey(key) { setExpandedEntryKeys(expandedEntryKeys.filter((item) => item !== key)); }\r\n\tfunction isEntryExpanded(key) { return expandedEntryKeys.includes(key); }\r\n\r\n\tconst handleAccordionClick = (_, { index }) =>\r\n\t{\r\n\t\tif (!isEntryExpanded(index)) addExpandedEntryKey(index);\r\n\t\telse removeExpandedEntryKey(index);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Accordion style={{ margin: 0 }}>\r\n\t\t\t{lodash.toPairs(entries).map(([entryKey, entryProps]) => (\r\n\t\t\t\tReact.createElement(entryProps.storageAccordianComponent || entryComponentType, {\r\n\t\t\t\t\t...entryProps,\r\n\t\t\t\t\tkey: entryKey,\r\n\t\t\t\t\tactive: isEntryExpanded(entryKey) && (active === undefined || active === true),\r\n\t\t\t\t\tonClick: handleAccordionClick,\r\n\t\t\t\t})\r\n\t\t\t))}\r\n\t\t</Accordion>\r\n\t);\r\n}\r\n","\r\nexport const DISPLAY_MODES = {\r\n\tReadable: 'Readable',\r\n\tDetailed: 'Detailed',\r\n};\r\n\r\nexport function getDisplayIconForMode(displayMode)\r\n{\r\n\tswitch (displayMode)\r\n\t{\r\n\t\tcase DISPLAY_MODES.Readable: return 'eye';\r\n\t\tcase DISPLAY_MODES.Detailed: return 'archive';\r\n\t\tdefault: return 'question';\r\n\t}\r\n}\r\n\r\nexport function getNextDisplayMode(displayMode)\r\n{\r\n\tswitch (displayMode)\r\n\t{\r\n\t\tcase DISPLAY_MODES.Readable: return DISPLAY_MODES.Detailed;\r\n\t\tcase DISPLAY_MODES.Detailed: return DISPLAY_MODES.Readable;\r\n\t\tdefault: return DISPLAY_MODES.Detailed;\r\n\t}\r\n}\r\n\r\nexport function getDisplayModeSwitchLabel(displayMode)\r\n{\r\n\treturn `Switch to ${getNextDisplayMode(displayMode).toLowerCase()} mode`;\r\n}\r\n","import storage from 'local-storage';\r\n\r\nexport default class Filter\r\n{\r\n\r\n\tstatic all()\r\n\t{\r\n\t\treturn (storage.get('filters') || {});\r\n\t}\r\n\r\n\tstatic get(key)\r\n\t{\r\n\t\treturn Filter.all()[key];\r\n\t}\r\n\r\n\tstatic set(key, filter)\r\n\t{\r\n\t\tconst allFilters = Filter.all();\r\n\t\tallFilters[key] = filter;\r\n\t\tstorage.set('filters', allFilters);\r\n\t}\r\n\r\n\tstatic remove(key)\r\n\t{\r\n\t\tconst allFilters = Filter.all();\r\n\t\tdelete allFilters[key];\r\n\t\tstorage.set('filters', allFilters);\r\n\t}\r\n\r\n\tstatic clear()\r\n\t{\r\n\t\tstorage.set('filters', {});\r\n\t}\r\n\r\n}","import React, { useState } from 'react';\r\nimport { Dropdown } from 'semantic-ui-react';\r\nimport Filter from '../storage/Filter';\r\nimport InputRange from 'react-input-range';\r\nimport 'react-input-range/lib/css/index.css';\r\n\r\n// For ranges: https://github.com/davidchin/react-input-range\r\nexport function TableFilter({\r\n\ttableCollection, tableKey, storageKey\r\n})\r\n{\r\n\r\n\tfunction getTable()\r\n\t{\r\n\t\treturn tableCollection ? tableCollection.getTable(tableKey) : undefined;\r\n\t}\r\n\r\n\tconst [value, setValue] = useState(Filter.get(storageKey) || undefined);\r\n\r\n\tconst table = getTable();\r\n\tif (!table) return <div />;\r\n\r\n\tfunction isValueAValidFilter(value)\r\n\t{\r\n\t\tswitch (table.getFilterType())\r\n\t\t{\r\n\t\t\tcase 'minMaxRange':\r\n\t\t\t\treturn typeof value === 'object' && value.min && value.max;\r\n\t\t\tdefault:\r\n\t\t\t\treturn Array.isArray(value) && value.length > 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onDropdownChanged(value)\r\n\t{\r\n\t\tif (isValueAValidFilter(value))\r\n\t\t{\r\n\t\t\tFilter.set(storageKey, value);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tFilter.remove(storageKey);\r\n\t\t}\r\n\t\tsetValue(value);\r\n\t}\r\n\r\n\tswitch (table.getFilterType())\r\n\t{\r\n\t\tcase 'minMaxRange':\r\n\t\t\tconst defaultFilter = table.getDefaultFilter();\r\n\t\t\treturn (\r\n\t\t\t\t<div style={{marginTop: '15px', marginBottom: '15px'}}>\r\n\t\t\t\t\t<InputRange\r\n\t\t\t\t\t\tminValue={defaultFilter.min}\r\n\t\t\t\t\t\tmaxValue={defaultFilter.max}\r\n\t\t\t\t\t\tvalue={value || defaultFilter}\r\n\t\t\t\t\t\tonChange={onDropdownChanged}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\tdefault:\r\n\t\t\treturn (\r\n\t\t\t\t<Dropdown\r\n\t\t\t\t\tfluid search selection multiple\r\n\t\t\t\t\tplaceholder={'No filter'}\r\n\t\t\t\t\toptions={table ? table.getDefaultFilter() : []}\r\n\t\t\t\t\tvalue={value || []}\r\n\t\t\t\t\tonChange={(_, { value }) => onDropdownChanged(value)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t}\r\n}\r\n","import Filter from './Filter';\r\nimport lodash from 'lodash';\r\nimport { createExecutor } from '../generator/modules/createExecutor';\r\nimport { inlineEval, PURE_VARIABLE_REGEX } from '../generator/modules/evalAtCtx';\r\nimport NpcData from './NpcData';\r\n\r\nfunction objectEqualityDeepRecursive(a, b) {\r\n\tfor(const key in a) {\r\n\t\t\tif(!(key in b) || !objectEqualityDeepRecursive(a[key], b[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t}\r\n\tfor(var key in b) {\r\n\t\t\tif(!(key in a) || !objectEqualityDeepRecursive(a[key], b[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nclass EntryLinker\r\n{\r\n\r\n\tconstructor(owner, property, onEvent)\r\n\t{\r\n\t\tthis.owner = owner;\r\n\t\tthis.property = property;\r\n\t\t// entry keys that our owner has subscribed to\r\n\t\tthis.subscribingTo = [];\r\n\t\t// entry keys that have subscribed to our owner\r\n\t\tthis.subscribed = [];\r\n\t\tthis.onEvent = onEvent;\r\n\t}\r\n\r\n\tgetEntryForPath(entryPath)\r\n\t{\r\n\t\treturn this.owner.npc.getEntry(entryPath);\r\n\t}\r\n\r\n\tsubscribe(entryPaths)\r\n\t{\r\n\t\tthis.subscribingTo = lodash.uniq(entryPaths);\r\n\t\tentryPaths.forEach((path) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(path);\r\n\t\t\tif (entry) entry[this.property].add(this.owner);\r\n\t\t});\r\n\t}\r\n\r\n\tunsubscribe(entryPaths)\r\n\t{\r\n\t\tthis.subscribingTo = this.subscribingTo.filter((key) => !entryPaths.includes(key));\r\n\t\tentryPaths.forEach((path) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(path);\r\n\t\t\tif (entry) entry[this.property].remove(this.owner);\r\n\t\t});\r\n\t}\r\n\r\n\tadd(entry)\r\n\t{\r\n\t\tthis.subscribed.push(entry.getKeyPath());\r\n\t\tthis.subscribed = lodash.uniq(this.subscribed);\r\n\t}\r\n\r\n\tremove(entry)\r\n\t{\r\n\t\tconst entryKey = entry.getKeyPath();\r\n\t\tthis.subscribed = this.subscribed.filter((key) => key !== entryKey);\r\n\t}\r\n\r\n\tgetSubscribedKeys()\r\n\t{\r\n\t\treturn this.subscribed;\r\n\t}\r\n\r\n\tdispatchToSubscriptions(evt, args, appendArgsForEntry=(a)=>a)\r\n\t{\r\n\t\tthis.subscribingTo.forEach((entryPath) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(entryPath);\r\n\t\t\tconst linker = entry ? entry[this.property] : undefined;\r\n\t\t\tconst onEvt = linker ? linker.onEvent : undefined;\r\n\t\t\tif (onEvt) onEvt(evt, appendArgsForEntry(args, entryPath));\r\n\t\t});\r\n\t}\r\n\r\n\tdispatchToSubscribers(evt, args)\r\n\t{\r\n\t\tthis.subscribed.forEach((entryPath) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(entryPath);\r\n\t\t\tconst linker = entry ? entry[this.property] : undefined;\r\n\t\t\tconst onEvt = linker ? linker.onEvent : undefined;\r\n\t\t\tif (onEvt) onEvt(evt, args);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default class GeneratedEntry\r\n{\r\n\r\n\tconstructor(npcData)\r\n\t{\r\n\t\tthis.npc = npcData;\r\n\r\n\t\tthis.events = new EventTarget();\r\n\t\tthis.schemaEntry = undefined;\r\n\r\n\t\tthis.stringifyLinker = new EntryLinker(this, 'stringifyLinker', this.onStringifyLinkerEvent.bind(this));\r\n\t\tthis.stringifyCached = undefined;\r\n\r\n\t\tthis.generationDependencyLinker = new EntryLinker(this, 'generationDependencyLinker', this.onGenerationDependencyEvent.bind(this));\r\n\t\tthis.modifyingLinker = new EntryLinker(this, 'modifyingLinker', this.onModifiersChanged.bind(this));\r\n\t\tthis.collectionLinker = new EntryLinker(this, 'collectionLinker', this.onCollectionEntriesChanged.bind(this));\r\n\t\t\r\n\t\tthis.modifierSources = {};\r\n\t\tthis.totalModifyingValue = 0;\r\n\t\tthis.forcedFilter = {};\r\n\t\tthis.postOperationModifiers = {};\r\n\r\n\t\tthis.category = undefined;\r\n\t\tthis.key = undefined;\r\n\r\n\t\tthis.generated = undefined;\r\n\t\tthis.generatedChildren = undefined;\r\n\t}\r\n\r\n\treadEntry(entry)\r\n\t{\r\n\t\tthis.schemaEntry = entry;\r\n\t\tthis.key = entry.getKey();\r\n\t}\r\n\r\n\tgetKeyPath()\r\n\t{\r\n\t\tif (this.key === undefined) return undefined;\r\n\t\telse if (this.category !== undefined) return `${this.category}.${this.key}`;\r\n\t\telse if (this.parent !== undefined) return `${this.parent.getKeyPath()}.${this.key}`;\r\n\t\telse return this.key;\r\n\t}\r\n\r\n\tgetName()\r\n\t{\r\n\t\tconst field = this.getField();\r\n\t\tif (field.name !== undefined) return field.name;\r\n\t\tconst path = lodash.toPath(this.getKeyPath());\r\n\t\treturn path[path.length - 1]\r\n\t\t\t.split(/(?=[A-Z])/)\r\n\t\t\t.map(\r\n\t\t\t\t(word) => `${word[0].toUpperCase()}${word.substr(1).toLowerCase()}`\r\n\t\t\t).join(' ');\r\n\t}\r\n\r\n\tgetField()\r\n\t{\r\n\t\treturn this.schemaEntry;\r\n\t}\r\n\r\n\tgetGenerationMacro()\r\n\t{\r\n\t\tconst field = this.getField();\r\n\t\tif (!field.hasSource()) return undefined;\r\n\t\tconst macro = createExecutor(field.getSource());\r\n\t\tif (macro === undefined)\r\n\t\t{\r\n\t\t\tconsole.warn('Failed to find a valid exec source functor for field:', field);\r\n\t\t}\r\n\t\treturn macro;\r\n\t}\r\n\r\n\thasFilter(tableCollection, globalData)\r\n\t{\r\n\t\tconst sourceTableKey = this.getField().getSourceTableKey(tableCollection);\r\n\t\tconst table = sourceTableKey !== undefined ? tableCollection.getTable(inlineEval(sourceTableKey, globalData)) : undefined;\r\n\t\treturn table ? table.hasFilter() : false;\r\n\t}\r\n\r\n\tgetFilterValue()\r\n\t{\r\n\t\tconst forcedFilter = Object.values(this.forcedFilter);\r\n\t\treturn forcedFilter.length > 0 ? forcedFilter : Filter.get(this.getKeyPath());\r\n\t}\r\n\r\n\tgetCanReroll()\r\n\t{\r\n\t\treturn this.schemaEntry.getCanReroll() && (!this.parent || this.parent.getCanReroll());\r\n\t}\r\n\r\n\tclearLinking()\r\n\t{\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('remove', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\t\tthis.modifyingLinker.unsubscribe(this.getModifyingEntryKeys());\r\n\t\tthis.generationDependencyLinker.unsubscribe(this.getGenerationDependencies());\r\n\t\tthis.stringifyLinker.unsubscribe(this.getStringifyDependencies());\r\n\t\t\r\n\t\tthis.collectionLinker.dispatchToSubscriptions('remove', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t});\r\n\t\tthis.collectionLinker.unsubscribe(this.getOurCollections());\r\n\t}\r\n\r\n\tregenerate(globalData, getPreset)\r\n\t{\r\n\t\tthis.clearSaveState();\r\n\r\n\t\tif (this.generatedChildren)\r\n\t\t{\r\n\t\t\tlodash.values(this.generatedChildren).forEach((child) => child.clearLinking());\r\n\t\t}\r\n\t\tthis.clearLinking();\r\n\r\n\t\tconst presetData = typeof getPreset === 'function' ? getPreset(this) : undefined;\r\n\r\n\t\tlet prevValueOrKey = undefined;\r\n\t\tif (this.generated !== undefined)\r\n\t\t{\r\n\t\t\tprevValueOrKey = this.generated.value;\r\n\t\t\tif (this.generated.entry !== undefined)\r\n\t\t\t{\r\n\t\t\t\tprevValueOrKey = this.generated.entry.getKey();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst filter = this.getFilterValue();\r\n\t\tif (filter !== undefined && filter.length === 1 && filter.includes(prevValueOrKey))\r\n\t\t{\r\n\t\t\tprevValueOrKey = undefined;\r\n\t\t}\r\n\r\n\t\tconst context = {\r\n\t\t\t...globalData,\r\n\t\t\tfilter: filter,\r\n\t\t\tignore: prevValueOrKey !== undefined ? [prevValueOrKey] : undefined,\r\n\t\t\tpreset: presetData,\r\n\t\t};\r\n\t\tthis.generated = null;\r\n\r\n\t\tif (this.schemaEntry.value)\r\n\t\t{\r\n\t\t\tthis.generated = {\r\n\t\t\t\tvalue: presetData !== undefined ? presetData : this.schemaEntry.value\r\n\t\t\t};\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tlet redirectPath = [];\r\n\t\t\tdo\r\n\t\t\t{\r\n\t\t\t\tlet macro = undefined;\r\n\t\t\t\t// grab the redirector from the previous generated entry\r\n\t\t\t\tlet redirector = this.generated && this.generated.entry && this.generated.entry.hasRedirector() ? this.generated.entry.getRedirector() : undefined;\r\n\t\t\t\tif (redirector !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\tmacro = createExecutor(`{roll:${redirector}}`);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmacro = this.getGenerationMacro();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (macro === undefined) break;\r\n\t\t\t\t\r\n\t\t\t\tthis.generated = macro(redirector === undefined ? context : {...context, filter: undefined});\r\n\t\t\t\tif (this.generated && this.generated.entry && this.generated.entry.hasRedirector())\r\n\t\t\t\t{\r\n\t\t\t\t\tredirectPath.push(this.generated.entry.getKey());\r\n\t\t\t\t}\r\n\t\t\t} while (this.generated && this.generated.entry && this.generated.entry.hasRedirector());\r\n\t\t\tif (this.generated && redirectPath.length > 0)\r\n\t\t\t{\r\n\t\t\t\tthis.generated.redirectPath = redirectPath;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.generatedChildren = this.generated && this.generated.entry && this.generated.entry.hasChildren()\r\n\t\t\t? lodash.mapValues(this.generated.entry.getChildren(), (child) =>\r\n\t\t\t{\r\n\t\t\t\tconst clone = new GeneratedEntry(this.npc);\r\n\t\t\t\tclone.readEntry(child);\r\n\t\t\t\tclone.parent = this;\r\n\t\t\t\treturn clone;\r\n\t\t\t}) : undefined;\r\n\t\tif (this.generatedChildren === undefined && this.schemaEntry && this.schemaEntry.hasChildren())\r\n\t\t{\r\n\t\t\tthis.generatedChildren = lodash.mapValues(this.schemaEntry.getChildren(), (child) =>\r\n\t\t\t{\r\n\t\t\t\tconst clone = new GeneratedEntry(this.npc);\r\n\t\t\t\tclone.readEntry(child);\r\n\t\t\t\tclone.parent = this;\r\n\t\t\t\treturn clone;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.updateString(globalData);\r\n\t\tthis.stringifyLinker.subscribe(this.getStringifyDependencies());\r\n\r\n\t\t// temporarily modify globalData until it can be accounted for later\r\n\t\t// we should probably just mark the data as dirty here instead of passing it through functions\r\n\t\tthis.getModifiedData(globalData);\r\n\t\tthis.writeSaveState();\r\n\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onChanged', { detail: {} }));\r\n\r\n\t\tthis.collectionLinker.subscribe(this.getOurCollections());\r\n\t\tthis.collectionLinker.dispatchToSubscriptions('add', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t});\r\n\r\n\t\tthis.stringifyLinker.dispatchToSubscribers('onChanged', { globalData });\r\n\r\n\t\tthis.generationDependencyLinker.subscribe(this.getGenerationDependencies());\r\n\t\tthis.generationDependencyLinker.dispatchToSubscribers('onChanged', { key: this.getKeyPath(), globalData });\r\n\r\n\t\tthis.modifyingLinker.subscribe(this.getModifyingEntryKeys());\r\n\r\n\t\tif (this.generatedChildren)\r\n\t\t{\r\n\t\t\tlodash.values(this.generatedChildren).forEach((child) => child.regenerate(globalData, getPreset));\r\n\t\t}\r\n\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('add', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\r\n\t\tif (this.parent) this.parent.onChildGenerated(this);\r\n\t}\r\n\r\n\tonChildGenerated(child)\r\n\t{\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('remove', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onChanged', { detail: {} }));\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('add', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\t}\r\n\r\n\tgetGeneratedEntry()\r\n\t{\r\n\t\treturn this.generated ? this.generated.entry : undefined;\r\n\t}\r\n\r\n\tgetModifiedData(values)\r\n\t{\r\n\t\tconst localValue = this.getModifiedValue();\r\n\t\tlodash.set(values, this.getKeyPath(), lodash.assignIn(\r\n\t\t\ttypeof localValue === 'object' ? localValue : {},\r\n\t\t\t{\r\n\t\t\t\ttoString: () => typeof localValue === 'object' ? undefined : `${localValue}`,\r\n\t\t\t\tasString: this.toString(),\r\n\t\t\t}\r\n\t\t));\r\n\t\tif (this.hasChildren())\r\n\t\t{\r\n\t\t\tlodash.values(this.getChildren()).forEach(\r\n\t\t\t\t(child) => child.getModifiedData(values)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tgetChildModifiedData(values)\r\n\t{\r\n\t\tconst tmpValues = {};\r\n\t\tlodash.values(this.getChildren()).forEach(\r\n\t\t\t(child) => child.getModifiedData(tmpValues)\r\n\t\t);\r\n\t\tlodash.assign(values, lodash.get(tmpValues, this.getKeyPath()));\r\n\t}\r\n\r\n\taddListenerOnChanged(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onChanged', callback);\r\n\t}\r\n\r\n\tremoveListenerOnChanged(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onChanged', callback);\r\n\t}\r\n\r\n\t/**\r\n\t * If, when generated, the entry resulted in a tangible value (not just children and a stringify).\r\n\t**/\r\n\thasValue()\r\n\t{\r\n\t\tconst generated = this.generated || {};\r\n\t\treturn generated.value !== undefined;\r\n\t}\r\n\r\n\tgetRawValue()\r\n\t{\r\n\t\tconst generated = this.generated || {};\r\n\t\tconst generatedObjValue = generated.value !== undefined && generated.value.value !== undefined ? generated.value.value : generated.value;\r\n\t\tif (generatedObjValue !== undefined) return generatedObjValue;\r\n\t\treturn generated.entry !== undefined ? generated.entry.getKey() : undefined;\r\n\t}\r\n\r\n\tgetModifyingEntryData_internal()\r\n\t{\r\n\t\treturn (this.generated ? this.generated.modifiers : undefined) || {};\r\n\t}\r\n\r\n\tgetModifyingEntryData()\r\n\t{\r\n\t\treturn lodash.mapValues(this.getModifyingEntryData_internal(), (value, key) => this.getModifierFor(key));\r\n\t}\r\n\r\n\tgetModifierFor(keyPath)\r\n\t{\r\n\t\tconst getModifierInternal = (rawModifier) => {\r\n\t\t\tif (typeof rawModifier === 'object')\r\n\t\t\t{\r\n\t\t\t\tswitch (rawModifier.type)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 'multiply':\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst localData = {};\r\n\t\t\t\t\t\tthis.getChildModifiedData(localData);\r\n\t\t\t\t\t\tconst multiplier = inlineEval(rawModifier.value, localData);\r\n\t\t\t\t\t\tif (multiplier === undefined) return rawModifier;\r\n\t\t\t\t\t\tconst m = parseInt(multiplier, 10);\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: rawModifier.type,\r\n\t\t\t\t\t\t\tmultiply: m,\r\n\t\t\t\t\t\t\ttoString: () => `*${m}`,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcase 'multiplyAdd':\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst localData = {};\r\n\t\t\t\t\t\tthis.getChildModifiedData(localData);\r\n\t\t\t\t\t\tconst multiplier = inlineEval(rawModifier.multiply, localData);\r\n\t\t\t\t\t\tconst adder = inlineEval(rawModifier.add, localData);\r\n\t\t\t\t\t\tif (multiplier === undefined || adder === undefined) return rawModifier;\r\n\t\t\t\t\t\tconst m = parseInt(multiplier, 10);\r\n\t\t\t\t\t\tconst a = parseInt(adder, 10);\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: rawModifier.type,\r\n\t\t\t\t\t\t\tmultiply: m,\r\n\t\t\t\t\t\t\tadd: a,\r\n\t\t\t\t\t\t\ttoString: () => `*${m}+${a}`,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn rawModifier;\r\n\t\t};\r\n\r\n\t\tconst rawModifier = this.getModifyingEntryData_internal()[keyPath];\r\n\t\tif (Array.isArray(rawModifier)) return rawModifier.map(getModifierInternal);\r\n\t\telse return getModifierInternal(rawModifier);\r\n\t}\r\n\r\n\t/**\r\n\t * Get the key paths of entries this item is currently modifying.\r\n\t**/\r\n\tgetModifyingEntryKeys()\r\n\t{\r\n\t\treturn Object.keys(this.getModifyingEntryData());\r\n\t}\r\n\r\n\t/**\r\n\t * Get the key paths of entries this item is currently being modified by.\r\n\t**/\r\n\tgetModifiedByEntryKeys()\r\n\t{\r\n\t\treturn {\r\n\t\t\t...this.modifierSources,\r\n\t\t\t...this.postOperationModifiers,\r\n\t\t\t...this.forcedFilter,\r\n\t\t}\r\n\t}\r\n\r\n\taddListenerOnModified(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onModified', callback);\r\n\t}\r\n\r\n\tremoveListenerOnModified(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onModified', callback);\r\n\t}\r\n\r\n\t/**\r\n\t * Called when some entry adds or removes their modifiers from the total list of things this item is modified by.\r\n\t**/\r\n\tonModifiersChanged(evt, args)\r\n\t{\r\n\t\tconst forcedFilter = lodash.cloneDeep(this.forcedFilter);\r\n\t\tif (Array.isArray(args.value)) args.value.forEach((v) => this.applyModifier(evt, args.source, v));\r\n\t\telse this.applyModifier(evt, args.source, args.value);\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onModified', { detail: {} }));\r\n\r\n\t\tconst globalData = this.npc.getModifiedData();\r\n\t\t// TODO: This check is very inefficient, but it works...\r\n\t\tif (!objectEqualityDeepRecursive(forcedFilter, this.forcedFilter))\r\n\t\t{\r\n\t\t\tthis.regenerate(globalData);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.updateString(globalData);\r\n\t\t}\r\n\t}\r\n\r\n\tapplyModifier(evt, source, value)\r\n\t{\r\n\t\tswitch (evt)\r\n\t\t{\r\n\t\t\tcase 'add':\r\n\t\t\t\t// These are forced value filters, where the value argument is the key of the desired value\r\n\t\t\t\tif (typeof value === 'string')\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.forcedFilter[source] = value;\r\n\t\t\t\t}\r\n\t\t\t\t// A macro of sorts that is executed on compilation\r\n\t\t\t\telse if (typeof value === 'object')\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.postOperationModifiers[source] = value;\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof value !== 'number') throw new Error(`Cannot use a modifier that is not a number: ${value}`);\r\n\t\t\t\telse if (value !== 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modifierSources[source] = value;\r\n\t\t\t\t\tthis.totalModifyingValue += value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'remove':\r\n\t\t\t\t// These are forced value filters, where the value argument is the key of the desired value\r\n\t\t\t\tif (typeof value === 'string')\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.forcedFilter[source];\r\n\t\t\t\t}\r\n\t\t\t\t// A macro of sorts that is executed on compilation\r\n\t\t\t\telse if (typeof value === 'object')\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.postOperationModifiers[source];\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof value !== 'number') throw new Error(`Cannot use a modifier that is not a number: ${value}`);\r\n\t\t\t\telse if (value !== 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.modifierSources[source];\r\n\t\t\t\t\tthis.totalModifyingValue -= value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(`Unknown modifiers changed event ${evt}, ${source}: ${value}`);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tgetModifiedValue()\r\n\t{\r\n\t\tlet value = this.getRawValue();\r\n\t\tif (typeof value === 'number')\r\n\t\t{\r\n\t\t\tconst postOperations = Object.values(this.postOperationModifiers);\r\n\t\t\tif (postOperations.length > 0)\r\n\t\t\t{\r\n\t\t\t\tvalue = postOperations.reduce((retVal, modifier) => {\r\n\t\t\t\t\tswitch (modifier.type)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'multiplyAdd':\r\n\t\t\t\t\t\t\treturn retVal * modifier.multiply + modifier.add;\r\n\t\t\t\t\t\tcase 'multiply':\r\n\t\t\t\t\t\t\treturn retVal;// * modifier.multiply;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tthrow new Error('Cannot process modifier object', value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, value);\r\n\t\t\t}\r\n\t\t\tvalue += this.totalModifyingValue;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tgetStringifyTemplate()\r\n\t{\r\n\t\tconst genEntry = this.getGeneratedEntry();\r\n\t\treturn (genEntry ? genEntry.getStringifyTemplate() : undefined) || (this.schemaEntry.stringify);\r\n\t}\r\n\r\n\tgetDescription()\r\n\t{\r\n\t\tconst genEntry = this.getGeneratedEntry();\r\n\t\treturn (genEntry ? genEntry.getDescription() : undefined) || (this.schemaEntry.description);\r\n\t}\r\n\r\n\tgetStringifyDependencies()\r\n\t{\r\n\t\tconst template = this.getStringifyTemplate();\r\n\t\tif (!template) return [];\r\n\t\tconst allMatches = Array.from(template.matchAll(PURE_VARIABLE_REGEX));\r\n\t\tconst allNonlineageReplacements = allMatches.map((match) => match[1]).filter((key) => this.getChild(key) === undefined);\r\n\t\treturn allNonlineageReplacements;\r\n\t}\r\n\r\n\tupdateString(globalData)\r\n\t{\r\n\t\tconst localizedGlobalData = lodash.cloneDeep(globalData);\r\n\t\tthis.getChildModifiedData(localizedGlobalData);\r\n\r\n\t\tconst stringify = this.getStringifyTemplate();\r\n\t\tthis.stringifyCached = stringify ? inlineEval(stringify, localizedGlobalData) : `${this.getModifiedValue()}`;\r\n\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onUpdateString', {\r\n\t\t\tdetail: {\r\n\t\t\t\tstring: this.stringifyCached\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tif (this.parent) this.parent.updateString(globalData);\r\n\t}\r\n\r\n\taddListenerOnUpdateString(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onUpdateString', callback);\r\n\t}\r\n\r\n\tremoveListenerOnUpdateString(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onUpdateString', callback);\r\n\t}\r\n\r\n\tisValueEquivalentToNone()\r\n\t{\r\n\t\treturn this.toString() === 'none';\r\n\t}\r\n\r\n\ttoString()\r\n\t{\r\n\t\treturn this.stringifyCached;\r\n\t}\r\n\r\n\tgetArticleContent(globalData)\r\n\t{\r\n\t\tconst genEntry = this.getGeneratedEntry();\r\n\t\tconst articleContent = (genEntry ? genEntry.getArticleContent() : undefined) || (this.schemaEntry.articleContent);\r\n\t\tif (articleContent === undefined) { return this.toString(); }\r\n\r\n\t\tconst localizedGlobalData = lodash.cloneDeep(globalData);\r\n\t\tthis.getChildModifiedData(localizedGlobalData);\r\n\r\n\t\treturn inlineEval(articleContent, localizedGlobalData);\r\n\t}\r\n\r\n\tgetDescriptionString(globalData)\r\n\t{\r\n\t\tconst description = this.getDescription();\r\n\t\tif (description === undefined) { return undefined; }\r\n\t\t\r\n\t\tconst localizedGlobalData = lodash.cloneDeep(globalData);\r\n\t\tthis.getChildModifiedData(localizedGlobalData);\r\n\r\n\t\treturn inlineEval(description, localizedGlobalData);\r\n\t}\r\n\r\n\tonStringifyLinkerEvent(evt, { globalData })\r\n\t{\r\n\t\tconsole.assert(evt === 'onChanged');\r\n\t\tthis.updateString(globalData);\r\n\t}\r\n\r\n\tgetGenerationDependencies()\r\n\t{\r\n\t\tconst field = this.getField();\r\n\t\tconst source = field.hasSource() ? field.getSource() : undefined;\r\n\t\tif (!source) return [];\r\n\t\tconst deps = [];\r\n\t\tfor (let match of source.matchAll(PURE_VARIABLE_REGEX))\r\n\t\t\tdeps.push(match[1]);\r\n\t\treturn deps;\r\n\t}\r\n\r\n\taddListenerOnUpdateCollection(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onUpdateCollection', callback);\r\n\t}\r\n\r\n\tremoveListenerOnUpdateCollection(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onUpdateCollection', callback);\r\n\t}\r\n\r\n\tonGenerationDependencyEvent(evt, { key, globalData })\r\n\t{\r\n\t\tconsole.assert(evt === 'onChanged');\r\n\t\tFilter.remove(this.getKeyPath());\r\n\t\tthis.regenerate(globalData);\r\n\t}\r\n\r\n\tgetOurCollections()\r\n\t{\r\n\t\treturn this.schemaEntry.collection !== undefined ? [this.schemaEntry.collection] : [];\r\n\t}\r\n\r\n\tgetCollectionEntryKeys()\r\n\t{\r\n\t\treturn this.collectionLinker.getSubscribedKeys();\r\n\t}\r\n\r\n\tonCollectionEntriesChanged(evt, {source})\r\n\t{\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onUpdateCollection', {\r\n\t\t\tdetail: {\r\n\t\t\t\tentryKeys: this.getCollectionEntryKeys()\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\thasChildren()\r\n\t{\r\n\t\treturn this.generatedChildren && Object.keys(this.generatedChildren).length > 0;\r\n\t}\r\n\r\n\tgetChildren()\r\n\t{\r\n\t\treturn this.hasChildren() ? this.generatedChildren : {};\r\n\t}\r\n\r\n\tgetChild(subpath)\r\n\t{\r\n\t\tconst { items, remaining } = NpcData.sever(subpath);\r\n\t\tconst children = this.getChildren();\r\n\t\tif (children.hasOwnProperty(items[0]))\r\n\t\t{\r\n\t\t\tconst child = children[items[0]];\r\n\t\t\treturn remaining.length > 0 ? child.getChild(remaining) : child;\r\n\t\t}\r\n\t\telse if (lodash.has(this.getRawValue(), subpath)) return this;\r\n\t\telse\r\n\t\t{\r\n\t\t\t//console.warn(`Could not find entry with subpath ${subpath} under entry ${this.getKeyPath()}`);\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tgetSaveState()\r\n\t{\r\n\t\tconst generated = this.generated || {};\r\n\t\tif (generated.entry) return generated.entry.getKey();\r\n\t\telse if (typeof generated.value !== 'object') return generated.value;\r\n\t\telse return undefined;\r\n\t}\r\n\r\n\tclearSaveState()\r\n\t{\r\n\t\tthis.npc.updateSaveState(this.getKeyPath(), undefined);\r\n\t\tObject.values(this.getChildren()).forEach((child) => child.clearSaveState());\r\n\t}\r\n\r\n\twriteSaveState()\r\n\t{\r\n\t\tlet saveState = this.getSaveState();\r\n\t\tif (this.generated && Array.isArray(this.generated.redirectPath)) saveState = this.generated.redirectPath.concat([saveState]);\r\n\t\tthis.npc.updateSaveState(this.getKeyPath(), saveState);\r\n\t}\r\n\r\n}","import lodash from 'lodash';\r\nimport TableCollection from './TableCollection';\r\nimport GeneratedEntry from './GeneratedEntry';\r\nimport * as queryString from 'query-string';\r\n\r\nlet NPC_TEMPORARY_DATA = null;\r\n\r\nexport default class NpcData\r\n{\r\n\r\n\tstatic EVENTS = new EventTarget();\r\n\tstatic EVENT_INITIALIZED = 'onInitialized';\r\n\r\n\tstatic sever(fullKey, itemCount = 1)\r\n\t{\r\n\t\tconst path = lodash.toPath(fullKey);\r\n\t\treturn {\r\n\t\t\titems: path.slice(0, itemCount),\r\n\t\t\tremaining: path.slice(itemCount).join('.'),\r\n\t\t};\r\n\t}\r\n\r\n\tstatic toggleOnInitialized(status, callback)\r\n\t{\r\n\t\tswitch (status)\r\n\t\t{\r\n\t\t\tcase 'on':\r\n\t\t\t\tNpcData.EVENTS.addEventListener(NpcData.EVENT_INITIALIZED, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'off':\r\n\t\t\t\tNpcData.EVENTS.removeEventListener(NpcData.EVENT_INITIALIZED, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getSchema()\r\n\t{\r\n\t\tconst tableCollection = TableCollection.get();\r\n\t\treturn tableCollection ? tableCollection.getNpcSchema() : undefined;\r\n\t}\r\n\r\n\tstatic initialize(onInitialized)\r\n\t{\r\n\t\tconst schema = NpcData.getSchema();\r\n\t\tif (!schema) { return; }\r\n\t\t\r\n\t\tconsole.log('Initializing NPC data');\r\n\t\tconst data = new NpcData();\r\n\r\n\t\tconst fields = schema.getFields();\r\n\t\tfor (let field of fields)\r\n\t\t{\r\n\t\t\tdata.addEntry(field);\r\n\t\t}\r\n\r\n\t\tNPC_TEMPORARY_DATA = data;\r\n\r\n\t\tif (typeof onInitialized === 'function')\r\n\t\t{\r\n\t\t\tonInitialized(data);\r\n\t\t}\r\n\r\n\t\tNpcData.EVENTS.dispatchEvent(new CustomEvent(this.EVENT_INITIALIZED, {\r\n\t\t\tdetail: { npc: NPC_TEMPORARY_DATA }\r\n\t\t}));\r\n\t}\r\n\r\n\tsetState(state)\r\n\t{\r\n\t\tthis.saveState = state;\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tstatic get()\r\n\t{\r\n\t\treturn NPC_TEMPORARY_DATA;\r\n\t}\r\n\r\n\tstatic clear()\r\n\t{\r\n\t\twindow.sessionStorage.removeItem('npc');\r\n\t\tNpcData.initialize((npc) => npc.regenerateAll(NpcData.getState() || {}));\r\n\t}\r\n\r\n\tstatic getState()\r\n\t{\r\n\t\treturn JSON.parse(window.sessionStorage.getItem('npc'));\r\n\t}\r\n\r\n\tstatic getCurrentLinkData()\r\n\t{\r\n\t\tconst npcDataInUrl = queryString.parse(window.location.search);\r\n\t\tif (typeof npcDataInUrl.npc === 'string') \r\n\t\t{\r\n\t\t\treturn JSON.parse(npcDataInUrl.npc);\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tstatic getLink()\r\n\t{\r\n\t\tconst stateString = JSON.stringify(NpcData.getState());\r\n\t\tconst encoded = encodeURIComponent(stateString);\r\n\t\treturn `${window.location.href.slice(0, -1)}?npc=${encoded}`;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.events = new EventTarget();\r\n\r\n\t\tthis.entries = {};\r\n\t\tthis.categories = {};\r\n\r\n\t\tthis.saveState = {};\r\n\t}\r\n\r\n\ttoggleListener(event, status, callback)\r\n\t{\r\n\t\tswitch (status)\r\n\t\t{\r\n\t\t\tcase 'on':\r\n\t\t\t\tthis.events.addEventListener(event, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'off':\r\n\t\t\t\tthis.events.removeEventListener(event, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t}\r\n\r\n\taddEntry(field)\r\n\t{\r\n\t\tconst entry = new GeneratedEntry(this);\r\n\t\tentry.readEntry(field);\r\n\t\tentry.category = field.getCategory();\r\n\t\tthis.entries[entry.getKeyPath()] = entry;\r\n\t\tthis.categories[field.category] = (this.categories[field.getCategory()] || []).concat([field.getKey()]);\r\n\t}\r\n\r\n\tgetEntry(keyPath)\r\n\t{\r\n\t\tconst { items, remaining } = NpcData.sever(keyPath, 2);\r\n\t\tconst entry = this.entries[`${items[0]}.${items[1]}`];\r\n\t\treturn remaining.length > 0 && entry !== undefined ? entry.getChild(remaining) : entry;\r\n\t}\r\n\r\n\tgetCategories()\r\n\t{\r\n\t\treturn Object.keys(this.categories).sort();\r\n\t}\r\n\r\n\tgetEntriesForCategory(category)\r\n\t{\r\n\t\treturn (this.categories[category] || []).sort();\r\n\t}\r\n\r\n\tregenerateAll(presetData)\r\n\t{\r\n\t\tconst schema = NpcData.getSchema();\r\n\t\tconst globalData = {};\r\n\t\tfor (let entryKey of schema.getGenerationOrder())\r\n\t\t{\r\n\t\t\tconst entry = this.entries[entryKey];\r\n\t\t\tconst getPreset = (e) => presetData !== undefined ? lodash.cloneDeep(presetData[e.getKeyPath()]) : undefined;\r\n\t\t\tentry.regenerate(globalData, getPreset);\r\n\t\t\tentry.getModifiedData(globalData);\r\n\t\t}\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tforAllEntries(loop)\r\n\t{\r\n\t\tlodash.values(this.entries).forEach(loop);\r\n\t}\r\n\r\n\tgetModifiedData()\r\n\t{\r\n\t\tconst values = {}\r\n\t\tthis.forAllEntries((entry) => entry.getModifiedData(values));\r\n\t\treturn values;\r\n\t}\r\n\r\n\tupdateSaveState(key, state)\r\n\t{\r\n\t\tif (state === undefined) { delete this.saveState[key]; }\r\n\t\telse this.saveState[key] = state;\r\n\t}\r\n\r\n\tsave()\r\n\t{\r\n\t\twindow.sessionStorage.setItem('npc', JSON.stringify(this.saveState));\r\n\t}\r\n\r\n}","/*eslint no-unused-vars: [0, {\"args\": \"after-used\", \"argsIgnorePattern\": \"^_\"}]*/\r\n\r\nimport React, { useEffect } from 'react';\r\nimport { Accordion, Icon, Button, Menu, Form, Popup, Header } from 'semantic-ui-react';\r\nimport { TableFilter } from '../TableFilter';\r\nimport { StorageAccordion } from '../StorageAccordion';\r\nimport { camelCaseToTitle } from '../../lib/str';\r\nimport NpcData from '../../storage/NpcData';\r\nimport * as shortid from 'shortid';\r\nimport { inlineEval } from '../../generator/modules/evalAtCtx';\r\nimport lodash from 'lodash';\r\n\r\n/*\r\nfunction DataViewEntryCategory({\r\n\ttitleKey, description, children,\r\n\tactive, onClick\r\n})\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Accordion.Title\r\n\t\t\t\tindex={titleKey}\r\n\t\t\t\tactive={active}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t>\r\n\t\t\t\t{camelCaseToTitle(titleKey)} <Icon name='dropdown' />\r\n\t\t\t</Accordion.Title>\r\n\t\t\t<Accordion.Content active={active}>\r\n\t\t\t\t{description}\r\n\t\t\t\t{children}\r\n\t\t\t</Accordion.Content>\r\n\t\t</div>\r\n\t);\r\n}\r\n//*/\r\n\r\nfunction makeModifierPopup(title, popupTitle, itemMap)\r\n{\r\n\treturn (\r\n\t\t<Popup\r\n\t\t\ttrigger={<label>{title} ({Object.keys(itemMap).length})</label>}\r\n\t\t\tcontent={(\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Header as='h5'>{popupTitle}</Header>\r\n\t\t\t\t\t{Object.keys(itemMap).map((key) => (\r\n\t\t\t\t\t\t<div key={key}>\r\n\t\t\t\t\t\t\t{key}: {JSON.stringify(itemMap[key])}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nfunction EntryView({\r\n\ttableCollection, npcSchema, npc,\r\n\tpropertyKey, storageKey,\r\n\tentry, parentEntry,\r\n\tactive, onClick, // from StorageAccordion\r\n})\r\n{\r\n\t// TODO: this is ineffecient, but it cant be passed in b/c passing through react copies objects, does not pass by ref.\r\n\t// maybe add functionality to cache data until it is marked as dirty.\r\n\tconst npcModifiedData = npc.getModifiedData();\r\n\tconst sourceTableKey = parentEntry.getSourceTableKey(tableCollection);\r\n\tconst isMissingSourceTable = parentEntry.isMissingSourceTable(tableCollection, (k) => inlineEval(k, npcModifiedData));\r\n\r\n\tconst refresh = React.useState(undefined)[1];\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tfunction onChanged({ details }) { refresh(shortid.generate()); }\r\n\t\tentry.addListenerOnChanged(onChanged);\r\n\t\tentry.addListenerOnUpdateString(onChanged);\r\n\t\tentry.addListenerOnModified(onChanged);\r\n\t\tentry.addListenerOnUpdateCollection(onChanged);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tentry.removeListenerOnChanged(onChanged)\r\n\t\t\tentry.removeListenerOnUpdateString(onChanged);\r\n\t\t\tentry.removeListenerOnModified(onChanged);\r\n\t\t\tentry.removeListenerOnUpdateCollection(onChanged);\r\n\t\t};\r\n\t});\r\n\r\n\tconst rawValue = entry.getRawValue();\r\n\tconst modifiedValue = entry.getModifiedValue();\r\n\tconst hasFilter = entry.hasFilter(tableCollection, npcModifiedData);\r\n\tconst modifiersFromEntry = entry.getModifyingEntryData();\r\n\tconst modifiersFromEntryCount = entry.getModifyingEntryKeys().length;\r\n\tconst hasModifiers = modifiersFromEntryCount > 0;\r\n\tconst modifiersOfEntry = entry.getModifiedByEntryKeys();\r\n\tconst isModified = Object.keys(modifiersOfEntry).length > 0;\r\n\tconst stringifyDeps = entry.getStringifyDependencies();\r\n\tconst stringifySubscribed = entry.stringifyLinker.getSubscribedKeys();\r\n\tconst generationDependencies = entry.getGenerationDependencies();\r\n\tconst generationDependedOnBy = entry.generationDependencyLinker.getSubscribedKeys();\r\n\tconst canRegenerate = entry.getCanReroll();\r\n\tconst collectionEntryKeys = entry.getCollectionEntryKeys();\r\n\tconst collectionEntryObj = collectionEntryKeys.reduce((accum, entryKey) =>\r\n\t{\r\n\t\tconst collectionEntry = npc.getEntry(entryKey);\r\n\t\tif (collectionEntry && !collectionEntry.isValueEquivalentToNone())\r\n\t\t\taccum[entryKey] = collectionEntry.toString();\r\n\t\treturn accum;\r\n\t}, {})\r\n\r\n\tif (active)\r\n\t{\r\n\t\t//console.log(entry, hasFilter, table);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Menu secondary style={{ marginBottom: 0 }}>\r\n\t\t\t\t<Menu.Item fitted>\r\n\t\t\t\t\t<Accordion.Title\r\n\t\t\t\t\t\tindex={propertyKey}\r\n\t\t\t\t\t\tactive={!isMissingSourceTable && active}\r\n\t\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{!isMissingSourceTable && <Icon name='dropdown' />}\r\n\t\t\t\t\t\t{camelCaseToTitle(propertyKey)} - &nbsp;\r\n\t\t\t\t\t\t<span>{entry.toString()}</span>\r\n\t\t\t\t\t\t{isMissingSourceTable && (\r\n\t\t\t\t\t\t\t<span> - No generator available</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Accordion.Title>\r\n\t\t\t\t</Menu.Item>\r\n\t\t\t\t{!isMissingSourceTable && canRegenerate && <Menu.Item fitted position='right'>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\ticon={'refresh'}\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tentry.regenerate(npcModifiedData);\r\n\t\t\t\t\t\t\tnpc.save();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tcontent={camelCaseToTitle(propertyKey)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Menu.Item>}\r\n\t\t\t</Menu>\r\n\t\t\t{!isMissingSourceTable && active && <Accordion.Content\r\n\t\t\t>\r\n\t\t\t\t<div style={{\r\n\t\t\t\t\tborderLeft: '2px solid rgba(34,36,38,.15)',\r\n\t\t\t\t\tpaddingLeft: '10px',\r\n\t\t\t\t\tmarginLeft: '7px',\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t<Form.Group widths={'equal'} style={hasFilter && !entry.hasValue() ? { margin: 0 } : {}}>\r\n\t\t\t\t\t\t\t{hasFilter && (\r\n\t\t\t\t\t\t\t\t<Form.Field\r\n\t\t\t\t\t\t\t\t\tlabel={'Filter'}\r\n\t\t\t\t\t\t\t\t\tcontrol={TableFilter}\r\n\t\t\t\t\t\t\t\t\ttableCollection={tableCollection}\r\n\t\t\t\t\t\t\t\t\ttableKey={sourceTableKey !== undefined ? inlineEval(sourceTableKey, npcModifiedData) : undefined}\r\n\t\t\t\t\t\t\t\t\tstorageKey={entry.getKeyPath()}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{entry.hasValue() && <Form.Field>\r\n\t\t\t\t\t\t\t\t<label>Generated Value</label>\r\n\t\t\t\t\t\t\t\t{rawValue !== undefined ? rawValue : (\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: 'red' }}>Not Generated</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Form.Field>}\r\n\t\t\t\t\t\t\t{entry.hasValue() && <Form.Field>\r\n\t\t\t\t\t\t\t\t<label>Value with Modifiers</label>\r\n\t\t\t\t\t\t\t\t{modifiedValue !== undefined ? modifiedValue : (\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: 'red' }}>Not Generated</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Form.Field>}\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t\t<Form.Group widths={'equal'} style={\r\n\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\thasModifiers\r\n\t\t\t\t\t\t\t\t|| isModified\r\n\t\t\t\t\t\t\t\t|| stringifyDeps.length > 0\r\n\t\t\t\t\t\t\t\t|| stringifySubscribed.length > 0\r\n\t\t\t\t\t\t\t\t|| generationDependencies.length > 0\r\n\t\t\t\t\t\t\t\t|| generationDependedOnBy.length > 0\r\n\t\t\t\t\t\t\t) ? { margin: 0 } : {}\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t{hasModifiers && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Modifies', 'Modifies Entries', modifiersFromEntry\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{isModified && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Modified By', 'Modified by Entries', modifiersOfEntry\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{stringifyDeps.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'String Dependencies', 'String Dependencies', stringifyDeps\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{stringifySubscribed.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'String Subscriptions', 'String Subscriptions', stringifySubscribed\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{generationDependencies.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Dependencies', 'Generation Dependencies', generationDependencies\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{generationDependedOnBy.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Depended On By', 'Generations That Depend on entry', generationDependedOnBy\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{collectionEntryKeys.length > 0 && <Form.Field>\r\n\t\t\t\t\t\t\t\t{makeModifierPopup('Other Values', 'Collective Values', collectionEntryObj)}\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t{lodash.toPairs(collectionEntryObj).map(([entryKey, stringified]) => (\r\n\t\t\t\t\t\t\t\t\t\t<li key={entryKey}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Popup key={entryKey}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger={(<p>{stringified}</p>)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontent={(`Source: ${entryKey}`)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</Form.Field>}\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t\t{entry.hasChildren() && <StorageAccordion\r\n\t\t\t\t\t\tstorageKey={storageKey}\r\n\t\t\t\t\t\tentryComponentType={EntryView}\r\n\t\t\t\t\t\tentries={lodash.toPairs(entry.getChildren()).reduce((accum, [childKey, childEntry]) =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taccum[childKey] = {\r\n\t\t\t\t\t\t\t\ttableCollection: tableCollection,\r\n\t\t\t\t\t\t\t\tnpcSchema: npcSchema,\r\n\t\t\t\t\t\t\t\tnpc: npc,\r\n\t\t\t\t\t\t\t\tnpcModifiedData: npcModifiedData,\r\n\t\t\t\t\t\t\t\tpropertyKey: childKey,\r\n\t\t\t\t\t\t\t\tstorageKey: `${storageKey}.${childKey}`,\r\n\t\t\t\t\t\t\t\tentry: childEntry,\r\n\t\t\t\t\t\t\t\tparentEntry: childEntry.schemaEntry,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\treturn accum;\r\n\t\t\t\t\t\t}, {})}\r\n\t\t\t\t\t/>}\r\n\t\t\t\t</div>\r\n\t\t\t</Accordion.Content>}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport function DataViewEntry({\r\n\tpropertyKey, tableCollection, entryKey, storageKey,\r\n\tactive, onClick,\r\n})\r\n{\r\n\tconst npcSchema = tableCollection ? tableCollection.getNpcSchema() : null;\r\n\tconst npc = NpcData.get();\r\n\tconst entry = npc.getEntry(entryKey);\r\n\r\n\tconst parentEntry = entry.getField();\r\n\r\n\treturn (\r\n\t\t<EntryView\r\n\t\t\ttableCollection={tableCollection} npcSchema={npcSchema} npc={npc}\r\n\r\n\t\t\tpropertyKey={propertyKey} storageKey={storageKey}\r\n\t\t\tentry={entry} parentEntry={parentEntry}\r\n\r\n\t\t\tactive={active} onClick={onClick}\r\n\t\t/>\r\n\t)\r\n}\r\n","import React from 'react';\r\nimport NpcData from '../../storage/NpcData';\r\nimport lodash from 'lodash';\r\nimport { Header, Button, List, Popup, Table } from 'semantic-ui-react';\r\nimport * as shortid from 'shortid';\r\n\r\nfunction toFeet(n)\r\n{\r\n\tconst realFeet = ((n * 0.393700) / 12);\r\n\tconst feet = Math.floor(realFeet);\r\n\tconst inches = Math.floor((realFeet - feet) * 12);\r\n\treturn feet + \"'\" + inches + '\"';\r\n}\r\n\r\nfunction toSentenceCase(sentence)\r\n{\r\n\treturn sentence.length <= 0 ? '' : (\r\n\t\tsentence[0].toUpperCase() + sentence.slice(1)\r\n\t);\r\n}\r\n\r\nfunction getRenderedText(text, entry, globalData)\r\n{\r\n\tif (typeof text === 'function')\r\n\t{\r\n\t\treturn text(entry);\r\n\t}\r\n\telse if (text !== undefined)\r\n\t{\r\n\t\treturn text;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn entry.getArticleContent(globalData);\r\n\t}\r\n}\r\n\r\nfunction InlineEntryComponent({ entry, getComponent })\r\n{\r\n\tconst refresh = React.useState(undefined)[1];\r\n\tReact.useEffect(() => {\r\n\t\tfunction onChanged(evt) { refresh(shortid.generate()); }\r\n\t\tentry.addListenerOnChanged(onChanged);\r\n\t\tentry.addListenerOnUpdateString(onChanged);\r\n\t\tentry.addListenerOnModified(onChanged);\r\n\t\tentry.addListenerOnUpdateCollection(onChanged);\r\n\t\treturn () => {\r\n\t\t\tentry.removeListenerOnChanged(onChanged)\r\n\t\t\tentry.removeListenerOnUpdateString(onChanged);\r\n\t\t\tentry.removeListenerOnModified(onChanged);\r\n\t\t\tentry.removeListenerOnUpdateCollection(onChanged);\r\n\t\t};\r\n\t});\r\n\treturn getComponent(entry) || <span/>;\r\n}\r\n\r\nfunction InlineEntryItem({\r\n\tentry, rerollAs, globalData, text,\r\n})\r\n{\r\n\treturn (\r\n\t\t<InlineEntryComponent\r\n\t\t\tentry={entry}\r\n\t\t\tgetComponent={(e) => {\r\n\t\t\t\tconst renderedText = getRenderedText(text, e, globalData);\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\thoverable={true}\r\n\t\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t\t<span style={{ color: \"#4400ff\", fontWeight: 'bold' }}>{renderedText}</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\tcontent={(\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tpath={rerollAs || e.getKeyPath()} size='mini' icon='refresh'\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\te.regenerate(globalData);\r\n\t\t\t\t\t\t\t\t\t\te.npc.save();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<label>{e.getName()}: {renderedText}</label>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport function ArticleContent({ usePlainText })\r\n{\r\n\tconst npc = NpcData.get();\r\n\tconst globalData = npc.getModifiedData();\r\n\r\n\tconst createEntryItem = (entry, text=undefined, rerollAs=undefined) =>\r\n\t{\r\n\t\tif (!entry) { return <div />; }\r\n\t\tif (usePlainText || !entry.getCanReroll())\r\n\t\t{\r\n\t\t\treturn getRenderedText(text, entry, globalData);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<InlineEntryItem\r\n\t\t\t\tentry={entry}\r\n\t\t\t\trerollAs={rerollAs}\r\n\t\t\t\tglobalData={globalData}\r\n\t\t\t\ttext={text}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\t\r\n\tconst strength = npc.getEntry('stats.abilityScores.strength');\r\n\tconst dexterity = npc.getEntry('stats.abilityScores.dexterity');\r\n\tconst constitution = npc.getEntry('stats.abilityScores.constitution');\r\n\tconst intelligence = npc.getEntry('stats.abilityScores.intelligence');\r\n\tconst wisdom = npc.getEntry('stats.abilityScores.wisdom');\r\n\tconst charisma = npc.getEntry('stats.abilityScores.charisma');\r\n\tconst ethicalPositive = npc.getEntry('stats.alignmentTendancies.ethical.positive');\r\n\tconst ethicalNeutral = npc.getEntry('stats.alignmentTendancies.ethical.neutral');\r\n\tconst ethicalNegative = npc.getEntry('stats.alignmentTendancies.ethical.negative');\r\n\tconst moralPositive = npc.getEntry('stats.alignmentTendancies.moral.positive');\r\n\tconst moralNeutral = npc.getEntry('stats.alignmentTendancies.moral.neutral');\r\n\tconst moralNegative = npc.getEntry('stats.alignmentTendancies.moral.negative');\r\n\r\n\tconst name = npc.getEntry('identity.name');\r\n\tconst surname = npc.getEntry('identity.surname');\r\n\tconst pronouns = npc.getEntry('identity.pronouns');\r\n\tconst genderIdentity = npc.getEntry('identity.genderIdentity');\r\n\tconst genderExpression = npc.getEntry('identity.genderExpression');\r\n\tconst sex = npc.getEntry('identity.sex');\r\n\tconst romanticIdentity = npc.getEntry('identity.romanticIdentity');\r\n\tconst sexualIdentity = npc.getEntry('identity.sexualIdentity');\r\n\tconst sexualOrientation = npc.getEntry('identity.sexualOrientation');\r\n\r\n\tconst profession = npc.getEntry('occupation.profession');\r\n\tconst occupationalArea = npc.getEntry('occupation.area');\r\n\r\n\tconst age = npc.getEntry('description.age');\r\n\tconst eyeColor = npc.getEntry('description.eyeColor');\r\n\tconst height = npc.getEntry('description.height');\r\n\tconst weight = npc.getEntry('description.weight');\r\n\tconst face = npc.getEntry('description.face');\r\n\tconst race = npc.getEntry('description.race');\r\n\tconst hair = npc.getEntry('description.race.hair');\r\n\tconst skin = npc.getEntry('description.race.skin');\r\n\r\n\tconst physicalTraitsMap = npc.getEntry('description.specialPhysical').getChildren();\r\n\tconst physicalTraits = lodash.values(physicalTraitsMap).map((entry) => (\r\n\t\t<List.Item key={entry.getKeyPath()} as='li'>\r\n\t\t\t{createEntryItem(entry, (e) => toSentenceCase(e.toString()))}\r\n\t\t</List.Item>\r\n\t));\r\n\r\n\tconst deity = npc.getEntry('personality.religion.deity');\r\n\tconst worship = npc.getEntry('personality.religion.worship');\r\n\tconst quirks = npc.getEntry('personality.quirks');\r\n\tconst quirkList = quirks.getCollectionEntryKeys()\r\n\t\t.map((entryKey) => npc.getEntry(entryKey))\r\n\t\t.filter((entry) => !entry.isValueEquivalentToNone())\r\n\t\t.map((entry) => (\r\n\t\t\t<List.Item key={entry.getKeyPath()} as='li'>\r\n\t\t\t\t{createEntryItem(entry, (e) => toSentenceCase(e.toString()))}\r\n\t\t\t</List.Item>\r\n\t\t));\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t{usePlainText && (\r\n\t\t\t\t<p>View generation at <a href={NpcData.getLink()}>D&amp;D-Generator</a></p>\r\n\t\t\t)}\r\n\r\n\t\t\t<Header as='h1' content='Description' />\r\n\t\t\t<List bulleted as='ul'>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{createEntryItem(name)}{surname.hasValue() && createEntryItem(surname, (e) => ` ${e.toString()}`)}\r\n\t\t\t\t\t&nbsp; is a &nbsp;\r\n\t\t\t\t\t{createEntryItem(age)} year old &nbsp;\r\n\t\t\t\t\t{createEntryItem(race)} &nbsp;\r\n\t\t\t\t\t{createEntryItem(genderIdentity)} and &nbsp;\r\n\t\t\t\t\t{createEntryItem(profession)} ({createEntryItem(occupationalArea)})\r\n\t\t\t\t\t<InlineEntryComponent entry={profession}\r\n\t\t\t\t\t\tgetComponent={(e) => {\r\n\t\t\t\t\t\t\tconst desc = e.getDescriptionString(globalData);\r\n\t\t\t\t\t\t\tif (desc === undefined) return undefined;\r\n\t\t\t\t\t\t\treturn <span>&nbsp;({desc})</span>;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>.\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{toSentenceCase(pronouns.getRawValue().singular)}\r\n\t\t\t\t\t&nbsp; has &nbsp;\r\n\t\t\t\t\t{createEntryItem(eyeColor, (e) => `${e.toString()} eyes`)}\r\n\t\t\t\t\t&nbsp; and &nbsp;\r\n\t\t\t\t\t{createEntryItem(hair)}.\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{toSentenceCase(pronouns.getRawValue().singular)}\r\n\t\t\t\t\t&nbsp; has &nbsp;\r\n\t\t\t\t\t{createEntryItem(skin)}.\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{toSentenceCase(pronouns.getRawValue().singular)}\r\n\t\t\t\t\t&nbsp; stands &nbsp;\r\n\t\t\t\t\t{createEntryItem(height, (e) => `${e.toString()}cm (${toFeet(e.getModifiedValue())})`)}\r\n\t\t\t\t\t&nbsp; tall and has a &nbsp;\r\n\t\t\t\t\t{createEntryItem(weight)} build.\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{toSentenceCase(pronouns.getRawValue().singular)}\r\n\t\t\t\t\t&nbsp; has an &nbsp;\r\n\t\t\t\t\t{createEntryItem(face)} face.\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t{physicalTraits}\r\n\t\t\t</List>\r\n\r\n\t\t\t<Header as='h1' content='Identity' />\r\n\t\t\t<Table compact='very' size='small' striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Pronouns</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(pronouns)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Gender Identity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(genderIdentity)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Gender Expression</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(genderExpression)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Sex</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(sex)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Romantic Identity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(romanticIdentity)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Sexual Identity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(sexualIdentity)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Sexual Orientation</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(sexualOrientation)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\r\n\t\t\t<Header as='h1' content='Personality' />\r\n\t\t\t<List bulleted as='ul'>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{toSentenceCase(pronouns.getRawValue().singular)}\r\n\t\t\t\t\t&nbsp; {createEntryItem(worship)} worships {createEntryItem(deity)}.\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t{quirkList}\r\n\t\t\t</List>\r\n\r\n\t\t\t<Header as='h1' content='Stats' />\r\n\r\n\t\t\t<Header as='h2' content='Ability Scores' />\r\n\t\t\t<Table striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Strength</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{strength.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Dexterity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{dexterity.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Constitution</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{constitution.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Intelligence</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{intelligence.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Wisdom</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{wisdom.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Charisma</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{charisma.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\t\t\t\r\n\t\t\t<Header as='h2' content='Alignment Tendencies' />\r\n\t\t\t<Header as='h3' content='Ethical' />\r\n\t\t\t<Table compact='very' size='small' striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Lawful</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(ethicalPositive)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Neutral</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(ethicalNeutral)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Chaotic</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(ethicalNegative)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\t\t\t<Header as='h3' content='Moral' />\r\n\t\t\t<Table compact='very' size='small' striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Good</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(moralPositive)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Neutral</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(moralNeutral)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Evil</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(moralNegative)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\r\n\t\t\t{/*<Header as='h1' content='Plot Hook' />*/}\r\n\r\n\t\t</div>\r\n\t);\r\n}","import React from 'react';\r\nimport { Header, Button, Icon, Popup, Menu, Dropdown } from 'semantic-ui-react';\r\nimport {\r\n\tgetDisplayIconForMode,\r\n} from './EDisplayModes';\r\nimport NpcData from '../../storage/NpcData';\r\nimport copyToClipboard from '../../lib/clipboard';\r\nimport Filter from '../../storage/Filter';\r\nimport { renderToString } from 'react-dom/server';\r\nimport { ArticleContent } from './ArticleContent';\r\n\r\nexport function MenuBar({\r\n\tswitchDisplayMode,\r\n\tdisplayMode,\r\n\tmenuItemsRight,\r\n\tgetEntryLink,\r\n})\r\n{\r\n\t// TODO: Figure out how to keep the switch view mode popup open when the item is clicked\r\n\treturn (\r\n\t\t<Menu borderless pointing secondary>\r\n\t\t\t<Menu.Item onClick={switchDisplayMode}>\r\n\t\t\t\t<Popup\r\n\t\t\t\t\tposition='bottom right'\r\n\t\t\t\t\tcontent={'Switch view mode'/*getDisplayModeSwitchLabel(displayMode)*/}\r\n\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t<Icon name={getDisplayIconForMode(displayMode)} />\r\n\t\t\t\t\t\t\t<Header.Content>NPC</Header.Content>\r\n\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t)}\r\n\t\t\t\t/>\r\n\t\t\t</Menu.Item>\r\n\t\t\t<Menu.Menu position='right'>\r\n\t\t\t\t{menuItemsRight || []}\r\n\t\t\t\t<Dropdown key='export' item text={'Copy To Clipboard'}>\r\n\t\t\t\t\t<Dropdown.Menu>\r\n\t\t\t\t\t\t<Dropdown.Item icon='linkify' text='Generator Link' onClick={() => copyToClipboard(NpcData.getLink())} />\r\n\t\t\t\t\t\t<Dropdown.Item icon='file text' text='Article' onClick={() => {\r\n\t\t\t\t\t\t\tcopyToClipboard(renderToString(\r\n\t\t\t\t\t\t\t\t<ArticleContent usePlainText={true} />\r\n\t\t\t\t\t\t\t));\r\n\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<Dropdown.Item icon='code' text='JSON' onClick={() => copyToClipboard(JSON.stringify(NpcData.getState()))} />\r\n\t\t\t\t\t</Dropdown.Menu>\r\n\t\t\t\t</Dropdown>\r\n\t\t\t\t<Menu.Item>\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\tposition='bottom right'\r\n\t\t\t\t\t\tcontent={'Clear All Filters'}\r\n\t\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\ticon\r\n\t\t\t\t\t\t\t\tonClick={Filter.clear}\r\n\t\t\t\t\t\t\t\tstyle={{ marginLeft: 2, marginRight: 2, }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Icon.Group>\r\n\t\t\t\t\t\t\t\t\t<Icon name='filter' />\r\n\t\t\t\t\t\t\t\t\t<Icon name='cancel' corner='bottom right' />\r\n\t\t\t\t\t\t\t\t</Icon.Group>\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\tposition='bottom right'\r\n\t\t\t\t\t\tcontent={'Delete generated data'}\r\n\t\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\ticon={'trash'}\r\n\t\t\t\t\t\t\t\tonClick={NpcData.clear}\r\n\t\t\t\t\t\t\t\tstyle={{ marginLeft: 2, marginRight: 2, }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Menu.Item>\r\n\t\t\t</Menu.Menu>\r\n\t\t</Menu>\r\n\t);\r\n}","import React from 'react';\r\nimport { Accordion, Icon } from 'semantic-ui-react';\r\nimport { camelCaseToTitle } from '../../lib/str';\r\nimport { StorageAccordion } from '../StorageAccordion';\r\nimport { DISPLAY_MODES } from './EDisplayModes';\r\nimport { DataViewEntry } from './DetailViewEntry';\r\nimport NpcData from '../../storage/NpcData';\r\nimport { MenuBar } from './MenuBar';\r\n\r\nfunction DetailViewCategory({\r\n\tpropertyKey, tableCollection,\r\n\tcategoryFields, storageKey,\r\n\tactive, onClick,\r\n})\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Accordion.Title\r\n\t\t\t\tindex={propertyKey}\r\n\t\t\t\tactive={active}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t\tstyle={{ marginBottom: 0 }}\r\n\t\t\t>\r\n\t\t\t\t<Icon name='dropdown' />\r\n\t\t\t\t{camelCaseToTitle(propertyKey)}\r\n\t\t\t</Accordion.Title>\r\n\t\t\t<Accordion.Content\r\n\t\t\t\tactive={active}\r\n\t\t\t>\r\n\t\t\t\t<div style={{\r\n\t\t\t\t\tpaddingLeft: '1em'\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<StorageAccordion\r\n\t\t\t\t\t\tstorageKey={storageKey}\r\n\t\t\t\t\t\tentryComponentType={DataViewEntry}\r\n\t\t\t\t\t\tactive={active}\r\n\t\t\t\t\t\tentries={categoryFields.reduce((accum, fieldKey) =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taccum[fieldKey] = {\r\n\t\t\t\t\t\t\t\tpropertyKey: fieldKey,\r\n\t\t\t\t\t\t\t\ttableCollection: tableCollection,\r\n\t\t\t\t\t\t\t\tentryKey: `${propertyKey}.${fieldKey}`,\r\n\t\t\t\t\t\t\t\tstorageKey: `${storageKey}.${fieldKey}`,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\treturn accum;\r\n\t\t\t\t\t\t}, {})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Accordion.Content>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport function DetailView(props)\r\n{\r\n\tconst npcSchema = props.tableCollection.getNpcSchema();\r\n\tconst storageKey = `npc.${DISPLAY_MODES.Detailed}.expandedEntries`;\r\n\tconsole.log(props.tableCollection, npcSchema, NpcData.get());\r\n\tconst npc = NpcData.get();\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<MenuBar\r\n\t\t\t\tswitchDisplayMode={props.switchDisplayMode}\r\n\t\t\t\tdisplayMode={props.displayMode}\r\n\t\t\t/>\r\n\r\n\t\t\t<StorageAccordion\r\n\t\t\t\tstorageKey={storageKey}\r\n\t\t\t\tentryComponentType={DetailViewCategory}\r\n\t\t\t\tentries={npc.getCategories().reduce((accum, category) =>\r\n\t\t\t\t{\r\n\t\t\t\t\taccum[category] = {\r\n\t\t\t\t\t\tpropertyKey: category,\r\n\t\t\t\t\t\ttableCollection: props.tableCollection,\r\n\t\t\t\t\t\tcategoryFields: npc.getEntriesForCategory(category),\r\n\t\t\t\t\t\tstorageKey: `${storageKey}.${category}`,\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn accum;\r\n\t\t\t\t}, {})}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport { MenuBar } from './MenuBar';\r\nimport { ArticleContent } from './ArticleContent';\r\n\r\nexport function ArticleView(props)\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<MenuBar\r\n\t\t\t\tswitchDisplayMode={props.switchDisplayMode}\r\n\t\t\t\tdisplayMode={props.displayMode}\r\n\t\t\t/>\r\n\t\t\t<ArticleContent/>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport TableCollection from '../storage/TableCollection';\r\nimport { Loader, Icon } from 'semantic-ui-react';\r\nimport shortid from 'shortid';\r\nimport { DetailView } from '../components/NPC/DetailView';\r\nimport storage from 'local-storage';\r\nimport {\r\n\tDISPLAY_MODES,\r\n\tgetNextDisplayMode,\r\n} from '../components/NPC/EDisplayModes';\r\nimport NpcData from '../storage/NpcData';\r\nimport { ArticleView } from '../components/NPC/ArticleView';\r\n\r\nconst CURRENT_DISPLAYMODE_STORAGE = `npc.displayMode`;\r\n\r\nexport function NpcView(props)\r\n{\r\n\tconst parsedNpcData = NpcData.getCurrentLinkData();\r\n\tif (parsedNpcData !== undefined)\r\n\t{\r\n\t\t// filter out the npc data\r\n\t\t// warning: this will remove ALL url params\r\n\t\twindow.location.replace(\r\n\t\t\t`${window.location.protocol}//${window.location.host}${window.location.pathname}`\r\n\t\t);\r\n\t}\r\n\r\n\tconst refreshWith = useState(0)[1];\r\n\tconst [displayMode, setDisplayMode] = useState(storage.get(CURRENT_DISPLAYMODE_STORAGE) || DISPLAY_MODES.Readable);\r\n\tconst switchDisplayMode = () => {\r\n\t\tconst nextMode = getNextDisplayMode(displayMode);\r\n\t\tstorage.set(CURRENT_DISPLAYMODE_STORAGE, nextMode);\r\n\t\tsetDisplayMode(nextMode);\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tfunction onTableCollectionChanged({ detail })\r\n\t\t{\r\n\t\t\trefreshWith(shortid.generate());\r\n\t\t};\r\n\t\tTableCollection.addOnChanged(onTableCollectionChanged);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tTableCollection.removeOnChanged(onTableCollectionChanged);\r\n\t\t}\r\n\t});\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tfunction onNpcInitialized({ detail })\r\n\t\t{\r\n\t\t\trefreshWith(shortid.generate());\r\n\t\t};\r\n\t\tNpcData.toggleOnInitialized('on', onNpcInitialized);\r\n\t\tif (!NpcData.get())\r\n\t\t{\r\n\t\t\tNpcData.initialize((npc) => {\r\n\t\t\t\tif (parsedNpcData !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\tnpc.setState(parsedNpcData);\r\n\t\t\t\t}\r\n\t\t\t\tnpc.regenerateAll(NpcData.getState() || {});\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tNpcData.toggleOnInitialized('off', onNpcInitialized);\r\n\t\t}\r\n\t});\r\n\r\n\tconst tableCollection = TableCollection.get();\r\n\tconst npcData = NpcData.get();\r\n\tif (!tableCollection || !npcData)\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Loader active>Loading</Loader>\r\n\t\t);\r\n\t}\r\n\r\n\tswitch (displayMode)\r\n\t{\r\n\t\tcase DISPLAY_MODES.Readable: return (\r\n\t\t\t<ArticleView\r\n\t\t\t\tlocation={props.location}\r\n\t\t\t\ttableCollection={tableCollection}\r\n\t\t\t\tswitchDisplayMode={switchDisplayMode}\r\n\t\t\t\tdisplayMode={displayMode}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tcase DISPLAY_MODES.Detailed: return (\r\n\t\t\t<DetailView\r\n\t\t\t\tlocation={props.location}\r\n\t\t\t\ttableCollection={tableCollection}\r\n\t\t\t\tswitchDisplayMode={switchDisplayMode}\r\n\t\t\t\tdisplayMode={displayMode}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tdefault: return (\r\n\t\t\t<div>\r\n\t\t\t\tSomething went wrong, I'm confused... <Icon name='question' />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","\r\nconst EVENTS = new EventTarget();\r\n\r\nexport class View\r\n{\r\n\r\n\tstatic set(view)\r\n\t{\r\n\t\tif (view === View.get()) { return; }\r\n\t\twindow.sessionStorage.setItem(\"view\", view);\r\n\t\tEVENTS.dispatchEvent(new CustomEvent('onChanged_view', { detail: view }));\r\n\t}\r\n\r\n\tstatic get()\r\n\t{\r\n\t\treturn window.sessionStorage.getItem(\"view\");\r\n\t}\r\n\r\n\tstatic subscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.addEventListener('onChanged_view', callback);\r\n\t}\r\n\r\n\tstatic unsubscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.removeEventListener('onChanged_view', callback);\r\n\t}\r\n\r\n}\r\n\r\nexport class Table\r\n{\r\n\r\n\tstatic set(value)\r\n\t{\r\n\t\tif (value === Table.get()) { return; }\r\n\t\twindow.sessionStorage.setItem(\"table\", value);\r\n\t\tEVENTS.dispatchEvent(new CustomEvent('onChanged_table', { detail: value }));\r\n\t}\r\n\r\n\tstatic get()\r\n\t{\r\n\t\treturn window.sessionStorage.getItem(\"table\");\r\n\t}\r\n\r\n\tstatic subscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.addEventListener('onChanged_table', callback);\r\n\t}\r\n\r\n\tstatic unsubscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.removeEventListener('onChanged_table', callback);\r\n\t}\r\n\r\n}","import React from 'react';\r\nimport TableCollection from '../storage/TableCollection';\r\nimport {useTable} from 'react-table';\r\nimport { Table, Header, Container } from 'semantic-ui-react';\r\nimport * as DataTable from '../storage/Table';\r\n\r\nfunction getDataTable(tableKey)\r\n{\r\n\tconst tableCollection = TableCollection.get();\r\n\tif (!tableCollection) { return undefined; }\r\n\treturn tableKey !== undefined ? tableCollection.getTableAtPath(tableKey) : undefined;\r\n}\r\n\r\n// ReactHooks: https://reactjs.org/docs/hooks-effect.html\r\n// Memos: https://reactjs.org/docs/hooks-reference.html#usememo\r\nexport default function DataTableView({ tableKey })\r\n{\r\n\tconst dataTable = getDataTable(tableKey);\r\n\t\r\n\tconst columns = React.useMemo(() => DataTable.default.COLUMNS, []);\r\n\r\n\tconst [rowCount, setRowCount] = React.useState(dataTable === undefined ? 0 : dataTable.length());\r\n\tReact.useEffect(() => {\r\n\r\n\t\tif (dataTable === undefined) { return; }\r\n\r\n\t\tfunction onChangedRowCount({ details })\r\n\t\t{\r\n\t\t\tsetRowCount(details.next);\r\n\t\t}\r\n\r\n\t\tdataTable.subscribeOnChangedRowCount(onChangedRowCount);\r\n\r\n\t\treturn () => {\r\n\t\t\tdataTable.unsubscribeOnChangedRowCount(onChangedRowCount);\r\n\t\t};\r\n\t});\r\n\r\n\tconst data = React.useMemo(() => {\r\n\t\tconst table = getDataTable(tableKey);\r\n\t\tif (table === undefined) { return []; }\r\n\t\treturn table.getRows();\r\n\t}, [tableKey]);\r\n\r\n\t// React-Table API: https://github.com/tannerlinsley/react-table/blob/master/docs/api.md#usetable\r\n\t// React-Table Examples: https://github.com/tannerlinsley/react-table/blob/master/docs/examples.md\r\n\tconst {\r\n\t\tgetTableProps,\r\n\t\tgetTableBodyProps,\r\n    headerGroups,\r\n    rows,\r\n    prepareRow,\r\n\t} = useTable({\r\n\t\tcolumns, data,\r\n\t});\r\n\r\n\tif (dataTable === undefined)\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Header>\r\n\t\t\t\t403: No table found\r\n\t\t\t</Header>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<Header>{dataTable.getKey()} ({rowCount} rows)</Header>\r\n\t\t\t<Table {...getTableProps()}>\r\n\t\t\t\t<Table.Header>\r\n\t\t\t\t\t{headerGroups.map((headerGroup) => (\r\n\t\t\t\t\t\t<Table.Row {...headerGroup.getHeaderGroupProps()}>\r\n\t\t\t\t\t\t\t{headerGroup.headers.map((column) => (\r\n\t\t\t\t\t\t\t\t<Table.HeaderCell {...column.getHeaderProps()}>\r\n\t\t\t\t\t\t\t\t\t{column.render('Header')}\r\n\t\t\t\t\t\t\t\t</Table.HeaderCell>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Table.Header>\r\n\t\t\t\t<Table.Body {...getTableBodyProps()}>\r\n\t\t\t\t\t{rows.map((row, i) => prepareRow(row) || (\r\n\t\t\t\t\t\t<Table.Row {...row.getRowProps()}>\r\n\t\t\t\t\t\t\t{row.cells.map(cell => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Table.Cell {...cell.getCellProps()}>\r\n\t\t\t\t\t\t\t\t\t\t{cell.render('Cell')}\r\n\t\t\t\t\t\t\t\t\t</Table.Cell>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\t\t</Container>\r\n\t);\r\n}\r\n\r\n/*\r\nexport class DataTableView extends React.Component\r\n{\r\n\tgetTableData()\r\n\t{\r\n\t\tconst tableCollection = TableCollection.get();\r\n\t\tif (!tableCollection) { return undefined; }\r\n\t\tconst tableKey = this.props.tableKey;\r\n\t\treturn tableKey !== undefined ? tableCollection.getTable(tableKey) : undefined;\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tconsole.log(DataTable.default.COLUMNS);\r\n\t\treturn 'T2';\r\n\t\tconsole.log(COLUMNS);\r\n\r\n\t\tconst tableData = this.getTableData();\r\n\t\tif (tableData === undefined)\r\n\t\t{\r\n\t\t}\r\n\r\n\t\tconsole.log(tableData);\r\n\r\n\t}\r\n\r\n}\r\n\t\t//*/\r\n","import React from 'react';\r\nimport lodash from 'lodash';\r\nimport TableCollection from '../storage/TableCollection';\r\nimport Tree from 'react-animated-tree';\r\nimport { View, Table } from '../storage/Session';\r\nimport * as queryString from 'query-string';\r\nimport DataTableView from '../components/DataTableView';\r\n\r\nexport function DataView()\r\n{\r\n\tconst urlParams = queryString.parse(window.location.search);\r\n\tif (urlParams.table !== undefined)\r\n\t{\r\n\t\treturn <DataTableView tableKey={urlParams.table} />\r\n\t}\r\n\r\n\tfunction makeTreeNode([pathItem, nodeDetails])\r\n\t{\r\n\t\tconst allNodeProperties = Object.keys(nodeDetails);\r\n\t\tconst subNodeProperties = allNodeProperties.filter((item) => item !== 'table');\r\n\t\tconst hasTable = allNodeProperties.includes('table');\r\n\t\treturn (\r\n\t\t\t<Tree key={pathItem}\r\n\t\t\t\tcontent={(\r\n\t\t\t\t\thasTable ? (\r\n\t\t\t\t\t\t<a href={(\r\n\t\t\t\t\t\t\t`${window.location.protocol}//${window.location.host}${window.location.pathname}?table=${nodeDetails.table.getKeyPath()}`\r\n\t\t\t\t\t\t)}>{pathItem}</a>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\tsubNodeProperties.length > 0 ? pathItem : `Unknown: ${pathItem}`\r\n\t\t\t\t\t)\r\n\t\t\t\t)}\r\n\t\t\t\tonClick={(\r\n\t\t\t\t\t!hasTable ? undefined : () =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tView.set(\"data\");\r\n\t\t\t\t\t\tTable.set(nodeDetails.table.getKeyPath());\r\n\t\t\t\t\t}\r\n\t\t\t\t)}\r\n\t\t\t>\r\n\t\t\t\t{(\r\n\t\t\t\t\tsubNodeProperties.map(\r\n\t\t\t\t\t\t(propKey) => ([propKey, nodeDetails[propKey]])\r\n\t\t\t\t\t).map(makeTreeNode)\r\n\t\t\t\t)}\r\n\t\t\t</Tree>\r\n\t\t);\r\n\t}\r\n\r\n\tconst tableCollection = TableCollection.get();\r\n\tif (tableCollection)\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Tree\r\n\t\t\t\tcontent={'Tables'}\r\n\t\t\t>\r\n\t\t\t\t{lodash.toPairs(tableCollection.getTableTree()).map(makeTreeNode)}\r\n\t\t\t</Tree>\r\n\t\t);\r\n\t}\r\n}","import React from 'react';\r\nimport { Header } from 'semantic-ui-react';\r\n\r\nexport class HomeView extends React.Component\r\n{\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Header>HOME</Header>\r\n\t\t);\r\n\t}\r\n}","import React from 'react';\r\nimport { NpcView } from \"./view/NpcView\";\r\nimport { DataView } from \"./view/DataView\";\r\nimport { HomeView } from './view/HomeView';\r\n\r\nconst routes = {\r\n\t\"home\": () => <HomeView />,\r\n\t\"npc\": () => <NpcView />,\r\n  \"data\": () => <DataView />,\r\n};\r\n\r\nexport default routes;","import React from 'react';\r\nimport { Menu } from 'semantic-ui-react';\r\nimport { View } from '../storage/Session';\r\n\r\nexport function HeaderBarLink({ path, children })\r\n{\r\n\treturn (\r\n\t\t<Menu.Item\r\n\t\t\tname={path}\r\n\t\t\tactive={View.get() === path}\r\n\t\t\tonClick={() => {\r\n\t\t\t\tView.set(path);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</Menu.Item>\r\n\t);\r\n}","import React from 'react';\r\nimport { Menu, Button, Icon } from 'semantic-ui-react';\r\nimport { HeaderBarLink } from './HeaderBarLink';\r\nimport TableCollection from '../storage/TableCollection';\r\n\r\nexport class HeaderBar extends React.Component\r\n{\r\n\r\n\tonClearStorage()\r\n\t{\r\n\t\tconsole.log('Syncing tables');\r\n\t\tTableCollection.clear();\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Menu>\r\n\t\t\t\t<HeaderBarLink path={'home'}>Home</HeaderBarLink>\r\n\t\t\t\t<HeaderBarLink path={'npc'}>NPC</HeaderBarLink>\r\n\t\t\t\t<HeaderBarLink path={'data'}>Data</HeaderBarLink>\r\n\r\n\t\t\t\t<Menu.Item position='right'>\r\n\t\t\t\t\t<Button color='red' onClick={this.onClearStorage.bind(this)}>\r\n\t\t\t\t\t\t<Icon name='sync' /> Sync\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Menu.Item>\r\n      </Menu>\r\n\t\t);\r\n\t}\r\n}","import React from 'react';\r\nimport { HeaderBar } from '../components/HeaderBar';\r\nimport { Container } from 'semantic-ui-react';\r\n\r\nexport class ViewContainer extends React.Component\r\n{\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Container>\r\n\t\t\t\t<HeaderBar page={this.props.page} />\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t</Container>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { Container } from \"semantic-ui-react\";\r\nimport Routes from './routes';\r\nimport { HomeView } from \"./view/HomeView\";\r\nimport shortid from 'shortid';\r\nimport TableCollection from './storage/TableCollection';\r\nimport { ViewContainer } from './view/ViewContainer';\r\nimport { View } from './storage/Session';\r\nimport NpcData from './storage/NpcData';\r\n\r\nfunction getRoute(view)\r\n{\r\n\tif (Routes.hasOwnProperty(view)) return Routes[view]();\r\n\telse return (<HomeView />);\r\n}\r\n\r\nexport default function App()\r\n{\r\n\tconst refreshWith = React.useState(undefined)[1];\r\n\r\n\tif (NpcData.getCurrentLinkData() !== undefined)\r\n\t{\r\n\t\tView.set(\"npc\");\r\n\t}\r\n \r\n\tReact.useEffect(() => {\r\n\t\tconst onViewChanged = () => refreshWith(shortid.generate());\r\n\t\tView.subscribeOnChanged(onViewChanged);\r\n\t\treturn () => {\r\n\t\t\tView.unsubscribeOnChanged(onViewChanged);\r\n\t\t};\r\n\t});\r\n\r\n\tReact.useEffect(() =>\r\n\t{\r\n\t\tfunction onTableCollectionChanged()\r\n\t\t{\r\n\t\t\trefreshWith(shortid.generate());\r\n\t\t};\r\n\t\tTableCollection.addOnChanged(onTableCollectionChanged);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tTableCollection.removeOnChanged(onTableCollectionChanged);\r\n\t\t}\r\n\t});\r\n\r\n\tif (!TableCollection.get())\r\n\t{\r\n\t\tTableCollection.initialize();\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Container id={'App'} fluid>\r\n\t\t\t<ViewContainer page={window.location.pathname}>\r\n\t\t\t\t{getRoute(View.get())}\r\n\t\t\t</ViewContainer>\r\n\t\t</Container>\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'semantic-ui-css/semantic.min.css';\r\n\r\n// https://www.npmjs.com/package/semver\r\nconsole.log('Versions:', {\r\n\treact: React.version,\r\n\tnode: process.versions.node,\r\n});\r\nconsole.log(`Serving at public url: ${process.env.PUBLIC_URL}`);\r\n\r\nReactDOM.render((\r\n\t<App />\r\n), document.getElementById('root'));","module.exports = (values) =>\r\n{\r\n\treturn values[Math.floor(Math.random() * values.length)];\r\n}","var map = {\n\t\"./tables/bonus/ability/cha/high.json\": 222,\n\t\"./tables/bonus/ability/cha/index.json\": 223,\n\t\"./tables/bonus/ability/cha/low.json\": 224,\n\t\"./tables/bonus/ability/cha/medium.json\": 225,\n\t\"./tables/bonus/ability/const/high.json\": 226,\n\t\"./tables/bonus/ability/const/index.json\": 227,\n\t\"./tables/bonus/ability/const/low.json\": 228,\n\t\"./tables/bonus/ability/const/medium.json\": 229,\n\t\"./tables/bonus/ability/dex/high.json\": 230,\n\t\"./tables/bonus/ability/dex/index.json\": 231,\n\t\"./tables/bonus/ability/dex/low.json\": 232,\n\t\"./tables/bonus/ability/dex/medium.json\": 233,\n\t\"./tables/bonus/ability/index.json\": 234,\n\t\"./tables/bonus/ability/int/high.json\": 235,\n\t\"./tables/bonus/ability/int/index.json\": 236,\n\t\"./tables/bonus/ability/int/low.json\": 237,\n\t\"./tables/bonus/ability/int/medium.json\": 238,\n\t\"./tables/bonus/ability/str/high.json\": 239,\n\t\"./tables/bonus/ability/str/index.json\": 240,\n\t\"./tables/bonus/ability/str/low.json\": 241,\n\t\"./tables/bonus/ability/str/medium.json\": 242,\n\t\"./tables/bonus/ability/wis/high.json\": 243,\n\t\"./tables/bonus/ability/wis/index.json\": 244,\n\t\"./tables/bonus/ability/wis/low.json\": 245,\n\t\"./tables/bonus/ability/wis/medium.json\": 246,\n\t\"./tables/bonus/index.json\": 247,\n\t\"./tables/common/color.json\": 248,\n\t\"./tables/common/frequency.json\": 249,\n\t\"./tables/common/index.json\": 250,\n\t\"./tables/common/language.json\": 251,\n\t\"./tables/common/rightLeft.json\": 252,\n\t\"./tables/common/rightLeftBoth.json\": 253,\n\t\"./tables/deity/archdevil.json\": 254,\n\t\"./tables/deity/demon.json\": 255,\n\t\"./tables/deity/dragon.json\": 256,\n\t\"./tables/deity/drow.json\": 257,\n\t\"./tables/deity/dwarf.json\": 258,\n\t\"./tables/deity/elf.json\": 259,\n\t\"./tables/deity/evil.json\": 260,\n\t\"./tables/deity/gnome.json\": 261,\n\t\"./tables/deity/good.json\": 262,\n\t\"./tables/deity/halfling.json\": 263,\n\t\"./tables/deity/index.json\": 264,\n\t\"./tables/deity/orc.json\": 265,\n\t\"./tables/filters.json\": 266,\n\t\"./tables/hooks.json\": 267,\n\t\"./tables/hooks/index.json\": 268,\n\t\"./tables/identity/genderExpression.json\": 269,\n\t\"./tables/identity/genderIdentity.json\": 270,\n\t\"./tables/identity/index.json\": 271,\n\t\"./tables/identity/pronouns/index.json\": 272,\n\t\"./tables/identity/pronouns/man.json\": 273,\n\t\"./tables/identity/pronouns/nonbinary.json\": 274,\n\t\"./tables/identity/pronouns/woman.json\": 275,\n\t\"./tables/identity/romanticIdentity.json\": 276,\n\t\"./tables/identity/sex.json\": 277,\n\t\"./tables/identity/sexualIdentity.json\": 278,\n\t\"./tables/identity/sexualOrientation.json\": 279,\n\t\"./tables/identity/sexualOrientation/gayLesbian/index.json\": 280,\n\t\"./tables/identity/sexualOrientation/gayLesbian/man.json\": 281,\n\t\"./tables/identity/sexualOrientation/gayLesbian/nonbinary.json\": 282,\n\t\"./tables/identity/sexualOrientation/gayLesbian/woman.json\": 283,\n\t\"./tables/identity/sexualOrientation/index.json\": 284,\n\t\"./tables/index.json\": 285,\n\t\"./tables/items/aliment.json\": 286,\n\t\"./tables/items/index.json\": 287,\n\t\"./tables/items/mundanePlural.json\": 288,\n\t\"./tables/items/precious.json\": 289,\n\t\"./tables/items/preciousPrefixed.json\": 290,\n\t\"./tables/items/weapon.json\": 291,\n\t\"./tables/items/weapon/index.json\": 292,\n\t\"./tables/items/weapon/martialfinesse.json\": 293,\n\t\"./tables/items/weapon/martialranged.json\": 294,\n\t\"./tables/items/weapon/martialweapon.json\": 295,\n\t\"./tables/items/weapon/simplefinesse.json\": 296,\n\t\"./tables/items/weapon/simpleranged.json\": 297,\n\t\"./tables/items/weapon/simpleweapon.json\": 298,\n\t\"./tables/misc/abstractWord.json\": 299,\n\t\"./tables/misc/index.json\": 300,\n\t\"./tables/misc/monster.json\": 301,\n\t\"./tables/npc-full.json\": 302,\n\t\"./tables/npc.json\": 303,\n\t\"./tables/occupation/Class/Caster.json\": 304,\n\t\"./tables/occupation/Class/Category.json\": 305,\n\t\"./tables/occupation/Class/Martial.json\": 306,\n\t\"./tables/occupation/Class/Misc.json\": 307,\n\t\"./tables/occupation/Class/index.json\": 308,\n\t\"./tables/occupation/Craftsperson.json\": 309,\n\t\"./tables/occupation/Entertainer.json\": 310,\n\t\"./tables/occupation/Government.json\": 311,\n\t\"./tables/occupation/Independent.json\": 312,\n\t\"./tables/occupation/Martial.json\": 313,\n\t\"./tables/occupation/Merchant.json\": 314,\n\t\"./tables/occupation/Outlaw.json\": 315,\n\t\"./tables/occupation/PhilosopherFields.json\": 316,\n\t\"./tables/occupation/PublicServant.json\": 317,\n\t\"./tables/occupation/Religious.json\": 318,\n\t\"./tables/occupation/Scholar.json\": 319,\n\t\"./tables/occupation/Traveller.json\": 320,\n\t\"./tables/occupation/all.json\": 321,\n\t\"./tables/occupation/index.json\": 322,\n\t\"./tables/occupation/type.json\": 323,\n\t\"./tables/personality/index.json\": 324,\n\t\"./tables/personality/worship.json\": 325,\n\t\"./tables/quirks.json\": 326,\n\t\"./tables/quirks/general.json\": 327,\n\t\"./tables/quirks/index.json\": 328,\n\t\"./tables/quirks/military.json\": 329,\n\t\"./tables/quirks/modifier/collection.json\": 330,\n\t\"./tables/quirks/modifier/index.json\": 331,\n\t\"./tables/quirks/modifier/inheritance.json\": 332,\n\t\"./tables/quirks/modifier/pet/animal.json\": 333,\n\t\"./tables/quirks/modifier/pet/index.json\": 334,\n\t\"./tables/quirks/modifier/pet/name.json\": 335,\n\t\"./tables/quirks/modifier/raceAllergy.json\": 336,\n\t\"./tables/quirks/modifier/relation.json\": 337,\n\t\"./tables/quirks/modifier/relation/familyMember.json\": 338,\n\t\"./tables/quirks/modifier/relation/index.json\": 339,\n\t\"./tables/quirks/modifier/size.json\": 340,\n\t\"./tables/quirks/nature.json\": 341,\n\t\"./tables/quirks/poor.json\": 342,\n\t\"./tables/quirks/religious.json\": 343,\n\t\"./tables/quirks/rich.json\": 344,\n\t\"./tables/quirks/traits-1.json\": 345,\n\t\"./tables/quirks/traits-2.json\": 346,\n\t\"./tables/quirks/weird.json\": 347,\n\t\"./tables/race.json\": 348,\n\t\"./tables/race/Aasimar/deity.json\": 349,\n\t\"./tables/race/Aasimar/index.json\": 350,\n\t\"./tables/race/Aasimar/name-man.json\": 351,\n\t\"./tables/race/Aasimar/name-nonbinary.json\": 352,\n\t\"./tables/race/Aasimar/name-woman.json\": 353,\n\t\"./tables/race/Aasimar/quirk-evil.json\": 354,\n\t\"./tables/race/Aasimar/quirk-good.json\": 355,\n\t\"./tables/race/Dragonborn/color.json\": 356,\n\t\"./tables/race/Dragonborn/deity.json\": 357,\n\t\"./tables/race/Dragonborn/hair.json\": 358,\n\t\"./tables/race/Dragonborn/index.json\": 359,\n\t\"./tables/race/Dragonborn/name-man.json\": 360,\n\t\"./tables/race/Dragonborn/name-nonbinary.json\": 361,\n\t\"./tables/race/Dragonborn/name-woman.json\": 362,\n\t\"./tables/race/Dragonborn/quirks.json\": 363,\n\t\"./tables/race/Dwarf.json\": 364,\n\t\"./tables/race/Dwarf/beard.json\": 365,\n\t\"./tables/race/Dwarf/deity.json\": 366,\n\t\"./tables/race/Dwarf/index.json\": 367,\n\t\"./tables/race/Dwarf/name-man.json\": 368,\n\t\"./tables/race/Dwarf/name-nonbinary.json\": 369,\n\t\"./tables/race/Dwarf/name-woman.json\": 370,\n\t\"./tables/race/Dwarf/quirks.json\": 371,\n\t\"./tables/race/Dwarf/skin.json\": 372,\n\t\"./tables/race/Dwarf/surname.json\": 373,\n\t\"./tables/race/Elf.json\": 374,\n\t\"./tables/race/Elf/Drow/index.json\": 375,\n\t\"./tables/race/Elf/Drow/quirks.json\": 376,\n\t\"./tables/race/Elf/deity.json\": 377,\n\t\"./tables/race/Elf/index.json\": 378,\n\t\"./tables/race/Elf/name-man.json\": 379,\n\t\"./tables/race/Elf/name-nonbinary.json\": 380,\n\t\"./tables/race/Elf/name-woman.json\": 381,\n\t\"./tables/race/Elf/quirks.json\": 382,\n\t\"./tables/race/Elf/skin.json\": 383,\n\t\"./tables/race/Elf/skin/color.json\": 384,\n\t\"./tables/race/Elf/skin/index.json\": 385,\n\t\"./tables/race/Elf/surname.json\": 386,\n\t\"./tables/race/Firbolg/deity.json\": 387,\n\t\"./tables/race/Firbolg/index.json\": 388,\n\t\"./tables/race/Firbolg/name-man.json\": 389,\n\t\"./tables/race/Firbolg/name-nonbinary.json\": 390,\n\t\"./tables/race/Firbolg/name-woman.json\": 391,\n\t\"./tables/race/Firbolg/quirks.json\": 392,\n\t\"./tables/race/Firbolg/skin.json\": 393,\n\t\"./tables/race/Gnome.json\": 394,\n\t\"./tables/race/Gnome/deity.json\": 395,\n\t\"./tables/race/Gnome/index.json\": 396,\n\t\"./tables/race/Gnome/name-man.json\": 397,\n\t\"./tables/race/Gnome/name-nonbinary.json\": 398,\n\t\"./tables/race/Gnome/name-woman.json\": 399,\n\t\"./tables/race/Gnome/name/any.json\": 400,\n\t\"./tables/race/Gnome/name/index.json\": 401,\n\t\"./tables/race/Gnome/name/man-1.json\": 402,\n\t\"./tables/race/Gnome/name/man-2.json\": 403,\n\t\"./tables/race/Gnome/name/man-3.json\": 404,\n\t\"./tables/race/Gnome/name/man-4.json\": 405,\n\t\"./tables/race/Gnome/name/man.json\": 406,\n\t\"./tables/race/Gnome/name/woman-1.json\": 407,\n\t\"./tables/race/Gnome/name/woman-2.json\": 408,\n\t\"./tables/race/Gnome/name/woman-3.json\": 409,\n\t\"./tables/race/Gnome/name/woman-4.json\": 410,\n\t\"./tables/race/Gnome/name/woman.json\": 411,\n\t\"./tables/race/Gnome/quirks.json\": 412,\n\t\"./tables/race/Goblin/deity.json\": 413,\n\t\"./tables/race/Goblin/index.json\": 414,\n\t\"./tables/race/Goblin/name-man.json\": 415,\n\t\"./tables/race/Goblin/name-nonbinary.json\": 416,\n\t\"./tables/race/Goblin/name-woman.json\": 417,\n\t\"./tables/race/Goliath/deity.json\": 418,\n\t\"./tables/race/Goliath/hair.json\": 419,\n\t\"./tables/race/Goliath/hairTattoos.json\": 420,\n\t\"./tables/race/Goliath/index.json\": 421,\n\t\"./tables/race/Goliath/name-man.json\": 422,\n\t\"./tables/race/Goliath/name-nonbinary.json\": 423,\n\t\"./tables/race/Goliath/name-woman.json\": 424,\n\t\"./tables/race/Goliath/names/adjective.json\": 425,\n\t\"./tables/race/Goliath/names/animal-action.json\": 426,\n\t\"./tables/race/Goliath/names/animal-noun.json\": 427,\n\t\"./tables/race/Goliath/names/craft-action.json\": 428,\n\t\"./tables/race/Goliath/names/craft-noun.json\": 429,\n\t\"./tables/race/Goliath/names/fighting-action.json\": 430,\n\t\"./tables/race/Goliath/names/fighting-noun.json\": 431,\n\t\"./tables/race/Goliath/names/index.json\": 432,\n\t\"./tables/race/Goliath/names/mystic-action.json\": 433,\n\t\"./tables/race/Goliath/names/mystic-noun.json\": 434,\n\t\"./tables/race/Goliath/names/noun.json\": 435,\n\t\"./tables/race/Goliath/quirks-1.json\": 436,\n\t\"./tables/race/Goliath/quirks-2.json\": 437,\n\t\"./tables/race/Half-Dwarf/deity.json\": 438,\n\t\"./tables/race/Half-Dwarf/index.json\": 439,\n\t\"./tables/race/Half-Dwarf/name-man.json\": 440,\n\t\"./tables/race/Half-Dwarf/name-nonbinary.json\": 441,\n\t\"./tables/race/Half-Dwarf/name-woman.json\": 442,\n\t\"./tables/race/Half-Dwarf/skin.json\": 443,\n\t\"./tables/race/Half-Elf/deity.json\": 444,\n\t\"./tables/race/Half-Elf/index.json\": 445,\n\t\"./tables/race/Half-Elf/name-man.json\": 446,\n\t\"./tables/race/Half-Elf/name-nonbinary.json\": 447,\n\t\"./tables/race/Half-Elf/name-woman.json\": 448,\n\t\"./tables/race/Half-Elf/skin.json\": 449,\n\t\"./tables/race/Half-Orc/deity.json\": 450,\n\t\"./tables/race/Half-Orc/index.json\": 451,\n\t\"./tables/race/Half-Orc/name-man.json\": 452,\n\t\"./tables/race/Half-Orc/name-nonbinary.json\": 453,\n\t\"./tables/race/Half-Orc/name-woman.json\": 454,\n\t\"./tables/race/Half-Orc/skin.json\": 455,\n\t\"./tables/race/Halfling.json\": 456,\n\t\"./tables/race/Halfling/deity.json\": 457,\n\t\"./tables/race/Halfling/index.json\": 458,\n\t\"./tables/race/Halfling/name-man.json\": 459,\n\t\"./tables/race/Halfling/name-nonbinary.json\": 460,\n\t\"./tables/race/Halfling/name-woman.json\": 461,\n\t\"./tables/race/Halfling/quirks.json\": 462,\n\t\"./tables/race/Halfling/surname.json\": 463,\n\t\"./tables/race/Human/deity.json\": 464,\n\t\"./tables/race/Human/index.json\": 465,\n\t\"./tables/race/Human/name-man.json\": 466,\n\t\"./tables/race/Human/name-nonbinary.json\": 467,\n\t\"./tables/race/Human/name-woman.json\": 468,\n\t\"./tables/race/Human/surname.json\": 469,\n\t\"./tables/race/Kenku/deity.json\": 470,\n\t\"./tables/race/Kenku/index.json\": 471,\n\t\"./tables/race/Kenku/name-man.json\": 472,\n\t\"./tables/race/Kenku/name-nonbinary.json\": 473,\n\t\"./tables/race/Kenku/name-woman.json\": 474,\n\t\"./tables/race/Kenku/names/index.json\": 475,\n\t\"./tables/race/Kenku/names/kenkunameanimal.json\": 476,\n\t\"./tables/race/Kenku/names/kenkunamefighting.json\": 477,\n\t\"./tables/race/Kenku/names/kenkunamemetal.json\": 478,\n\t\"./tables/race/Kenku/names/kenkunamequiet.json\": 479,\n\t\"./tables/race/Kenku/quirks.json\": 480,\n\t\"./tables/race/Kenku/skin.json\": 481,\n\t\"./tables/race/Kenku/skin/color.json\": 482,\n\t\"./tables/race/Kenku/skin/featherTexture.json\": 483,\n\t\"./tables/race/Kenku/skin/index.json\": 484,\n\t\"./tables/race/Lizardfolk/deity.json\": 485,\n\t\"./tables/race/Lizardfolk/index.json\": 486,\n\t\"./tables/race/Lizardfolk/name-man.json\": 487,\n\t\"./tables/race/Lizardfolk/name-nonbinary.json\": 488,\n\t\"./tables/race/Lizardfolk/name-woman.json\": 489,\n\t\"./tables/race/Lizardfolk/quirks-1.json\": 490,\n\t\"./tables/race/Lizardfolk/quirks-2.json\": 491,\n\t\"./tables/race/Orc/deity.json\": 492,\n\t\"./tables/race/Orc/index.json\": 493,\n\t\"./tables/race/Orc/name-man.json\": 494,\n\t\"./tables/race/Orc/name-nonbinary.json\": 495,\n\t\"./tables/race/Orc/name-woman.json\": 496,\n\t\"./tables/race/Orc/skin.json\": 497,\n\t\"./tables/race/Orc/skin/color.json\": 498,\n\t\"./tables/race/Orc/skin/index.json\": 499,\n\t\"./tables/race/Orc/surname.json\": 500,\n\t\"./tables/race/Tabaxi/deity.json\": 501,\n\t\"./tables/race/Tabaxi/index.json\": 502,\n\t\"./tables/race/Tabaxi/name-man.json\": 503,\n\t\"./tables/race/Tabaxi/name-nonbinary.json\": 504,\n\t\"./tables/race/Tabaxi/name-woman.json\": 505,\n\t\"./tables/race/Tabaxi/name/first.json\": 506,\n\t\"./tables/race/Tabaxi/name/index.json\": 507,\n\t\"./tables/race/Tabaxi/name/last.json\": 508,\n\t\"./tables/race/Tabaxi/name/noun.json\": 509,\n\t\"./tables/race/Tabaxi/name/number.json\": 510,\n\t\"./tables/race/Tabaxi/quirkObsession.json\": 511,\n\t\"./tables/race/Tabaxi/quirks.json\": 512,\n\t\"./tables/race/Tabaxi/skin.json\": 513,\n\t\"./tables/race/Tabaxi/skin/color.json\": 514,\n\t\"./tables/race/Tabaxi/skin/index.json\": 515,\n\t\"./tables/race/Tabaxi/skin/pattern.json\": 516,\n\t\"./tables/race/Tabaxi/skin/texture.json\": 517,\n\t\"./tables/race/Tiefling/deity.json\": 518,\n\t\"./tables/race/Tiefling/index.json\": 519,\n\t\"./tables/race/Tiefling/name-evil.json\": 520,\n\t\"./tables/race/Tiefling/name-good.json\": 521,\n\t\"./tables/race/Tiefling/name-man.json\": 522,\n\t\"./tables/race/Tiefling/name-nonbinary.json\": 523,\n\t\"./tables/race/Tiefling/name-woman.json\": 524,\n\t\"./tables/race/Tiefling/name/evil.json\": 525,\n\t\"./tables/race/Tiefling/name/good.json\": 526,\n\t\"./tables/race/Tiefling/name/index.json\": 527,\n\t\"./tables/race/Tiefling/name/neutral.json\": 528,\n\t\"./tables/race/Tiefling/name/unaligned.json\": 529,\n\t\"./tables/race/Tiefling/skin.json\": 530,\n\t\"./tables/race/Triton/deity.json\": 531,\n\t\"./tables/race/Triton/hair-color.json\": 532,\n\t\"./tables/race/Triton/hair.json\": 533,\n\t\"./tables/race/Triton/index.json\": 534,\n\t\"./tables/race/Triton/name-man.json\": 535,\n\t\"./tables/race/Triton/name-nonbinary.json\": 536,\n\t\"./tables/race/Triton/name-woman.json\": 537,\n\t\"./tables/race/Triton/skin.json\": 538,\n\t\"./tables/race/Triton/surname.json\": 539,\n\t\"./tables/race/Troglodyte/deity.json\": 540,\n\t\"./tables/race/Troglodyte/index.json\": 541,\n\t\"./tables/race/Troglodyte/name-man.json\": 542,\n\t\"./tables/race/Troglodyte/name-nonbinary.json\": 543,\n\t\"./tables/race/Troglodyte/name-woman.json\": 544,\n\t\"./tables/race/common/index.json\": 545,\n\t\"./tables/race/common/name-nonbinary.json\": 546,\n\t\"./tables/race/index.json\": 547,\n\t\"./tables/relationship/index.json\": 548,\n\t\"./tables/relationship/relative.json\": 549,\n\t\"./tables/todo/contest.json\": 550,\n\t\"./tables/todo/evilworship.json\": 551,\n\t\"./tables/todo/furniture.json\": 552,\n\t\"./tables/todo/highattractiveness.json\": 553,\n\t\"./tables/todo/hooks1.json\": 554,\n\t\"./tables/todo/hooks2.json\": 555,\n\t\"./tables/todo/index.json\": 556,\n\t\"./tables/todo/organisation.json\": 557,\n\t\"./tables/todo/personality.json\": 558,\n\t\"./tables/todo/profession.json\": 559,\n\t\"./tables/todo/racedwarf.json\": 560,\n\t\"./tables/todo/raceelf.json\": 561,\n\t\"./tables/todo/racegnome.json\": 562,\n\t\"./tables/todo/racehalfling.json\": 563,\n\t\"./tables/todo/relationshipstatus.json\": 564,\n\t\"./tables/todo/tritonquirks.json\": 565,\n\t\"./tables/todo/werebeast.json\": 566,\n\t\"./tables/traits/age.json\": 567,\n\t\"./tables/traits/age/additive.json\": 568,\n\t\"./tables/traits/age/bonusRegular.json\": 569,\n\t\"./tables/traits/age/bonusSmall.json\": 570,\n\t\"./tables/traits/age/index.json\": 571,\n\t\"./tables/traits/age/multiplier3.json\": 572,\n\t\"./tables/traits/age/multiplier6.json\": 573,\n\t\"./tables/traits/alignment/index.json\": 574,\n\t\"./tables/traits/alignment/tendancy.json\": 575,\n\t\"./tables/traits/alignmentMoral.json\": 576,\n\t\"./tables/traits/bodyPart.json\": 577,\n\t\"./tables/traits/bodyPart/extra/finger.json\": 578,\n\t\"./tables/traits/bodyPart/extra/index.json\": 579,\n\t\"./tables/traits/bodyPart/head.json\": 580,\n\t\"./tables/traits/bodyPart/head/index.json\": 581,\n\t\"./tables/traits/bodyPart/head/sided.json\": 582,\n\t\"./tables/traits/bodyPart/head/sidedPlural.json\": 583,\n\t\"./tables/traits/bodyPart/head/unsided.json\": 584,\n\t\"./tables/traits/bodyPart/index.json\": 585,\n\t\"./tables/traits/bodyPart/missing/eye.json\": 586,\n\t\"./tables/traits/bodyPart/missing/fingers.json\": 587,\n\t\"./tables/traits/bodyPart/missing/index.json\": 588,\n\t\"./tables/traits/bodyPart/missing/limb.json\": 589,\n\t\"./tables/traits/bodyPart/sided.json\": 590,\n\t\"./tables/traits/bodyPart/sidedPlural.json\": 591,\n\t\"./tables/traits/bodyPart/unsided.json\": 592,\n\t\"./tables/traits/brand.json\": 593,\n\t\"./tables/traits/degree/degree.json\": 594,\n\t\"./tables/traits/degree/degree2.json\": 595,\n\t\"./tables/traits/degree/index.json\": 596,\n\t\"./tables/traits/descriptor.json\": 597,\n\t\"./tables/traits/eyecolor.json\": 598,\n\t\"./tables/traits/face/attractiveness.json\": 599,\n\t\"./tables/traits/face/beard.json\": 600,\n\t\"./tables/traits/face/beard/index.json\": 601,\n\t\"./tables/traits/face/beard/length.json\": 602,\n\t\"./tables/traits/face/beard/shape.json\": 603,\n\t\"./tables/traits/face/index.json\": 604,\n\t\"./tables/traits/face/looks/bad.json\": 605,\n\t\"./tables/traits/face/looks/badModifier.json\": 606,\n\t\"./tables/traits/face/looks/good.json\": 607,\n\t\"./tables/traits/face/looks/goodModifier.json\": 608,\n\t\"./tables/traits/face/looks/index.json\": 609,\n\t\"./tables/traits/face/looks/normal.json\": 610,\n\t\"./tables/traits/face/looks/normalModifier.json\": 611,\n\t\"./tables/traits/face/shape.json\": 612,\n\t\"./tables/traits/hair.json\": 613,\n\t\"./tables/traits/hair/color.json\": 614,\n\t\"./tables/traits/hair/index.json\": 615,\n\t\"./tables/traits/hair/length.json\": 616,\n\t\"./tables/traits/hair/style.json\": 617,\n\t\"./tables/traits/height.json\": 618,\n\t\"./tables/traits/index.json\": 619,\n\t\"./tables/traits/modifier.json\": 620,\n\t\"./tables/traits/physical.json\": 621,\n\t\"./tables/traits/physical/index.json\": 622,\n\t\"./tables/traits/physical/piercingAmount.json\": 623,\n\t\"./tables/traits/physical/traits-1.json\": 624,\n\t\"./tables/traits/physical/traits-2.json\": 625,\n\t\"./tables/traits/skin/human.json\": 626,\n\t\"./tables/traits/skin/humanColor.json\": 627,\n\t\"./tables/traits/skin/index.json\": 628,\n\t\"./tables/traits/skin/nonhuman.json\": 629,\n\t\"./tables/traits/skin/nonhumanColor.json\": 630,\n\t\"./tables/traits/skin/scales.json\": 631,\n\t\"./tables/traits/skin/scalesColor.json\": 632,\n\t\"./tables/traits/skin/scalesTexture.json\": 633,\n\t\"./tables/traits/skin/textureSkin.json\": 634,\n\t\"./tables/traits/skin/tone.json\": 635,\n\t\"./tables/traits/smell/bad.json\": 636,\n\t\"./tables/traits/smell/good.json\": 637,\n\t\"./tables/traits/smell/index.json\": 638,\n\t\"./tables/traits/tattoo.json\": 639,\n\t\"./tables/traits/tattoo/animal.json\": 640,\n\t\"./tables/traits/tattoo/index.json\": 641,\n\t\"./tables/traits/tattoo/tattooadj.json\": 642,\n\t\"./tables/traits/tattoo/text.json\": 643,\n\t\"./tables/traits/weight.json\": 644\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 221;"],"sourceRoot":""}