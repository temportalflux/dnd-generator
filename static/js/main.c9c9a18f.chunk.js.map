{"version":3,"sources":["lib/pluralize.js","lib/randInt.js","lib/clipboard.js","generator/modules/index.js","generator/modules/roll.js","generator/modules/rand.js","generator/modules/randInt.js","generator/modules/regex.js","generator/modules/isInRange.js","generator/modules/permutate.js","generator/modules/evalAtCtx.js","generator/modules/createExecutor.js","storage/Entry.js","storage/Table.js","generator/appendModifiers.js","storage/NpcSchema.js","storage/TableCollection.js","lib/str.js","components/StorageAccordion.jsx","components/NPC/EDisplayModes.js","storage/Filter.js","components/TableFilter.jsx","storage/GeneratedEntry.js","storage/NpcData.js","components/NPC/DetailViewEntry.jsx","components/NPC/ArticleContent.jsx","components/NPC/MenuBar.jsx","components/NPC/DetailView.jsx","components/NPC/ArticleView.jsx","view/NpcView.jsx","storage/Session.js","components/DataTableView.jsx","view/DataView.jsx","view/HomeView.jsx","routes.js","components/HeaderBarLink.jsx","components/HeaderBar.jsx","view/ViewContainer.jsx","App.jsx","index.js","lib/rand.js","data sync /^/tables.*/.json$"],"names":["module","exports","singular","plural","isPlural","min","max","Math","ceil","floor","random","html","container","document","createElement","innerHTML","style","position","pointerEvents","opacity","body","appendChild","window","getSelection","removeAllRanges","range","createRange","selectNode","addRange","execCommand","err","console","error","removeChild","roll","tablePath","data","table","TableCollection","get","getTable","filter","ignore","rand","match","value","require","split","randInt","preset","undefined","params","map","str","parseInt","ret","includes","regex","RegExp","test","rangeParams","permutate","log","result","length","push","splice","VARIABLE_REGEX","MACRO_REGEX","PURE_VARIABLE_REGEX","inlineEval","text","context","extendedContenxt","lodash","assign","pluralize","reduce","formattedText","replace","group","code","ctx","fullText","Function","call","e","evalAtCtx","parseMacro","macro","execFunc","args","createExecutor","executor","evaledArgs","Execs","accumulateEntries","onUndefinedKey","accum","entryData","i","entry","Entry","from","key","getKey","this","weight","redirect","source","modifiers","stringify","description","articleContent","bIsOptional","children","canReroll","collection","idx","readFrom","index","isOptional","childrenWithoutKeys","hasSource","tableCollection","evaluateWithData","getSourceTableKey","Object","keys","Table","events","EventTarget","valueMacro","entries","keyPath","obj","entriesWithoutKeys","rows","getKeyPathFromTablePath","values","dispatchOnChangedRowCount","indexOf","prev","next","dispatchEvent","CustomEvent","detail","callback","addEventListener","removeEventListener","getRows","hasFilter","type","getFilterType","getOptions","current","toAppend","cloneDeep","hasValueMacro","filterContext","getDefaultFilter","hasRedirector","redirector","getRedirector","rollable","Array","isArray","shift","presetEntry","find","totalWeight","row","getWeight","weight_sum","warn","chooseRandomWithWeight","getKeyPath","hasGlobalModifiers","getGlobalModifiers","globalModifierEntry","matched","toPairs","modifier","hasOwnProperty","concat","mapValues","modifierList","targetProperty","curve","keyframes","currentIndex","nextIndex","valueInt","getInt","lowerIndex","higherIndex","lowerInput","higherInput","t","lerped","toIntOp","intOp","EVENT_ONCHANGEDFILTER","COLUMNS","accessor","Header","Field","category","NpcSchema","fields","fieldOrder","generationOrder","categories","schema","fieldData","field","addField","getCategory","sort","loadItem","directory","fileName","isIndex","content","itemPath","accumulator","itemPathSplit","slice","join","immediateDirectory","item","assignIn","mapKeys","_","loadTableEntry","TABLE_COLLECTION_CACHE","tables","npcSchema","loadTables","EVENT_ONCHANGED","initialize","event","missingKeyDatum","getTablePathFromKeyPath","getTableKeys","set","camelCaseToTitle","word","toUpperCase","substr","toLowerCase","StorageAccordion","storageKey","entryComponentType","active","useState","storage","expandedEntryKeys","setExpandedEntryKeys_state","setExpandedEntryKeys","remove","removeExpandedEntryKey","isEntryExpanded","handleAccordionClick","Accordion","margin","entryKey","entryProps","React","storageAccordianComponent","onClick","forceCollapse","DISPLAY_MODES","Readable","Detailed","getDisplayIconForMode","displayMode","getNextDisplayMode","Filter","all","allFilters","TableFilter","tableKey","setValue","onDropdownChanged","isValueAValidFilter","defaultFilter","marginTop","marginBottom","minValue","maxValue","onChange","Dropdown","fluid","search","selection","multiple","placeholder","options","EntryLinker","owner","property","onEvent","subscribingTo","subscribed","entryPath","npc","getEntry","entryPaths","uniq","forEach","path","getEntryForPath","add","evt","appendArgsForEntry","a","linker","onEvt","GeneratedEntry","npcData","schemaEntry","stringifyLinker","onStringifyLinkerEvent","bind","stringifyCached","generationDependencyLinker","onGenerationDependencyEvent","modifyingLinker","onModifiersChanged","collectionLinker","onCollectionEntriesChanged","modifierSources","totalModifyingValue","forcedFilter","postOperationModifiers","generated","generatedChildren","isEnabled","areAllDependenciesUsable","parent","isUsable","getGenerationDependencies","allDepsAreUsable","dependencyKeyPath","bIsEnabled","enabledEntries","dispatchEnabledStateChanged","dispatchToSubscribers","child","getField","name","toPath","getSource","globalData","sourceTableKey","getCanReroll","dispatchToSubscriptions","getModifierFor","unsubscribe","getModifyingEntryKeys","getStringifyDependencies","getOurCollections","clearLinking","getPreset","clearSaveState","dispose","presetData","prevValueOrKey","hasKey","getFilterValue","redirectPath","getGenerationMacro","hasChildren","getChildren","clone","readEntry","updateString","subscribe","getModifiedData","writeSaveState","regenerateChildren","onChildGenerated","regenerate","localValue","getModifiedValue","toString","asString","tmpValues","generatedObjValue","getModifyingEntryData_internal","getModifierInternal","rawModifier","localData","getChildModifiedData","multiplier","m","multiply","adder","getModifyingEntryData","v","applyModifier","objectEqualityDeepRecursive","b","Error","getRawValue","postOperations","retVal","genEntry","getGeneratedEntry","getStringifyTemplate","getDescription","template","matchAll","getChild","localizedGlobalData","string","getArticleContent","assert","deps","getSubscribedKeys","entryKeys","getCollectionEntryKeys","subpath","NpcData","sever","items","remaining","has","updateSaveState","saveState","getSaveState","NPC_TEMPORARY_DATA","state","save","fullKey","itemCount","status","EVENTS","EVENT_INITIALIZED","getNpcSchema","onInitialized","getSchema","getFields","addEntry","sessionStorage","removeItem","regenerateAll","getState","JSON","parse","getItem","npcDataInUrl","queryString","location","stateString","encoded","encodeURIComponent","href","getGenerationOrder","loop","forAllEntries","setItem","makeModifierPopup","title","popupTitle","itemMap","Popup","trigger","as","EntryView","propertyKey","parentEntry","npcModifiedData","isMissingSourceTable","k","refresh","useEffect","onChanged","shortid","onDispose","addListenerOnChanged","addListenerOnUpdateString","addListenerOnModified","addListenerOnUpdateCollection","addListenerOnDispose","addListenerOnEnabledChanged","removeListenerOnChanged","removeListenerOnUpdateString","removeListenerOnModified","removeListenerOnUpdateCollection","removeListenerOnDispose","removeListenerOnEnabledChanged","rawValue","modifiedValue","modifiersFromEntry","hasModifiers","modifiersOfEntry","getModifiedByEntryKeys","isModified","stringifyDeps","stringifySubscribed","generationDependencies","generationDependedOnBy","canRegenerate","collectionEntryKeys","collectionEntryObj","collectionEntry","isValueEquivalentToNone","Menu","secondary","Item","fitted","Checkbox","toggle","disabled","checked","setIsEnabled","Title","Icon","Button","icon","Content","borderLeft","paddingLeft","marginLeft","Form","Group","widths","hasValue","label","control","color","stringified","childKey","childEntry","DataViewEntry","toSentenceCase","sentence","getRenderedText","InlineEntryComponent","getComponent","InlineEntryItem","rerollAs","renderedText","hoverable","fontWeight","size","getName","ArticleContent","usePlainText","createEntryItem","strength","dexterity","constitution","intelligence","wisdom","charisma","ethicalPositive","ethicalNeutral","ethicalNegative","moralPositive","moralNeutral","moralNegative","surname","pronouns","genderIdentity","genderExpression","sex","romanticIdentity","sexualIdentity","sexualOrientation","profession","occupationalArea","age","eyeColor","height","face","race","hair","skin","beard","physicalTraitsMap","physicalTraits","List","deity","worship","quirkList","hooks","relationshipStatus","getLink","bulleted","desc","getDescriptionString","n","realFeet","feet","toFeet","compact","striped","textAlign","Body","Row","Cell","MenuBar","switchDisplayMode","menuItemsRight","getEntryLink","borderless","pointing","copyToClipboard","renderToString","clear","marginRight","corner","DetailViewCategory","categoryFields","fieldKey","DetailView","props","getCategories","getEntriesForCategory","ArticleView","CURRENT_DISPLAYMODE_STORAGE","NpcView","parsedNpcData","getCurrentLinkData","protocol","host","pathname","refreshWith","setDisplayMode","nextMode","onTableCollectionChanged","generate","addOnChanged","removeOnChanged","onNpcInitialized","toggleOnInitialized","setState","Loader","View","view","getDataTable","getTableAtPath","DataTableView","dataTable","columns","useMemo","DataTable","rowCount","setRowCount","subscribeOnChangedRowCount","onChangedRowCount","unsubscribeOnChangedRowCount","details","useTable","getTableProps","getTableBodyProps","headerGroups","prepareRow","Container","headerGroup","getHeaderGroupProps","headers","column","HeaderCell","getHeaderProps","render","getRowProps","cells","cell","getCellProps","DataView","urlParams","getTableTree","makeTreeNode","pathItem","nodeDetails","allNodeProperties","subNodeProperties","hasTable","propKey","HomeView","Component","routes","HeaderBarLink","HeaderBar","onClearStorage","ViewContainer","page","App","onViewChanged","subscribeOnChanged","unsubscribeOnChanged","id","Routes","react","version","node","process","versions","ReactDOM","getElementById","webpackContext","req","webpackContextResolve","__webpack_require__","o","resolve"],"mappings":"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","file":"static/js/main.c9c9a18f.chunk.js","sourcesContent":["module.exports = ({isPlural}, singular, plural) => !isPlural ? singular : plural;","/**\r\n * Returns a random integer between min (inclusive) and max (inclusive).\r\n * The value is no lower than min (or the next integer greater than min\r\n * if min isn't an integer) and no greater than max (or the next integer\r\n * lower than max if max isn't an integer).\r\n * Using Math.round() will give you a non-uniform distribution!\r\n */\r\nmodule.exports = (min, max) =>\r\n{\r\n\tmin = Math.ceil(min);\r\n\tmax = Math.floor(max);\r\n\treturn Math.floor(Math.random() * (max - min + 1)) + min;\r\n}","\r\nfunction copyTextToClipboard(html)\r\n{\r\n\t// Create an iframe (isolated container) for the HTML\r\n  var container = document.createElement('div');\r\n  container.innerHTML = html;\r\n  \r\n  // Hide element\r\n  container.style.position = 'fixed';\r\n  container.style.pointerEvents = 'none';\r\n\tcontainer.style.opacity = 0;\r\n\t\r\n  // Mount the iframe to the DOM to make `contentWindow` available\r\n  document.body.appendChild(container);\r\n\r\n\t// Clear all selected nodes\r\n  window.getSelection().removeAllRanges();\r\n  \r\n  // Add the container as the only selected node\r\n  var range = document.createRange();\r\n  range.selectNode(container);\r\n  window.getSelection().addRange(range);\r\n\r\n  // Copy selected nodes to clipboard\r\n\ttry\r\n\t{\r\n\t\tdocument.execCommand('copy');\r\n\t}\r\n\tcatch (err)\r\n\t{\r\n\t\tconsole.error(err);\r\n\t}\r\n  \r\n  // Remove the iframe\r\n  document.body.removeChild(container);\r\n}\r\n\r\nmodule.exports = copyTextToClipboard;","import roll from './roll';\r\nimport rand from './rand';\r\nimport randInt from './randInt';\r\nimport regex from './regex';\r\nimport isInRange from './isInRange';\r\nimport permutate from './permutate';\r\n\r\nexport default {\r\n\troll: roll,\r\n\trand: rand,\r\n\trandInt: randInt,\r\n\tregex: regex,\r\n\trange: isInRange,\r\n\tpermutate: permutate,\r\n};","import TableCollection from '../../storage/TableCollection';\r\n\r\nexport default function exec(tablePath, data)\r\n{\r\n\tconst table = TableCollection.get().getTable(tablePath);\r\n\tif (!table)\r\n\t{\r\n\t\t//console.error(`Could not find table for path ${tablePath}`);\r\n\t\treturn undefined;\r\n\t}\r\n\treturn table.roll(data.filter, data, data.ignore);\r\n}","export default function exec(match)\r\n{\r\n\treturn {\r\n\t\tvalue: require('../../lib/rand')(match.split(','))\r\n\t};\r\n}","export default function exec(match, {preset, ignore})\r\n{\r\n\tif (preset !== undefined) return { value: preset };\r\n\tconst randInt = require('../../lib/randInt');\r\n\tconst params = match.split(',').map(str => parseInt(str, 10));\r\n\tlet ret = undefined;\r\n\tdo\r\n\t{\r\n\t\tret = randInt(params[0], params[1]);\r\n\t} while (ignore !== undefined && ignore.includes(ret))\r\n\treturn { value: ret };\r\n}","export default function exec(match, data)\r\n{\r\n\tif (data === undefined) return false;\r\n\tconst value = `${data.value}`;\r\n\treturn new RegExp(match).test(value);\r\n}","export default function exec(match, data)\r\n{\r\n\tconst rangeParams = match.split(',').map((str) => parseInt(str, 10));\r\n\treturn data !== undefined\r\n\t\t&& typeof data.value === 'number'\r\n\t\t&& rangeParams[0] <= data.value\r\n\t\t&& data.value <= rangeParams[1];\r\n}","export default function exec(match)\r\n{\r\n\tconsole.log(match);\r\n\tconst params = match.split(',');\r\n\tconst result = [];\r\n\twhile (params.length > 0)\r\n\t{\r\n\t\t// remove a random item from params, and add to the end of result\r\n\t\tresult.push(params.splice(\r\n\t\t\t// index of the next value\r\n\t\t\tMath.floor(Math.random() * params.length),\r\n\t\t\t1\r\n\t\t)[0]);\r\n\t}\r\n\tconsole.log(result);\r\n\treturn {\r\n\t\tvalue: result\r\n\t};\r\n}","import lodash from 'lodash';\r\nimport randInt from '../../lib/randInt';\r\nimport pluralize from '../../lib/pluralize';\r\n\r\n// https://stackoverflow.com/questions/8403108/calling-eval-in-particular-context\r\n// https://stackoverflow.com/questions/543533/restricting-eval-to-a-narrow-scope\r\nfunction evalAtCtx(code, ctx, fullText)\r\n{\r\n\t// Ignore the eslint warning about the Function contructor just being eval.\r\n\t// Yes eval is 'evil', but this is a controlled usage with pre-approved input.\r\n\t/*eslint no-new-func: 0*/\r\n\ttry\r\n\t{\r\n\t\treturn (new Function(`with(this) { return ${code}; }`).call(ctx));\r\n\t}\r\n\tcatch (e)\r\n\t{\r\n\t\t//console.error(`Error parsing \"${code}\" in text \"${fullText}\" for context`, lodash.cloneDeep(context), e);\r\n\t\treturn undefined;\r\n\t}\r\n}\r\n\r\n// if grouping has periods ('.'), then it definitely relies on another value external to the hierarchy\r\n// (all non-lineage values have at least a category and key, separated by a period)\r\nexport const VARIABLE_REGEX = new RegExp(/\\$\\((.*?)\\)/, 'g');\r\nexport const MACRO_REGEX = new RegExp(/\\$#(.*?)#/, 'g');\r\nexport const PURE_VARIABLE_REGEX = new RegExp(/\\$\\(([.a-zA-Z]*?)\\)/, 'g');\r\n\r\nexport function inlineEval(text, context)\r\n{\r\n\tconst extendedContenxt = lodash.assign({}, context, {\r\n\t\trandInt: randInt,\r\n\t\tpluralize: pluralize,\r\n\t});\r\n\treturn [VARIABLE_REGEX, MACRO_REGEX].reduce((formattedText, regex) => (\r\n\t\tformattedText.replace(regex, (match, group) => evalAtCtx(group, extendedContenxt, formattedText))\r\n\t), text);\r\n}","import Execs from './index';\r\nimport {inlineEval} from './evalAtCtx';\r\n\r\nexport function parseMacro(macro)\r\n{\r\n\tconst regex = new RegExp(`^\\\\{(.*):(.*)\\\\}$`);\r\n\tconst match = macro.match(regex);\r\n\tif (match && match.length >= 2)\r\n\t{\r\n\t\treturn {\r\n\t\t\texecFunc: match[1],\r\n\t\t\targs: match[2],\r\n\t\t};\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nexport function createExecutor(macro)\r\n{\r\n\tconst executor = parseMacro(macro);\r\n\tif (executor)\r\n\t{\r\n\t\treturn (data) => {\r\n\t\t\tconst evaledArgs = inlineEval(executor.args, data);\r\n\t\t\treturn Execs[executor.execFunc](evaledArgs, data);\r\n\t\t};\r\n\t}\r\n\treturn undefined;\r\n}","import {parseMacro} from '../generator/modules/createExecutor';\r\n\r\nexport function accumulateEntries(data, context, onUndefinedKey=undefined)\r\n{\r\n\treturn data.reduce((accum, entryData, i) =>\r\n\t{\r\n\t\tconst entry = Entry.from(entryData, i);\r\n\t\tif (entry.key === undefined)\r\n\t\t{\r\n\t\t\tif (onUndefinedKey !== undefined && typeof onUndefinedKey === 'function')\r\n\t\t\t{\r\n\t\t\t\tonUndefinedKey(entry);\r\n\t\t\t}\r\n\t\t}\r\n\t\taccum[entry.getKey()] = entry;\r\n\t\treturn accum;\r\n\t}, {});\r\n}\r\n\r\nexport class Entry\r\n{\r\n\r\n\tstatic from(data, idx)\r\n\t{\r\n\t\tconst entry = new Entry();\r\n\t\tentry.readFrom(data, idx);\r\n\t\treturn entry;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.weight = undefined;\r\n\t\tthis.key = undefined;\r\n\r\n\t\tthis.redirect = undefined;\r\n\t\tthis.source = undefined;\r\n\r\n\t\tthis.value = undefined;\r\n\t\tthis.modifiers = {};\r\n\r\n\t\tthis.stringify = undefined;\r\n\t\tthis.description = undefined;\r\n\t\tthis.articleContent = undefined;\r\n\r\n\t\t// defines if the entry is can disabled\r\n\t\tthis.bIsOptional = false;\r\n\r\n\t\tthis.children = [];\r\n\r\n\t\tthis.canReroll = undefined;\r\n\t\t/**\r\n\t\t * The key for another entry, whose value is an array,\r\n\t\t * which GeneratedEntries that this entry is a schema for,\r\n\t\t * are considered a part of during `GeneratedEntry#getModifiedData`.\r\n\t\t**/\r\n\t\tthis.collection = undefined;\r\n\t}\r\n\r\n\treadFrom(data, idx)\r\n\t{\r\n\t\tthis.weight = data.weight || 1;\r\n\t\tthis.key = data.key;\r\n\t\tthis.index = idx;\r\n\r\n\t\tthis.redirect = data.redirect;\r\n\t\tthis.source = data.source;\r\n\r\n\t\tthis.value = data.value;\r\n\t\tthis.modifiers = data.modifiers || {};\r\n\r\n\t\tthis.stringify = data.stringify;\r\n\t\tthis.description = data.description;\r\n\t\tthis.articleContent = data.articleContent;\r\n\t\tthis.bIsOptional = data.isOptional;\r\n\r\n\t\tthis.childrenWithoutKeys = [];\r\n\t\tthis.children = accumulateEntries(data.children || [], `entry '${this.key}'`, (i) => this.childrenWithoutKeys.push(i));\r\n\r\n\t\tthis.canReroll = data.canReroll;\r\n\t\tthis.collection = data.collection;\r\n\t}\r\n\r\n\thasKey()\r\n\t{\r\n\t\treturn this.key !== undefined;\r\n\t}\r\n\r\n\tgetKey()\r\n\t{\r\n\t\treturn this.key || this.index;\r\n\t}\r\n\r\n\thasSource()\r\n\t{\r\n\t\treturn typeof this.source === 'string';\r\n\t}\r\n\r\n\tgetSource()\r\n\t{\r\n\t\treturn this.source;\r\n\t}\r\n\r\n\tgetWeight()\r\n\t{\r\n\t\t// TODO: fetch from local storage\r\n\t\treturn this.weight;\r\n\t}\r\n\r\n\tgetSourceTableKey()\r\n\t{\r\n\t\tif (!this.hasSource()) return undefined;\r\n\t\tconst executor = parseMacro(this.source);\r\n\t\tif (executor.execFunc !== 'roll') return undefined;\r\n\t\treturn executor.args;\r\n\t}\r\n\r\n\tisMissingSourceTable(tableCollection, evaluateWithData)\r\n\t{\r\n\t\tif (!this.hasSource()) return false;\r\n\t\tconst tablePath = this.getSourceTableKey();\r\n\t\tif (!tablePath) return false;\r\n\t\treturn tableCollection.getTable(evaluateWithData(tablePath)) === undefined;\r\n\t}\r\n\r\n\thasRedirector()\r\n\t{\r\n\t\treturn typeof this.redirect === 'string';\r\n\t}\r\n\r\n\tgetRedirector()\r\n\t{\r\n\t\treturn this.redirect;\r\n\t}\r\n\r\n\thasChildren()\r\n\t{\r\n\t\treturn Object.keys(this.children).length > 0;\r\n\t}\r\n\r\n\tgetChildren() { return this.children; }\r\n\r\n\tgetStringifyTemplate()\r\n\t{\r\n\t\treturn this.stringify;\r\n\t}\r\n\r\n\tgetArticleContent()\r\n\t{\r\n\t\treturn this.articleContent;\r\n\t}\r\n\r\n\tgetDescription()\r\n\t{\r\n\t\treturn this.description;\r\n\t}\r\n\r\n\tgetCanReroll()\r\n\t{\r\n\t\treturn this.canReroll === undefined || this.canReroll === true;\r\n\t}\r\n\r\n\tisOptional()\r\n\t{\r\n\t\treturn this.bIsOptional;\r\n\t}\r\n\r\n}","import lodash from 'lodash';\r\nimport { accumulateEntries, Entry } from './Entry';\r\nimport { createExecutor } from '../generator/modules/createExecutor';\r\nimport appendModifiers from '../generator/appendModifiers';\r\nimport { inlineEval } from '../generator/modules/evalAtCtx';\r\n\r\n/**\r\n * Picks a random item from `entries`, using `entry.getWeight()` to get the weight for any\r\n * given item (assuming a weight of 1 if the function returns a falsey value).\r\n * Returns null if it was unable to determine a value. Assumes `entries` is non-empty.\r\n*/\r\nfunction chooseRandomWithWeight(entries)\r\n{\r\n\tconst totalWeight = entries.reduce((accum, row) => accum + (row.getWeight() || 1), 0);\r\n\tconst randInt = require('../lib/randInt')(1, totalWeight);\r\n\r\n\tvar weight_sum = 0;\r\n\tvar i;\r\n\tfor (i = 0; i < entries.length; i++)\r\n\t{\r\n\t\tweight_sum += entries[i].getWeight() || 1;\r\n\t\tif (randInt <= weight_sum)\r\n\t\t{\r\n\t\t\treturn entries[i];\r\n\t\t}\r\n\t}\r\n\r\n\tconsole.warn(`'Returning null from \\`chooseRandomWithWeight\\`. i=${i} weight_sum=${weight_sum}`, entries);\r\n\treturn null;\r\n}\r\n\r\n/**\r\n * A READONLY collective of randomizable entries with modifiers. It is loaded by a TableCollection,\r\n * and can be used to get a weighted random entry that it contains (see the `roll` function).\r\n*/\r\nexport default class Table\r\n{\r\n\r\n\tstatic EVENT_ONCHANGEDFILTER = 'onChangedFilter';\r\n\r\n\tstatic getTablePathFromKeyPath(keyPath)\r\n\t{\r\n\t\treturn keyPath.replace(/\\./g, '/');\r\n\t}\r\n\r\n\tstatic getKeyPathFromTablePath(tablePath)\r\n\t{\r\n\t\treturn tablePath.replace(/\\//g, '.');\r\n\t}\r\n\r\n\t// takes a json object\r\n\tstatic from(obj, key)\r\n\t{\r\n\t\tconst table = new Table();\r\n\t\ttable.key = key;\r\n\t\ttable.filter = obj.filter;\r\n\t\t// turn json data for a table's entry rows into objects\r\n\t\ttable.entriesWithoutKeys = [];\r\n\t\tif (obj.valueMacro)\r\n\t\t{\r\n\t\t\ttable.valueMacro = obj.valueMacro;\r\n\t\t\ttable.entries = null;\r\n\t\t}\r\n\t\telse if (obj.rows)\r\n\t\t{\r\n\t\t\ttable.entries = accumulateEntries(obj.rows, `table '${key}'`, (i) => table.entriesWithoutKeys.push(i));\r\n\t\t}\r\n\t\ttable.modifiers = obj.modifiers;\r\n\t\ttable.redirect = obj.redirect;\r\n\t\ttable.entry = obj.entry !== undefined ? Entry.from(obj.entry, -1) : undefined;\r\n\t\treturn table;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.events = new EventTarget();\r\n\r\n\t\tthis.key = undefined;\r\n\t\tthis.filter = undefined;\r\n\t\t// The macro used to generate a value based on the filter\r\n\t\tthis.valueMacro = undefined;\r\n\t\t// All the possible options available for randomization (and filtering)\r\n\t\tthis.entries = {};\r\n\t\t// Global modifiers that can (and should) be applied to any entry after being rolled.\r\n\t\tthis.modifiers = {};\r\n\r\n\t\tthis.redirect = undefined;\r\n\t}\r\n\r\n\tgetKey()\r\n\t{\r\n\t\treturn this.key;\r\n\t}\r\n\r\n\tgetKeyPath()\r\n\t{\r\n\t\treturn Table.getKeyPathFromTablePath(this.getKey());\r\n\t}\r\n\r\n\thasValueMacro()\r\n\t{\r\n\t\treturn this.valueMacro !== undefined;\r\n\t}\r\n\r\n\tlength()\r\n\t{\r\n\t\treturn this.entries !== null ? Object.keys(this.entries).length : 1;\r\n\t}\r\n\r\n\tgetRows()\r\n\t{\r\n\t\treturn this.entries !== null ? Object.values(this.entries) : [];\r\n\t}\r\n\r\n\taddRow(entry)\r\n\t{\r\n\t\tif (this.entries === null) { return; }\r\n\t\tthis.entries.push(entry);\r\n\t\tthis.dispatchOnChangedRowCount(this.entries.length - 1, this.entries.length);\r\n\t}\r\n\r\n\tremoveRow(entry)\r\n\t{\r\n\t\tif (this.entries === null) { return; }\r\n\t\tthis.entries.splice(this.entries.indexOf(entry), 1);\r\n\t\tthis.dispatchOnChangedRowCount(this.entries.length, this.entries.length - 1);\r\n\t}\r\n\r\n\tdispatchOnChangedRowCount(prev, next)\r\n\t{\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onChangedRowCount', {\r\n\t\t\tdetail: { prev, next }\r\n\t\t}));\r\n\t}\r\n\r\n\t// TODO: This will never work because Tables are deserialized from the local storage\r\n\tsubscribeOnChangedRowCount(callback)\r\n\t{\r\n\t\tconsole.error('Changed callbacks will never work on tables');\r\n\t\tthis.events.addEventListener('onChangedRowCount', callback);\r\n\t}\r\n\r\n\tunsubscribeOnChangedRowCount(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onChangedRowCount', callback);\r\n\t}\r\n\r\n\t// Viewing the table via react\r\n\r\n\tgetOptions()\r\n\t{\r\n\t\treturn this.getRows().map((entry) => ({\r\n\t\t\tkey: entry.getKey(), text: entry.getKey(), value: entry.getKey()\r\n\t\t}));\r\n\t}\r\n\r\n\thasFilter()\r\n\t{\r\n\t\treturn this.filter === undefined || this.filter !== false;\r\n\t}\r\n\r\n\tgetFilterType()\r\n\t{\r\n\t\treturn this.hasFilter() && this.filter !== undefined ? this.filter.type : undefined;\r\n\t}\r\n\r\n\tgetDefaultFilter()\r\n\t{\r\n\t\tswitch (this.getFilterType())\r\n\t\t{\r\n\t\t\tcase 'minMaxRange':\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmin: this.filter.min,\r\n\t\t\t\t\tmax: this.filter.max,\r\n\t\t\t\t};\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.getOptions();\r\n\t\t}\r\n\t}\r\n\r\n\thasGlobalModifiers()\r\n\t{\r\n\t\treturn this.modifiers !== null && this.modifiers !== undefined && Object.keys(this.modifiers).length > 0;\r\n\t}\r\n\r\n\tgetGlobalModifiers()\r\n\t{\r\n\t\treturn this.modifiers;\r\n\t}\r\n\r\n\thasRedirector()\r\n\t{\r\n\t\treturn this.redirect !== undefined;\r\n\t}\r\n\r\n\tgetRedirector()\r\n\t{\r\n\t\treturn this.redirect;\r\n\t}\r\n\r\n\t// Performing ops\r\n\r\n\troll(filter, context, ignore)\r\n\t{\r\n\t\tlet result = { value: undefined, modifiers: {} };\r\n\t\t\r\n\t\tif (this.entry !== undefined)\r\n\t\t{\r\n\t\t\tresult.value = lodash.cloneDeep(this.entry.value.value);\r\n\t\t\tresult.modifiers = lodash.cloneDeep(this.entry.value.modifiers);\r\n\t\t\tresult.entry = this.entry;\r\n\t\t}\r\n\t\telse if (this.hasValueMacro())\r\n\t\t{\r\n\t\t\tconst filterContext = { ...context, filter: (filter || this.getDefaultFilter()) };\r\n\t\t\tconst macro = createExecutor(this.valueMacro);\r\n\t\t\tif (macro === undefined) result.value = inlineEval(this.valueMacro, filterContext);\r\n\t\t\telse result.value = macro(filterContext).value;\r\n\t\t}\r\n\t\telse if (this.hasRedirector())\r\n\t\t{\r\n\t\t\tlet redirector = this.getRedirector();\r\n\r\n\t\t\tconst macro = createExecutor(`{roll:${redirector}}`);\r\n\t\t\tif (macro)\r\n\t\t\t{\r\n\t\t\t\tresult = macro({...context, filter: undefined});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tconst entry = (() => {\r\n\t\t\t\tconst rollable = this.getRows();\r\n\t\t\t\tif (context.preset !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\tconst preset = Array.isArray(context.preset) ? context.preset.shift() : context.preset;\r\n\t\t\t\t\tconst presetEntry = rollable.find((entry) => entry.getKey() === preset);\r\n\t\t\t\t\tif (presetEntry !== undefined) return presetEntry;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconsole.error(`Could not find entry with preset key ${preset} in table ${this.getKey()}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn chooseRandomWithWeight(\r\n\t\t\t\t\trollable.filter((entry) => (\r\n\t\t\t\t\t\t(filter === undefined || filter.includes(entry.getKey()))\r\n\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t(ignore === undefined || !ignore.includes(entry.getKey()))\r\n\t\t\t\t\t))\r\n\t\t\t\t);\r\n\t\t\t})();\r\n\t\t\tif (entry === null)\r\n\t\t\t{\r\n\t\t\t\tconsole.warn('Received null generated value. Maybe there are missing keys?', this.entriesWithoutKeys, this.getKeyPath());\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tresult.value = lodash.cloneDeep(entry.value);\r\n\t\t\tresult.modifiers = lodash.cloneDeep(entry.modifiers);\r\n\t\t\tresult.entry = entry;\r\n\t\t}\r\n\r\n\t\t// Modifiers which are determined based on scales or regexs on the generated value\r\n\t\tif (this.hasGlobalModifiers())\r\n\t\t{\r\n\t\t\tfor (let globalModifierEntry of this.getGlobalModifiers())\r\n\t\t\t{\r\n\t\t\t\tlet matched = globalModifierEntry.match === undefined;\r\n\t\t\t\tconst macro = globalModifierEntry.match !== undefined ? createExecutor(globalModifierEntry.match) : undefined;\r\n\t\t\t\tif (macro)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet matchResult = macro({ ...context, value: result.value });\r\n\t\t\t\t\tmatched = matchResult === true;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmatched = result.value === globalModifierEntry.match;\r\n\t\t\t\t}\r\n\t\t\t\tif (matched)\r\n\t\t\t\t{\r\n\t\t\t\t\tresult.modifiers = appendModifiers(result.modifiers, globalModifierEntry.modifiers);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tresult.modifiers = lodash.mapValues(result.modifiers, (modifierList, targetProperty) => {\r\n\t\t\tif (!Array.isArray(modifierList)) modifierList = [modifierList];\r\n\t\t\treturn modifierList.map((modifier) => {\r\n\t\t\t\t// Preprocess each modifier to ensure that the modifiers remaining are either numbers or strings\r\n\t\t\t\tif (typeof modifier === 'object')\r\n\t\t\t\t{\r\n\t\t\t\t\tswitch (modifier.type)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'curve':\r\n\t\t\t\t\t\t\tswitch (modifier.curve)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcase 'step':\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tconst keyframes = Object.keys(modifier.values);\r\n\t\t\t\t\t\t\t\t\t\tlet currentIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\tlet nextIndex = keyframes.length > 0 ? 0 : undefined;\r\n\t\t\t\t\t\t\t\t\t\twhile (nextIndex !== undefined\r\n\t\t\t\t\t\t\t\t\t\t\t&& parseInt(result.value, 10) > parseInt(keyframes[nextIndex], 10))\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tcurrentIndex = nextIndex;\r\n\t\t\t\t\t\t\t\t\t\t\tnextIndex++;\r\n\t\t\t\t\t\t\t\t\t\t\tif (nextIndex >= keyframes.length) nextIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn currentIndex ? modifier.values[keyframes[currentIndex]] : 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcase 'lerp':\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tconst valueInt = parseInt(result.value, 10);\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst keyframes = Object.keys(modifier.values);\r\n\t\t\t\t\t\t\t\t\t\tconst getInt = (i) => parseInt(keyframes[i], 10);\r\n\t\t\t\t\t\t\t\t\t\tlet lowerIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\tlet higherIndex = keyframes.length > 0 ? 0 : undefined;\r\n\t\t\t\t\t\t\t\t\t\twhile (higherIndex !== undefined\r\n\t\t\t\t\t\t\t\t\t\t\t&& valueInt > getInt(higherIndex))\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tlowerIndex = higherIndex;\r\n\t\t\t\t\t\t\t\t\t\t\thigherIndex++;\r\n\t\t\t\t\t\t\t\t\t\t\tif (higherIndex >= keyframes.length) higherIndex = undefined;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (lowerIndex === undefined)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tlowerIndex = higherIndex;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse if (higherIndex === undefined)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\thigherIndex = lowerIndex;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst lowerInput = getInt(lowerIndex);\r\n\t\t\t\t\t\t\t\t\t\tconst higherInput = getInt(higherIndex);\r\n\t\t\t\t\t\t\t\t\t\tconst lowerMod = modifier.values[keyframes[lowerIndex]];\r\n\t\t\t\t\t\t\t\t\t\tconst higherMod = modifier.values[keyframes[higherIndex]];\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst t = (valueInt - lowerInput) / (higherInput !== lowerInput ? higherInput - lowerInput : higherInput);\r\n\t\t\t\t\t\t\t\t\t\tconst lerped = (1 - t) * lowerMod + (t * higherMod);\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (modifier.toIntOp === undefined) return lerped;\r\n\t\t\t\t\t\t\t\t\t\tconst intOp = Math[modifier.toIntOp];\r\n\t\t\t\t\t\t\t\t\t\tif (intOp === undefined)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.warn('Encountered unimplemented curve int cast operator:', modifier.toIntOp);\r\n\t\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\treturn intOp(lerped);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdefault: break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: break;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn modifier;\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n}\r\n\r\nTable.COLUMNS = [\r\n\t{\r\n\t\taccessor: 'weight',\r\n\t\tHeader: 'Weight',\r\n\t},\r\n\t{\r\n\t\taccessor: 'key',\r\n\t\tHeader: 'Key',\r\n\t}\r\n];\r\n","import lodash from 'lodash';\r\n\r\nexport default function appendModifiers(current, toAppend) {\r\n\treturn lodash.toPairs(toAppend).reduce((accum, [key, modifier]) => {\r\n\t\t\r\n\t\tif (!accum.hasOwnProperty(key)) accum[key] = [];\r\n\t\telse if (!Array.isArray(accum[key])) accum[key] = [accum[key]];\r\n\t\t\r\n\t\tif (Array.isArray(modifier)) accum[key] = accum[key].concat(modifier);\r\n\t\telse accum[key].push(modifier);\r\n\r\n\t\treturn accum;\r\n\t}, current);\r\n};","import lodash from 'lodash';\r\nimport { Entry } from './Entry';\r\n\r\nclass Field extends Entry\r\n{\r\n\r\n\tstatic from(data)\r\n\t{\r\n\t\tconst entry = new Field();\r\n\t\tentry.readFrom(data);\r\n\t\tentry.category = data.category;\r\n\t\treturn entry;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tsuper();\r\n\t\tthis.category = undefined;\r\n\t}\r\n\r\n\tgetKeyPath()\r\n\t{\r\n\t\treturn `${this.category}.${this.getKey()}`;\r\n\t}\r\n\r\n\tgetCategory()\r\n\t{\r\n\t\treturn this.category;\r\n\t}\r\n\r\n}\r\n\r\nexport default class NpcSchema\r\n{\r\n\r\n\t// takes a json object\r\n\tstatic from(obj)\r\n\t{\r\n\t\tconst schema = new NpcSchema();\r\n\r\n\t\tschema.generationOrder = obj.generationOrder;\r\n\t\t\r\n\t\tfor (let fieldData of obj.fieldOrder)\r\n\t\t{\r\n\t\t\tconst field = schema.addField(fieldData);\r\n\t\t\tschema.fieldOrder.push(field.getKeyPath());\r\n\t\t}\r\n\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.fields = {};\r\n\t\tthis.fieldOrder = [];\r\n\t\tthis.generationOrder = [];\r\n\t\tthis.categories = {};\r\n\t}\r\n\r\n\taddField(data)\r\n\t{\r\n\t\tconst field = Field.from(data);\r\n\t\tthis.fields[field.getKeyPath()] = field;\r\n\t\tthis.categories[field.getCategory()] = (this.categories[field.getCategory()] || []).concat([field.getKey()]);\r\n\t\treturn field;\r\n\t}\r\n\r\n\tgetFields()\r\n\t{\r\n\t\treturn lodash.values(this.fields);\r\n\t}\r\n\r\n\tgetField(keyPath)\r\n\t{\r\n\t\treturn this.fields[keyPath];\r\n\t}\r\n\r\n\tgetCategories()\r\n\t{\r\n\t\treturn Object.keys(this.categories).sort();\r\n\t}\r\n\r\n\tgetFieldsForCategory(category)\r\n\t{\r\n\t\treturn (this.categories[category] || []).sort();\r\n\t}\r\n\r\n\tgetFieldForCategory(category, key)\r\n\t{\r\n\t\treturn this.categories[category][key];\r\n\t}\r\n\r\n\tgetGenerationOrder()\r\n\t{\r\n\t\treturn this.generationOrder;\r\n\t}\r\n\r\n}\r\n","import lodash from 'lodash';\r\nimport Table from './Table';\r\nimport NpcSchema from './NpcSchema';\r\n\r\nfunction loadItem(directory, fileName)\r\n{\r\n\tconst data = require(`../data/tables${directory}${fileName}.json`);\r\n\tconst isIndex = Array.isArray(data);\r\n\tlet content = !isIndex ? data : data.reduce((accum, itemPath) => loadTableEntry(accum, directory, itemPath), {});\r\n\treturn { content, isIndex };\r\n}\r\n\r\nfunction loadTableEntry(accumulator, directory, itemPath)\r\n{\r\n\tconst itemPathSplit = itemPath.split('/');\r\n\tconst fileName = itemPathSplit.slice(-1).join('/');\r\n\tconst immediateDirectory = itemPathSplit.slice(0, -1).join('/');\r\n\tconst fullDirectory = `${directory}${itemPath}`.split('/').slice(0, -1).join('/') + '/';\r\n\tconst item = loadItem(fullDirectory, fileName);\r\n\tif (item.isIndex)\r\n\t{\r\n\t\tlodash.assignIn(accumulator, lodash.mapKeys(item.content, (_, key) => `${immediateDirectory}/${key}`));\r\n\t}\r\n\telse\r\n\t{\r\n\t\taccumulator[itemPath] = item.content;\r\n\t}\r\n\treturn accumulator;\r\n}\r\n\r\nconst events = new EventTarget();\r\nlet TABLE_COLLECTION_CACHE = undefined;\r\n\r\n/**\r\n * A collection of Tables which is loaded once at application start (or on demand after initial load).\r\n * This data is meant to be READONLY at runtime and does not reliably support changing or adding data.\r\n*/\r\nexport default class TableCollection\r\n{\r\n\r\n\t/** Event key for when the table collection is finished loading - either at app launch or user initiated. */\r\n\tstatic EVENT_ONCHANGED = 'onChanged';\r\n\r\n\t/** Returns the current iteration/collection of tables loaded from data. */\r\n\tstatic get()\r\n\t{\r\n\t\treturn TABLE_COLLECTION_CACHE;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a new table collection object and loads collection from data.\r\n\t*/\r\n\tstatic initialize()\r\n\t{\r\n\t\tconsole.log('Initializing table collection');\r\n\t\tTABLE_COLLECTION_CACHE = new TableCollection();\r\n\t\tTABLE_COLLECTION_CACHE.loadTables();\r\n\t\tTableCollection.dispatchEvent(TableCollection.EVENT_ONCHANGED, null, TABLE_COLLECTION_CACHE);\r\n\t}\r\n\r\n\t/**\r\n\t * Wipes the table collection singleton and immediately reinitializes.\r\n\t*/\r\n\tstatic clear()\r\n\t{\r\n\t\tconst prev = TableCollection.get();\r\n\t\tTABLE_COLLECTION_CACHE = null;\r\n\t\tTableCollection.dispatchEvent(TableCollection.EVENT_ONCHANGED, prev, null);\r\n\r\n\t\t// Re-Initialize\r\n\t\tTableCollection.initialize();\r\n\t}\r\n\r\n\tstatic addEventListener(event, callback)\r\n\t{\r\n\t\tevents.addEventListener(event, callback);\r\n\t}\r\n\r\n\tstatic removeEventListener(event, callback)\r\n\t{\r\n\t\tevents.removeEventListener(event, callback);\r\n\t}\r\n\r\n\tstatic addOnChanged(callback)\r\n\t{\r\n\t\tTableCollection.addEventListener(TableCollection.EVENT_ONCHANGED, callback);\r\n\t}\r\n\r\n\tstatic removeOnChanged(callback)\r\n\t{\r\n\t\tTableCollection.removeEventListener(TableCollection.EVENT_ONCHANGED, callback);\r\n\t}\r\n\r\n\t// NOTE: `prev` is outdated\r\n\tstatic dispatchEvent(event, prev, next)\r\n\t{\r\n\t\tevents.dispatchEvent(new CustomEvent(event, {\r\n\t\t\tdetail: { prev, next }\r\n\t\t}));\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.tables = {};\r\n\t\tthis.npcSchema = undefined;\r\n\t}\r\n\r\n\tloadTables()\r\n\t{\r\n\t\tthis.tables = lodash.mapValues(loadItem('/', 'index').content, Table.from);\r\n\t\tconsole.log(this.tables);\r\n\t\tconsole.log('Missing Keys:', lodash.values(this.tables).reduce((accum, table) => {\r\n\t\t\tconst missingKeyDatum = {};\r\n\t\t\tif (table.entriesWithoutKeys.length > 0)\r\n\t\t\t{\r\n\t\t\t\tmissingKeyDatum.entries = table.entriesWithoutKeys;\r\n\t\t\t}\r\n\t\t\tfor (let entry of lodash.values(table.entries))\r\n\t\t\t{\r\n\t\t\t\tif (entry.childrenWithoutKeys.length > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tmissingKeyDatum[entry.getKey()] = entry.childrenWithoutKeys;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (Object.keys(missingKeyDatum).length > 0)\r\n\t\t\t{\r\n\t\t\t\taccum[table.getKey()] = missingKeyDatum;\r\n\t\t\t}\r\n\t\t\treturn accum;\r\n\t\t}, {}))\r\n\r\n\t\tthis.npcSchema = NpcSchema.from(loadItem('/', 'npc').content);\r\n\t}\r\n\r\n\tgetNpcSchema()\r\n\t{\r\n\t\treturn this.npcSchema;\r\n\t}\r\n\r\n\tgetTableKeys()\r\n\t{\r\n\t\treturn Object.keys(this.tables).sort();\r\n\t}\r\n\r\n\tgetTables()\r\n\t{\r\n\t\treturn Object.values(this.tables);\r\n\t}\r\n\r\n\tgetTable(key)\r\n\t{\r\n\t\treturn this.tables.hasOwnProperty(key) ? this.tables[key] : undefined\r\n\t}\r\n\r\n\tgetTableAtPath(keyPath)\r\n\t{\r\n\t\treturn this.getTable(Table.getTablePathFromKeyPath(keyPath));\r\n\t}\r\n\r\n\tgetTableTree()\r\n\t{\r\n\t\treturn this.getTableKeys().reduce((accum, key) => {\r\n\t\t\treturn lodash.set(accum, this.tables[key].getKeyPath() + '.table', this.tables[key]);\r\n\t\t}, {});\r\n\t}\r\n\r\n}","export function camelCaseToTitle(str)\r\n{\r\n\treturn str\r\n\t\t.split(/(?=[A-Z])/)\r\n\t\t.map(\r\n\t\t\t(word) => `${word[0].toUpperCase()}${word.substr(1).toLowerCase()}`\r\n\t\t).join(' ');\r\n}","import React, { useState } from 'react';\r\nimport storage from 'local-storage';\r\nimport lodash from 'lodash';\r\nimport { Accordion } from 'semantic-ui-react';\r\n\r\nexport function StorageAccordion({\r\n\tstorageKey,\r\n\tentryComponentType,\r\n\tentries,\r\n\tactive, // if the item the accordion is in is currently rendering (not collapsed)\r\n})\r\n{\r\n\tconst [expandedEntryKeys, setExpandedEntryKeys_state] = useState(storage.get(storageKey) || []);\r\n\tfunction setExpandedEntryKeys(keys)\r\n\t{\r\n\t\tif (keys.length > 0) storage.set(storageKey, keys);\r\n\t\telse storage.remove(storageKey);\r\n\t\tsetExpandedEntryKeys_state(keys);\r\n\t}\r\n\tfunction addExpandedEntryKey(key) { setExpandedEntryKeys((storage.get(storageKey) || []).concat([key])); }\r\n\tfunction removeExpandedEntryKey(key) { setExpandedEntryKeys((storage.get(storageKey) || []).filter((item) => item !== key)); }\r\n\tfunction isEntryExpanded(key) { return expandedEntryKeys.includes(key); }\r\n\r\n\tconst handleAccordionClick = (_, { index }) =>\r\n\t{\r\n\t\tif (!isEntryExpanded(index)) addExpandedEntryKey(index);\r\n\t\telse removeExpandedEntryKey(index);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Accordion style={{ margin: 0 }}>\r\n\t\t\t{lodash.toPairs(entries).map(([entryKey, entryProps]) => (\r\n\t\t\t\tReact.createElement(entryProps.storageAccordianComponent || entryComponentType, {\r\n\t\t\t\t\t...entryProps,\r\n\t\t\t\t\tkey: entryKey,\r\n\t\t\t\t\tactive: isEntryExpanded(entryKey) && (active === undefined || active === true),\r\n\t\t\t\t\tonClick: handleAccordionClick,\r\n\t\t\t\t\tforceCollapse: removeExpandedEntryKey,\r\n\t\t\t\t})\r\n\t\t\t))}\r\n\t\t</Accordion>\r\n\t);\r\n}\r\n","\r\nexport const DISPLAY_MODES = {\r\n\tReadable: 'Readable',\r\n\tDetailed: 'Detailed',\r\n};\r\n\r\nexport function getDisplayIconForMode(displayMode)\r\n{\r\n\tswitch (displayMode)\r\n\t{\r\n\t\tcase DISPLAY_MODES.Readable: return 'eye';\r\n\t\tcase DISPLAY_MODES.Detailed: return 'archive';\r\n\t\tdefault: return 'question';\r\n\t}\r\n}\r\n\r\nexport function getNextDisplayMode(displayMode)\r\n{\r\n\tswitch (displayMode)\r\n\t{\r\n\t\tcase DISPLAY_MODES.Readable: return DISPLAY_MODES.Detailed;\r\n\t\tcase DISPLAY_MODES.Detailed: return DISPLAY_MODES.Readable;\r\n\t\tdefault: return DISPLAY_MODES.Detailed;\r\n\t}\r\n}\r\n\r\nexport function getDisplayModeSwitchLabel(displayMode)\r\n{\r\n\treturn `Switch to ${getNextDisplayMode(displayMode).toLowerCase()} mode`;\r\n}\r\n","import storage from 'local-storage';\r\n\r\nexport default class Filter\r\n{\r\n\r\n\tstatic all()\r\n\t{\r\n\t\treturn (storage.get('filters') || {});\r\n\t}\r\n\r\n\tstatic get(key)\r\n\t{\r\n\t\treturn Filter.all()[key];\r\n\t}\r\n\r\n\tstatic set(key, filter)\r\n\t{\r\n\t\tconst allFilters = Filter.all();\r\n\t\tallFilters[key] = filter;\r\n\t\tstorage.set('filters', allFilters);\r\n\t}\r\n\r\n\tstatic remove(key)\r\n\t{\r\n\t\tconst allFilters = Filter.all();\r\n\t\tdelete allFilters[key];\r\n\t\tstorage.set('filters', allFilters);\r\n\t}\r\n\r\n\tstatic clear()\r\n\t{\r\n\t\tstorage.set('filters', {});\r\n\t}\r\n\r\n}","import React, { useState } from 'react';\r\nimport { Dropdown } from 'semantic-ui-react';\r\nimport Filter from '../storage/Filter';\r\nimport InputRange from 'react-input-range';\r\nimport 'react-input-range/lib/css/index.css';\r\n\r\n// For ranges: https://github.com/davidchin/react-input-range\r\nexport function TableFilter({\r\n\ttableCollection, tableKey, storageKey\r\n})\r\n{\r\n\r\n\tfunction getTable()\r\n\t{\r\n\t\treturn tableCollection ? tableCollection.getTable(tableKey) : undefined;\r\n\t}\r\n\r\n\tconst [value, setValue] = useState(Filter.get(storageKey) || undefined);\r\n\r\n\tconst table = getTable();\r\n\tif (!table) return <div />;\r\n\r\n\tfunction isValueAValidFilter(value)\r\n\t{\r\n\t\tswitch (table.getFilterType())\r\n\t\t{\r\n\t\t\tcase 'minMaxRange':\r\n\t\t\t\treturn typeof value === 'object' && value.min && value.max;\r\n\t\t\tdefault:\r\n\t\t\t\treturn Array.isArray(value) && value.length > 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onDropdownChanged(value)\r\n\t{\r\n\t\tif (isValueAValidFilter(value))\r\n\t\t{\r\n\t\t\tFilter.set(storageKey, value);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tFilter.remove(storageKey);\r\n\t\t}\r\n\t\tsetValue(value);\r\n\t}\r\n\r\n\tswitch (table.getFilterType())\r\n\t{\r\n\t\tcase 'minMaxRange':\r\n\t\t\tconst defaultFilter = table.getDefaultFilter();\r\n\t\t\treturn (\r\n\t\t\t\t<div style={{marginTop: '15px', marginBottom: '15px'}}>\r\n\t\t\t\t\t<InputRange\r\n\t\t\t\t\t\tminValue={defaultFilter.min}\r\n\t\t\t\t\t\tmaxValue={defaultFilter.max}\r\n\t\t\t\t\t\tvalue={value || defaultFilter}\r\n\t\t\t\t\t\tonChange={onDropdownChanged}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\tdefault:\r\n\t\t\treturn (\r\n\t\t\t\t<Dropdown\r\n\t\t\t\t\tfluid search selection multiple\r\n\t\t\t\t\tplaceholder={'No filter'}\r\n\t\t\t\t\toptions={table ? table.getDefaultFilter() : []}\r\n\t\t\t\t\tvalue={value || []}\r\n\t\t\t\t\tonChange={(_, { value }) => onDropdownChanged(value)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t}\r\n}\r\n","import Filter from './Filter';\r\nimport lodash from 'lodash';\r\nimport { createExecutor } from '../generator/modules/createExecutor';\r\nimport { inlineEval, PURE_VARIABLE_REGEX } from '../generator/modules/evalAtCtx';\r\nimport NpcData from './NpcData';\r\nimport storage from 'local-storage';\r\n\r\nfunction objectEqualityDeepRecursive(a, b) {\r\n\tfor(const key in a) {\r\n\t\t\tif(!(key in b) || !objectEqualityDeepRecursive(a[key], b[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t}\r\n\tfor(var key in b) {\r\n\t\t\tif(!(key in a) || !objectEqualityDeepRecursive(a[key], b[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nclass EntryLinker\r\n{\r\n\r\n\tconstructor(owner, property, onEvent)\r\n\t{\r\n\t\tthis.owner = owner;\r\n\t\tthis.property = property;\r\n\t\t// entry keys that our owner has subscribed to\r\n\t\tthis.subscribingTo = [];\r\n\t\t// entry keys that have subscribed to our owner\r\n\t\tthis.subscribed = [];\r\n\t\tthis.onEvent = onEvent;\r\n\t}\r\n\r\n\tgetEntryForPath(entryPath)\r\n\t{\r\n\t\treturn this.owner.npc.getEntry(entryPath);\r\n\t}\r\n\r\n\tsubscribe(entryPaths)\r\n\t{\r\n\t\tthis.subscribingTo = lodash.uniq(entryPaths);\r\n\t\tentryPaths.forEach((path) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(path);\r\n\t\t\tif (entry) entry[this.property].add(this.owner);\r\n\t\t});\r\n\t}\r\n\r\n\tunsubscribe(entryPaths)\r\n\t{\r\n\t\tthis.subscribingTo = this.subscribingTo.filter((key) => !entryPaths.includes(key));\r\n\t\tentryPaths.forEach((path) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(path);\r\n\t\t\tif (entry) entry[this.property].remove(this.owner);\r\n\t\t});\r\n\t}\r\n\r\n\tadd(entry)\r\n\t{\r\n\t\tthis.subscribed.push(entry.getKeyPath());\r\n\t\tthis.subscribed = lodash.uniq(this.subscribed);\r\n\t}\r\n\r\n\tremove(entry)\r\n\t{\r\n\t\tconst entryKey = entry.getKeyPath();\r\n\t\tthis.subscribed = this.subscribed.filter((key) => key !== entryKey);\r\n\t}\r\n\r\n\tgetSubscribedKeys()\r\n\t{\r\n\t\treturn this.subscribed;\r\n\t}\r\n\r\n\tdispatchToSubscriptions(evt, args, appendArgsForEntry=(a)=>a)\r\n\t{\r\n\t\tthis.subscribingTo.forEach((entryPath) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(entryPath);\r\n\t\t\tconst linker = entry ? entry[this.property] : undefined;\r\n\t\t\tconst onEvt = linker ? linker.onEvent : undefined;\r\n\t\t\tif (onEvt) onEvt(evt, appendArgsForEntry(args, entryPath));\r\n\t\t});\r\n\t}\r\n\r\n\tdispatchToSubscribers(evt, args)\r\n\t{\r\n\t\tthis.subscribed.forEach((entryPath) =>\r\n\t\t{\r\n\t\t\tconst entry = this.getEntryForPath(entryPath);\r\n\t\t\tconst linker = entry ? entry[this.property] : undefined;\r\n\t\t\tconst onEvt = linker ? linker.onEvent : undefined;\r\n\t\t\tif (onEvt) onEvt(evt, args);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default class GeneratedEntry\r\n{\r\n\r\n\tconstructor(npcData)\r\n\t{\r\n\t\tthis.npc = npcData;\r\n\r\n\t\tthis.events = new EventTarget();\r\n\t\tthis.schemaEntry = undefined;\r\n\r\n\t\tthis.stringifyLinker = new EntryLinker(this, 'stringifyLinker', this.onStringifyLinkerEvent.bind(this));\r\n\t\tthis.stringifyCached = undefined;\r\n\r\n\t\tthis.generationDependencyLinker = new EntryLinker(this, 'generationDependencyLinker', this.onGenerationDependencyEvent.bind(this));\r\n\t\tthis.modifyingLinker = new EntryLinker(this, 'modifyingLinker', this.onModifiersChanged.bind(this));\r\n\t\tthis.collectionLinker = new EntryLinker(this, 'collectionLinker', this.onCollectionEntriesChanged.bind(this));\r\n\t\t\r\n\t\tthis.modifierSources = {};\r\n\t\tthis.totalModifyingValue = 0;\r\n\t\tthis.forcedFilter = {};\r\n\t\tthis.postOperationModifiers = {};\r\n\r\n\t\tthis.category = undefined;\r\n\t\tthis.key = undefined;\r\n\r\n\t\tthis.generated = undefined;\r\n\t\tthis.generatedChildren = undefined;\r\n\t}\r\n\r\n\tisOptional()\r\n\t{\r\n\t\treturn this.schemaEntry.isOptional();\r\n\t}\r\n\r\n\tisUsable()\r\n\t{\r\n\t\treturn !this.isOptional() || (this.isEnabled() && this.areAllDependenciesUsable());\r\n\t}\r\n\r\n\tareAllDependenciesUsable()\r\n\t{\r\n\t\treturn (this.parent === undefined || this.parent.isUsable())\r\n\t\t\t&& this.getGenerationDependencies().reduce(\r\n\t\t\t\t(allDepsAreUsable, dependencyKeyPath) => allDepsAreUsable && this.npc.getEntry(dependencyKeyPath).isUsable(), true\r\n\t\t\t);\r\n\t}\r\n\r\n\tisEnabled()\r\n\t{\r\n\t\tif (!this.isOptional()) return true;\r\n\t\treturn !(storage.get('disabledEntries') || []).includes(this.getKeyPath());\r\n\t}\r\n\r\n\tsetIsEnabled(bIsEnabled)\r\n\t{\r\n\t\tlet enabledEntries = (storage.get('disabledEntries') || []);\r\n\r\n\t\tif (!bIsEnabled) enabledEntries.push(this.getKeyPath());\r\n\t\telse enabledEntries = enabledEntries.filter((keyPath) => keyPath !== this.getKeyPath());\r\n\r\n\t\tif (enabledEntries.length > 0) storage.set('disabledEntries', enabledEntries);\r\n\t\telse storage.remove('disabledEntries');\r\n\r\n\t\tthis.dispatchEnabledStateChanged();\r\n\t\tthis.generationDependencyLinker.dispatchToSubscribers('onEnabledChanged', {});\r\n\t}\r\n\r\n\taddListenerOnEnabledChanged(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onEnabledChanged', callback);\r\n\t}\r\n\r\n\tremoveListenerOnEnabledChanged(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onEnabledChanged', callback);\r\n\t}\r\n\r\n\tdispatchEnabledStateChanged()\r\n\t{\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onEnabledChanged', { detail: {} }));\r\n\t\tlodash.values(this.generatedChildren).forEach(\r\n\t\t\t(child) => child.events.dispatchEvent(new CustomEvent('onEnabledChanged', { detail: {} }))\r\n\t\t);\r\n\t}\r\n\r\n\treadEntry(entry)\r\n\t{\r\n\t\tthis.schemaEntry = entry;\r\n\t\tthis.key = entry.getKey();\r\n\t}\r\n\r\n\tgetKey()\r\n\t{\r\n\t\treturn this.key;\r\n\t}\r\n\r\n\tgetKeyPath()\r\n\t{\r\n\t\tif (this.key === undefined) return undefined;\r\n\t\telse if (this.category !== undefined) return `${this.category}.${this.key}`;\r\n\t\telse if (this.parent !== undefined) return `${this.parent.getKeyPath()}.${this.key}`;\r\n\t\telse return this.key;\r\n\t}\r\n\r\n\tgetName()\r\n\t{\r\n\t\tconst field = this.getField();\r\n\t\tif (field.name !== undefined) return field.name;\r\n\t\tconst path = lodash.toPath(this.getKeyPath());\r\n\t\treturn path[path.length - 1]\r\n\t\t\t.split(/(?=[A-Z])/)\r\n\t\t\t.map(\r\n\t\t\t\t(word) => `${word[0].toUpperCase()}${word.substr(1).toLowerCase()}`\r\n\t\t\t).join(' ');\r\n\t}\r\n\r\n\tgetField()\r\n\t{\r\n\t\treturn this.schemaEntry;\r\n\t}\r\n\r\n\tgetGenerationMacro()\r\n\t{\r\n\t\tconst field = this.getField();\r\n\t\tif (!field.hasSource()) return undefined;\r\n\t\tconst macro = createExecutor(field.getSource());\r\n\t\tif (macro === undefined)\r\n\t\t{\r\n\t\t\tconsole.warn('Failed to find a valid exec source functor for field:', field);\r\n\t\t}\r\n\t\treturn macro;\r\n\t}\r\n\r\n\thasFilter(tableCollection, globalData)\r\n\t{\r\n\t\tconst sourceTableKey = this.getField().getSourceTableKey(tableCollection);\r\n\t\tconst table = sourceTableKey !== undefined ? tableCollection.getTable(inlineEval(sourceTableKey, globalData)) : undefined;\r\n\t\treturn table ? table.hasFilter() : false;\r\n\t}\r\n\r\n\tgetFilterValue()\r\n\t{\r\n\t\tconst forcedFilter = Object.values(this.forcedFilter);\r\n\t\treturn forcedFilter.length > 0 ? forcedFilter : Filter.get(this.getKeyPath());\r\n\t}\r\n\r\n\tgetCanReroll()\r\n\t{\r\n\t\treturn this.schemaEntry.getCanReroll() && (!this.parent || this.parent.getCanReroll());\r\n\t}\r\n\r\n\tclearLinking()\r\n\t{\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('remove', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\t\tthis.modifyingLinker.unsubscribe(this.getModifyingEntryKeys());\r\n\t\tthis.generationDependencyLinker.unsubscribe(this.getGenerationDependencies());\r\n\t\tthis.stringifyLinker.unsubscribe(this.getStringifyDependencies());\r\n\t\t\r\n\t\tthis.collectionLinker.dispatchToSubscriptions('remove', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t});\r\n\t\tthis.collectionLinker.unsubscribe(this.getOurCollections());\r\n\t}\r\n\r\n\tdispose()\r\n\t{\r\n\t\tthis.clearLinking();\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onDispose', { detail: { entry: this } }));\r\n\t}\r\n\r\n\tregenerate(globalData, getPreset)\r\n\t{\r\n\t\tthis.clearSaveState();\r\n\r\n\t\tif (this.generatedChildren)\r\n\t\t{\r\n\t\t\tlodash.values(this.generatedChildren).forEach((child) => child.dispose());\r\n\t\t}\r\n\t\tthis.clearLinking();\r\n\r\n\t\tconst presetData = typeof getPreset === 'function' ? getPreset(this) : undefined;\r\n\r\n\t\tlet prevValueOrKey = undefined;\r\n\t\tif (this.generated !== undefined)\r\n\t\t{\r\n\t\t\tprevValueOrKey = this.generated.value;\r\n\t\t\tif (this.generated.entry !== undefined && this.generated.entry.hasKey())\r\n\t\t\t{\r\n\t\t\t\tprevValueOrKey = this.generated.entry.getKey();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst filter = this.getFilterValue();\r\n\t\tif (filter !== undefined && filter.length === 1 && filter.includes(prevValueOrKey))\r\n\t\t{\r\n\t\t\tprevValueOrKey = undefined;\r\n\t\t}\r\n\r\n\t\tconst context = {\r\n\t\t\t...globalData,\r\n\t\t\tfilter: filter,\r\n\t\t\tignore: prevValueOrKey !== undefined ? [prevValueOrKey] : undefined,\r\n\t\t\tpreset: presetData,\r\n\t\t};\r\n\t\tthis.generated = null;\r\n\r\n\t\tif (this.schemaEntry.value)\r\n\t\t{\r\n\t\t\tthis.generated = {\r\n\t\t\t\tvalue: presetData !== undefined ? presetData : this.schemaEntry.value\r\n\t\t\t};\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tlet redirectPath = [];\r\n\t\t\tdo\r\n\t\t\t{\r\n\t\t\t\tlet macro = undefined;\r\n\t\t\t\t// grab the redirector from the previous generated entry\r\n\t\t\t\tlet redirector = this.generated && this.generated.entry && this.generated.entry.hasRedirector() ? this.generated.entry.getRedirector() : undefined;\r\n\t\t\t\tif (redirector !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\tmacro = createExecutor(`{roll:${redirector}}`);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmacro = this.getGenerationMacro();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (macro === undefined) break;\r\n\t\t\t\t\r\n\t\t\t\tthis.generated = macro(redirector === undefined ? context : {...context, filter: undefined});\r\n\t\t\t\tif (this.generated && this.generated.entry && this.generated.entry.hasRedirector())\r\n\t\t\t\t{\r\n\t\t\t\t\tredirectPath.push(this.generated.entry.getKey());\r\n\t\t\t\t}\r\n\t\t\t} while (this.generated && this.generated.entry && this.generated.entry.hasRedirector());\r\n\t\t\tif (this.generated && redirectPath.length > 0)\r\n\t\t\t{\r\n\t\t\t\tthis.generated.redirectPath = redirectPath;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.generatedChildren = this.generated && this.generated.entry && this.generated.entry.hasChildren()\r\n\t\t\t? lodash.mapValues(this.generated.entry.getChildren(), (child) =>\r\n\t\t\t{\r\n\t\t\t\tconst clone = new GeneratedEntry(this.npc);\r\n\t\t\t\tclone.readEntry(child);\r\n\t\t\t\tclone.parent = this;\r\n\t\t\t\treturn clone;\r\n\t\t\t}) : undefined;\r\n\t\tif (this.generatedChildren === undefined && this.schemaEntry && this.schemaEntry.hasChildren())\r\n\t\t{\r\n\t\t\tthis.generatedChildren = lodash.mapValues(this.schemaEntry.getChildren(), (child) =>\r\n\t\t\t{\r\n\t\t\t\tconst clone = new GeneratedEntry(this.npc);\r\n\t\t\t\tclone.readEntry(child);\r\n\t\t\t\tclone.parent = this;\r\n\t\t\t\treturn clone;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.updateString(globalData);\r\n\t\tthis.stringifyLinker.subscribe(this.getStringifyDependencies());\r\n\r\n\t\t// temporarily modify globalData until it can be accounted for later\r\n\t\t// we should probably just mark the data as dirty here instead of passing it through functions\r\n\t\tthis.getModifiedData(globalData);\r\n\t\tthis.writeSaveState();\r\n\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onChanged', { detail: {} }));\r\n\r\n\t\tthis.collectionLinker.subscribe(this.getOurCollections());\r\n\t\tthis.collectionLinker.dispatchToSubscriptions('add', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t});\r\n\r\n\t\tthis.stringifyLinker.dispatchToSubscribers('onChanged', { globalData });\r\n\r\n\t\tthis.generationDependencyLinker.subscribe(this.getGenerationDependencies());\r\n\t\tthis.generationDependencyLinker.dispatchToSubscribers('onChanged', { key: this.getKeyPath(), globalData });\r\n\r\n\t\tthis.modifyingLinker.subscribe(this.getModifyingEntryKeys());\r\n\r\n\t\tthis.regenerateChildren(globalData, getPreset);\r\n\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('add', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\r\n\t\tif (this.parent) this.parent.onChildGenerated(this);\r\n\t}\r\n\r\n\tregenerateChildren(globalData, getPreset=undefined)\r\n\t{\r\n\t\tif (this.generatedChildren)\r\n\t\t{\r\n\t\t\tlodash.values(this.generatedChildren).forEach((child) => child.regenerate(globalData, getPreset));\r\n\t\t}\r\n\t}\r\n\r\n\tonChildGenerated(child)\r\n\t{\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('remove', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onChanged', { detail: {} }));\r\n\t\tthis.modifyingLinker.dispatchToSubscriptions('add', {\r\n\t\t\tsource: this.getKeyPath()\r\n\t\t}, (args, keyPath) => ({...args, value: this.getModifierFor(keyPath)}));\r\n\t}\r\n\r\n\tgetGeneratedEntry()\r\n\t{\r\n\t\treturn this.generated ? this.generated.entry : undefined;\r\n\t}\r\n\r\n\tgetModifiedData(values)\r\n\t{\r\n\t\tconst localValue = this.getModifiedValue();\r\n\t\tlodash.set(values, this.getKeyPath(), lodash.assignIn(\r\n\t\t\ttypeof localValue === 'object' ? localValue : {},\r\n\t\t\t{\r\n\t\t\t\ttoString: () => typeof localValue === 'object' ? undefined : `${localValue}`,\r\n\t\t\t\tasString: this.toString(),\r\n\t\t\t}\r\n\t\t));\r\n\t\tif (this.hasChildren())\r\n\t\t{\r\n\t\t\tlodash.values(this.getChildren()).forEach(\r\n\t\t\t\t(child) => child.getModifiedData(values)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tgetChildModifiedData(values)\r\n\t{\r\n\t\tconst tmpValues = {};\r\n\t\tlodash.values(this.getChildren()).forEach(\r\n\t\t\t(child) => child.getModifiedData(tmpValues)\r\n\t\t);\r\n\t\tlodash.assign(values, lodash.get(tmpValues, this.getKeyPath()));\r\n\t}\r\n\r\n\taddListenerOnChanged(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onChanged', callback);\r\n\t}\r\n\r\n\tremoveListenerOnChanged(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onChanged', callback);\r\n\t}\r\n\r\n\taddListenerOnDispose(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onDispose', callback);\r\n\t}\r\n\r\n\tremoveListenerOnDispose(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onDispose', callback);\r\n\t}\r\n\r\n\t/**\r\n\t * If, when generated, the entry resulted in a tangible value (not just children and a stringify).\r\n\t**/\r\n\thasValue()\r\n\t{\r\n\t\tconst generated = this.generated || {};\r\n\t\treturn generated.value !== undefined;\r\n\t}\r\n\r\n\tgetRawValue()\r\n\t{\r\n\t\tconst generated = this.generated || {};\r\n\t\tconst generatedObjValue = generated.value !== undefined && generated.value.value !== undefined ? generated.value.value : generated.value;\r\n\t\tif (generatedObjValue !== undefined) return generatedObjValue;\r\n\t\treturn generated.entry !== undefined ? generated.entry.getKey() : undefined;\r\n\t}\r\n\r\n\tgetModifyingEntryData_internal()\r\n\t{\r\n\t\treturn (this.generated ? this.generated.modifiers : undefined) || {};\r\n\t}\r\n\r\n\tgetModifyingEntryData()\r\n\t{\r\n\t\treturn lodash.mapValues(this.getModifyingEntryData_internal(), (value, key) => this.getModifierFor(key));\r\n\t}\r\n\r\n\tgetModifierFor(keyPath)\r\n\t{\r\n\t\tconst getModifierInternal = (rawModifier) => {\r\n\t\t\tif (typeof rawModifier === 'object')\r\n\t\t\t{\r\n\t\t\t\tswitch (rawModifier.type)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 'multiply':\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst localData = {};\r\n\t\t\t\t\t\tthis.getChildModifiedData(localData);\r\n\t\t\t\t\t\tconst multiplier = inlineEval(rawModifier.value, localData);\r\n\t\t\t\t\t\tif (multiplier === undefined) return rawModifier;\r\n\t\t\t\t\t\tconst m = parseInt(multiplier, 10);\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: rawModifier.type,\r\n\t\t\t\t\t\t\tmultiply: m,\r\n\t\t\t\t\t\t\ttoString: () => `*${m}`,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcase 'multiplyAdd':\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst localData = {};\r\n\t\t\t\t\t\tthis.getChildModifiedData(localData);\r\n\t\t\t\t\t\tconst multiplier = inlineEval(rawModifier.multiply, localData);\r\n\t\t\t\t\t\tconst adder = inlineEval(rawModifier.add, localData);\r\n\t\t\t\t\t\tif (multiplier === undefined || adder === undefined) return rawModifier;\r\n\t\t\t\t\t\tconst m = parseInt(multiplier, 10);\r\n\t\t\t\t\t\tconst a = parseInt(adder, 10);\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: rawModifier.type,\r\n\t\t\t\t\t\t\tmultiply: m,\r\n\t\t\t\t\t\t\tadd: a,\r\n\t\t\t\t\t\t\ttoString: () => `*${m}+${a}`,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn rawModifier;\r\n\t\t};\r\n\r\n\t\tconst rawModifier = this.getModifyingEntryData_internal()[keyPath];\r\n\t\tif (Array.isArray(rawModifier)) return rawModifier.map(getModifierInternal);\r\n\t\telse return getModifierInternal(rawModifier);\r\n\t}\r\n\r\n\t/**\r\n\t * Get the key paths of entries this item is currently modifying.\r\n\t**/\r\n\tgetModifyingEntryKeys()\r\n\t{\r\n\t\treturn Object.keys(this.getModifyingEntryData());\r\n\t}\r\n\r\n\t/**\r\n\t * Get the key paths of entries this item is currently being modified by.\r\n\t**/\r\n\tgetModifiedByEntryKeys()\r\n\t{\r\n\t\treturn {\r\n\t\t\t...this.modifierSources,\r\n\t\t\t...this.postOperationModifiers,\r\n\t\t\t...this.forcedFilter,\r\n\t\t}\r\n\t}\r\n\r\n\taddListenerOnModified(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onModified', callback);\r\n\t}\r\n\r\n\tremoveListenerOnModified(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onModified', callback);\r\n\t}\r\n\r\n\t/**\r\n\t * Called when some entry adds or removes their modifiers from the total list of things this item is modified by.\r\n\t**/\r\n\tonModifiersChanged(evt, args)\r\n\t{\r\n\t\tconst forcedFilter = lodash.cloneDeep(this.forcedFilter);\r\n\t\tif (Array.isArray(args.value)) args.value.forEach((v) => this.applyModifier(evt, args.source, v));\r\n\t\telse this.applyModifier(evt, args.source, args.value);\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onModified', { detail: {} }));\r\n\r\n\t\tconst globalData = this.npc.getModifiedData();\r\n\t\t// TODO: This check is very inefficient, but it works...\r\n\t\tif (!objectEqualityDeepRecursive(forcedFilter, this.forcedFilter))\r\n\t\t{\r\n\t\t\tthis.regenerate(globalData);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.updateString(globalData);\r\n\t\t}\r\n\t}\r\n\r\n\tapplyModifier(evt, source, value)\r\n\t{\r\n\t\tswitch (evt)\r\n\t\t{\r\n\t\t\tcase 'add':\r\n\t\t\t\t// These are forced value filters, where the value argument is the key of the desired value\r\n\t\t\t\tif (typeof value === 'string')\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.forcedFilter[source] = value;\r\n\t\t\t\t}\r\n\t\t\t\t// A macro of sorts that is executed on compilation\r\n\t\t\t\telse if (typeof value === 'object')\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.postOperationModifiers[source] = value;\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof value !== 'number') throw new Error(`Cannot use a modifier that is not a number: ${value}`);\r\n\t\t\t\telse if (value !== 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modifierSources[source] = value;\r\n\t\t\t\t\tthis.totalModifyingValue += value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'remove':\r\n\t\t\t\t// These are forced value filters, where the value argument is the key of the desired value\r\n\t\t\t\tif (typeof value === 'string')\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.forcedFilter[source];\r\n\t\t\t\t}\r\n\t\t\t\t// A macro of sorts that is executed on compilation\r\n\t\t\t\telse if (typeof value === 'object')\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.postOperationModifiers[source];\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof value !== 'number') throw new Error(`Cannot use a modifier that is not a number: ${value}`);\r\n\t\t\t\telse if (value !== 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.modifierSources[source];\r\n\t\t\t\t\tthis.totalModifyingValue -= value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(`Unknown modifiers changed event ${evt}, ${source}: ${value}`);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tgetModifiedValue()\r\n\t{\r\n\t\tlet value = this.getRawValue();\r\n\t\tif (typeof value === 'number')\r\n\t\t{\r\n\t\t\tconst postOperations = Object.values(this.postOperationModifiers);\r\n\t\t\tif (postOperations.length > 0)\r\n\t\t\t{\r\n\t\t\t\tvalue = postOperations.reduce((retVal, modifier) => {\r\n\t\t\t\t\tswitch (modifier.type)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'multiplyAdd':\r\n\t\t\t\t\t\t\treturn retVal * modifier.multiply + modifier.add;\r\n\t\t\t\t\t\tcase 'multiply':\r\n\t\t\t\t\t\t\treturn retVal;// * modifier.multiply;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tthrow new Error('Cannot process modifier object', value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, value);\r\n\t\t\t}\r\n\t\t\tvalue = Math.max(value + this.totalModifyingValue, 0);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tgetStringifyTemplate()\r\n\t{\r\n\t\tconst genEntry = this.getGeneratedEntry();\r\n\t\treturn (genEntry ? genEntry.getStringifyTemplate() : undefined) || (this.schemaEntry.stringify);\r\n\t}\r\n\r\n\tgetDescription()\r\n\t{\r\n\t\tconst genEntry = this.getGeneratedEntry();\r\n\t\treturn (genEntry ? genEntry.getDescription() : undefined) || (this.schemaEntry.description);\r\n\t}\r\n\r\n\tgetStringifyDependencies()\r\n\t{\r\n\t\tconst template = this.getStringifyTemplate();\r\n\t\tif (!template) return [];\r\n\t\tconst allMatches = Array.from(template.matchAll(PURE_VARIABLE_REGEX));\r\n\t\tconst allNonlineageReplacements = allMatches.map((match) => match[1]).filter((key) => this.getChild(key) === undefined);\r\n\t\treturn allNonlineageReplacements;\r\n\t}\r\n\r\n\tupdateString(globalData)\r\n\t{\r\n\t\tconst localizedGlobalData = lodash.cloneDeep(globalData);\r\n\t\tthis.getChildModifiedData(localizedGlobalData);\r\n\r\n\t\tconst stringify = this.getStringifyTemplate();\r\n\t\tthis.stringifyCached = stringify ? inlineEval(stringify, localizedGlobalData) : `${this.getModifiedValue()}`;\r\n\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onUpdateString', {\r\n\t\t\tdetail: {\r\n\t\t\t\tstring: this.stringifyCached\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tif (this.parent) this.parent.updateString(globalData);\r\n\t}\r\n\r\n\taddListenerOnUpdateString(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onUpdateString', callback);\r\n\t}\r\n\r\n\tremoveListenerOnUpdateString(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onUpdateString', callback);\r\n\t}\r\n\r\n\tisValueEquivalentToNone()\r\n\t{\r\n\t\treturn this.toString() === 'none';\r\n\t}\r\n\r\n\ttoString()\r\n\t{\r\n\t\treturn this.stringifyCached;\r\n\t}\r\n\r\n\tgetArticleContent(globalData)\r\n\t{\r\n\t\tconst genEntry = this.getGeneratedEntry();\r\n\t\tconst articleContent = (genEntry ? genEntry.getArticleContent() : undefined) || (this.schemaEntry.articleContent);\r\n\t\tif (articleContent === undefined) { return this.toString(); }\r\n\r\n\t\tconst localizedGlobalData = lodash.cloneDeep(globalData);\r\n\t\tthis.getChildModifiedData(localizedGlobalData);\r\n\r\n\t\treturn inlineEval(articleContent, localizedGlobalData);\r\n\t}\r\n\r\n\tgetDescriptionString(globalData)\r\n\t{\r\n\t\tconst description = this.getDescription();\r\n\t\tif (description === undefined) { return undefined; }\r\n\t\t\r\n\t\tconst localizedGlobalData = lodash.cloneDeep(globalData);\r\n\t\tthis.getChildModifiedData(localizedGlobalData);\r\n\r\n\t\treturn inlineEval(description, localizedGlobalData);\r\n\t}\r\n\r\n\tonStringifyLinkerEvent(evt, { globalData })\r\n\t{\r\n\t\tconsole.assert(evt === 'onChanged');\r\n\t\tthis.updateString(globalData);\r\n\t}\r\n\r\n\tgetGenerationDependencies()\r\n\t{\r\n\t\tconst field = this.getField();\r\n\t\tconst source = field.hasSource() ? field.getSource() : undefined;\r\n\t\tif (!source) return [];\r\n\t\tconst deps = [];\r\n\t\tfor (let match of source.matchAll(PURE_VARIABLE_REGEX))\r\n\t\t\tdeps.push(match[1]);\r\n\t\treturn deps;\r\n\t}\r\n\r\n\taddListenerOnUpdateCollection(callback)\r\n\t{\r\n\t\tthis.events.addEventListener('onUpdateCollection', callback);\r\n\t}\r\n\r\n\tremoveListenerOnUpdateCollection(callback)\r\n\t{\r\n\t\tthis.events.removeEventListener('onUpdateCollection', callback);\r\n\t}\r\n\r\n\tonGenerationDependencyEvent(evt, { key, globalData })\r\n\t{\r\n\t\tswitch (evt)\r\n\t\t{\r\n\t\t\tcase 'onChanged':\r\n\t\t\t\tFilter.remove(this.getKeyPath());\r\n\t\t\t\tthis.regenerate(globalData);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'onEnabledChanged':\r\n\t\t\t\tthis.dispatchEnabledStateChanged();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.assert(false);\r\n\t\t}\r\n\t}\r\n\r\n\tgetOurCollections()\r\n\t{\r\n\t\treturn this.schemaEntry.collection !== undefined ? [this.schemaEntry.collection] : [];\r\n\t}\r\n\r\n\tgetCollectionEntryKeys()\r\n\t{\r\n\t\treturn this.collectionLinker.getSubscribedKeys();\r\n\t}\r\n\r\n\tonCollectionEntriesChanged(evt, {source})\r\n\t{\r\n\t\tthis.events.dispatchEvent(new CustomEvent('onUpdateCollection', {\r\n\t\t\tdetail: {\r\n\t\t\t\tentryKeys: this.getCollectionEntryKeys()\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\thasChildren()\r\n\t{\r\n\t\treturn this.generatedChildren && Object.keys(this.generatedChildren).length > 0;\r\n\t}\r\n\r\n\tgetChildren()\r\n\t{\r\n\t\treturn this.hasChildren() ? this.generatedChildren : {};\r\n\t}\r\n\r\n\tgetChild(subpath)\r\n\t{\r\n\t\tconst { items, remaining } = NpcData.sever(subpath);\r\n\t\tconst children = this.getChildren();\r\n\t\tif (children.hasOwnProperty(items[0]))\r\n\t\t{\r\n\t\t\tconst child = children[items[0]];\r\n\t\t\treturn remaining.length > 0 ? child.getChild(remaining) : child;\r\n\t\t}\r\n\t\telse if (lodash.has(this.getRawValue(), subpath)) return this;\r\n\t\telse\r\n\t\t{\r\n\t\t\t//console.warn(`Could not find entry with subpath ${subpath} under entry ${this.getKeyPath()}`);\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tgetSaveState()\r\n\t{\r\n\t\tconst generated = this.generated || {};\r\n\t\tif (generated.entry) return generated.entry.getKey();\r\n\t\telse if (typeof generated.value !== 'object') return generated.value;\r\n\t\telse return undefined;\r\n\t}\r\n\r\n\tclearSaveState()\r\n\t{\r\n\t\tthis.npc.updateSaveState(this.getKeyPath(), undefined);\r\n\t\tObject.values(this.getChildren()).forEach((child) => child.clearSaveState());\r\n\t}\r\n\r\n\twriteSaveState()\r\n\t{\r\n\t\tlet saveState = this.getSaveState();\r\n\t\tif (this.generated && Array.isArray(this.generated.redirectPath)) saveState = this.generated.redirectPath.concat([saveState]);\r\n\t\tthis.npc.updateSaveState(this.getKeyPath(), saveState);\r\n\t}\r\n\r\n}","import lodash from 'lodash';\r\nimport TableCollection from './TableCollection';\r\nimport GeneratedEntry from './GeneratedEntry';\r\nimport * as queryString from 'query-string';\r\n\r\nlet NPC_TEMPORARY_DATA = null;\r\n\r\nexport default class NpcData\r\n{\r\n\r\n\tstatic EVENTS = new EventTarget();\r\n\tstatic EVENT_INITIALIZED = 'onInitialized';\r\n\r\n\tstatic sever(fullKey, itemCount = 1)\r\n\t{\r\n\t\tconst path = lodash.toPath(fullKey);\r\n\t\treturn {\r\n\t\t\titems: path.slice(0, itemCount),\r\n\t\t\tremaining: path.slice(itemCount).join('.'),\r\n\t\t};\r\n\t}\r\n\r\n\tstatic toggleOnInitialized(status, callback)\r\n\t{\r\n\t\tswitch (status)\r\n\t\t{\r\n\t\t\tcase 'on':\r\n\t\t\t\tNpcData.EVENTS.addEventListener(NpcData.EVENT_INITIALIZED, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'off':\r\n\t\t\t\tNpcData.EVENTS.removeEventListener(NpcData.EVENT_INITIALIZED, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getSchema()\r\n\t{\r\n\t\tconst tableCollection = TableCollection.get();\r\n\t\treturn tableCollection ? tableCollection.getNpcSchema() : undefined;\r\n\t}\r\n\r\n\tstatic initialize(onInitialized)\r\n\t{\r\n\t\tconst schema = NpcData.getSchema();\r\n\t\tif (!schema) { return; }\r\n\t\t\r\n\t\tconsole.log('Initializing NPC data');\r\n\t\tconst data = new NpcData();\r\n\r\n\t\tconst fields = schema.getFields();\r\n\t\tfor (let field of fields)\r\n\t\t{\r\n\t\t\tdata.addEntry(field);\r\n\t\t}\r\n\r\n\t\tNPC_TEMPORARY_DATA = data;\r\n\r\n\t\tif (typeof onInitialized === 'function')\r\n\t\t{\r\n\t\t\tonInitialized(data);\r\n\t\t}\r\n\r\n\t\tNpcData.EVENTS.dispatchEvent(new CustomEvent(this.EVENT_INITIALIZED, {\r\n\t\t\tdetail: { npc: NPC_TEMPORARY_DATA }\r\n\t\t}));\r\n\t}\r\n\r\n\tsetState(state)\r\n\t{\r\n\t\tthis.saveState = state;\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tstatic get()\r\n\t{\r\n\t\treturn NPC_TEMPORARY_DATA;\r\n\t}\r\n\r\n\tstatic clear()\r\n\t{\r\n\t\twindow.sessionStorage.removeItem('npc');\r\n\t\tNpcData.initialize((npc) => npc.regenerateAll(NpcData.getState() || {}));\r\n\t}\r\n\r\n\tstatic getState()\r\n\t{\r\n\t\treturn JSON.parse(window.sessionStorage.getItem('npc'));\r\n\t}\r\n\r\n\tstatic getCurrentLinkData()\r\n\t{\r\n\t\tconst npcDataInUrl = queryString.parse(window.location.search);\r\n\t\tif (typeof npcDataInUrl.npc === 'string') \r\n\t\t{\r\n\t\t\treturn JSON.parse(npcDataInUrl.npc);\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tstatic getLink()\r\n\t{\r\n\t\tconst stateString = JSON.stringify(NpcData.getState());\r\n\t\tconst encoded = encodeURIComponent(stateString);\r\n\t\treturn `${window.location.href.slice(0, -1)}?npc=${encoded}`;\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.events = new EventTarget();\r\n\r\n\t\tthis.entries = {};\r\n\t\tthis.categories = {};\r\n\r\n\t\tthis.saveState = {};\r\n\t}\r\n\r\n\ttoggleListener(event, status, callback)\r\n\t{\r\n\t\tswitch (status)\r\n\t\t{\r\n\t\t\tcase 'on':\r\n\t\t\t\tthis.events.addEventListener(event, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'off':\r\n\t\t\t\tthis.events.removeEventListener(event, callback);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t}\r\n\r\n\taddEntry(field)\r\n\t{\r\n\t\tconst entry = new GeneratedEntry(this);\r\n\t\tentry.readEntry(field);\r\n\t\tentry.category = field.getCategory();\r\n\t\tthis.entries[entry.getKeyPath()] = entry;\r\n\t\tthis.categories[field.category] = (this.categories[field.getCategory()] || []).concat([field.getKey()]);\r\n\t}\r\n\r\n\tgetEntry(keyPath)\r\n\t{\r\n\t\tconst { items, remaining } = NpcData.sever(keyPath, 2);\r\n\t\tconst entry = this.entries[`${items[0]}.${items[1]}`];\r\n\t\treturn remaining.length > 0 && entry !== undefined ? entry.getChild(remaining) : entry;\r\n\t}\r\n\r\n\tgetCategories()\r\n\t{\r\n\t\treturn Object.keys(this.categories).sort();\r\n\t}\r\n\r\n\tgetEntriesForCategory(category)\r\n\t{\r\n\t\treturn (this.categories[category] || []).sort();\r\n\t}\r\n\r\n\tregenerateAll(presetData)\r\n\t{\r\n\t\tconst schema = NpcData.getSchema();\r\n\t\tconst globalData = {};\r\n\t\tfor (let entryKey of schema.getGenerationOrder())\r\n\t\t{\r\n\t\t\tconst entry = this.entries[entryKey];\r\n\t\t\tconst getPreset = (e) => presetData !== undefined ? lodash.cloneDeep(presetData[e.getKeyPath()]) : undefined;\r\n\t\t\tentry.regenerate(globalData, getPreset);\r\n\t\t\tentry.getModifiedData(globalData);\r\n\t\t}\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tforAllEntries(loop)\r\n\t{\r\n\t\tlodash.values(this.entries).forEach(loop);\r\n\t}\r\n\r\n\tgetModifiedData()\r\n\t{\r\n\t\tconst values = {}\r\n\t\tthis.forAllEntries((entry) => entry.getModifiedData(values));\r\n\t\treturn values;\r\n\t}\r\n\r\n\tupdateSaveState(key, state)\r\n\t{\r\n\t\tif (state === undefined) { delete this.saveState[key]; }\r\n\t\telse this.saveState[key] = state;\r\n\t}\r\n\r\n\tsave()\r\n\t{\r\n\t\twindow.sessionStorage.setItem('npc', JSON.stringify(this.saveState));\r\n\t}\r\n\r\n}","/*eslint no-unused-vars: [0, {\"args\": \"after-used\", \"argsIgnorePattern\": \"^_\"}]*/\r\n\r\nimport React, { useEffect } from 'react';\r\nimport { Accordion, Icon, Button, Menu, Form, Popup, Header, Checkbox } from 'semantic-ui-react';\r\nimport { TableFilter } from '../TableFilter';\r\nimport { StorageAccordion } from '../StorageAccordion';\r\nimport { camelCaseToTitle } from '../../lib/str';\r\nimport NpcData from '../../storage/NpcData';\r\nimport * as shortid from 'shortid';\r\nimport { inlineEval } from '../../generator/modules/evalAtCtx';\r\nimport lodash from 'lodash';\r\n\r\n/*\r\nfunction DataViewEntryCategory({\r\n\ttitleKey, description, children,\r\n\tactive, onClick\r\n})\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Accordion.Title\r\n\t\t\t\tindex={titleKey}\r\n\t\t\t\tactive={active}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t>\r\n\t\t\t\t{camelCaseToTitle(titleKey)} <Icon name='dropdown' />\r\n\t\t\t</Accordion.Title>\r\n\t\t\t<Accordion.Content active={active}>\r\n\t\t\t\t{description}\r\n\t\t\t\t{children}\r\n\t\t\t</Accordion.Content>\r\n\t\t</div>\r\n\t);\r\n}\r\n//*/\r\n\r\nfunction makeModifierPopup(title, popupTitle, itemMap)\r\n{\r\n\treturn (\r\n\t\t<Popup\r\n\t\t\ttrigger={<label>{title} ({Object.keys(itemMap).length})</label>}\r\n\t\t\tcontent={(\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Header as='h5'>{popupTitle}</Header>\r\n\t\t\t\t\t{Object.keys(itemMap).map((key) => (\r\n\t\t\t\t\t\t<div key={key}>\r\n\t\t\t\t\t\t\t{key}: {JSON.stringify(itemMap[key])}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nfunction EntryView({\r\n\ttableCollection, npcSchema, npc,\r\n\tpropertyKey, storageKey,\r\n\tentry, parentEntry,\r\n\tactive, onClick, forceCollapse, // from StorageAccordion\r\n})\r\n{\r\n\t// TODO: this is ineffecient, but it cant be passed in b/c passing through react copies objects, does not pass by ref.\r\n\t// maybe add functionality to cache data until it is marked as dirty.\r\n\tconst npcModifiedData = npc.getModifiedData();\r\n\tconst sourceTableKey = parentEntry.getSourceTableKey(tableCollection);\r\n\tconst isMissingSourceTable = parentEntry.isMissingSourceTable(tableCollection, (k) => inlineEval(k, npcModifiedData));\r\n\r\n\tconst refresh = React.useState(undefined)[1];\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tfunction onChanged({ detail }) { refresh(shortid.generate()); }\r\n\t\tfunction onDispose({ detail }) { forceCollapse(detail.entry.getKey()); }\r\n\t\tentry.addListenerOnChanged(onChanged);\r\n\t\tentry.addListenerOnUpdateString(onChanged);\r\n\t\tentry.addListenerOnModified(onChanged);\r\n\t\tentry.addListenerOnUpdateCollection(onChanged);\r\n\t\tentry.addListenerOnDispose(onDispose);\r\n\t\tentry.addListenerOnEnabledChanged(onChanged);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tentry.removeListenerOnChanged(onChanged)\r\n\t\t\tentry.removeListenerOnUpdateString(onChanged);\r\n\t\t\tentry.removeListenerOnModified(onChanged);\r\n\t\t\tentry.removeListenerOnUpdateCollection(onChanged);\r\n\t\t\tentry.removeListenerOnDispose(onDispose);\r\n\t\t\tentry.removeListenerOnEnabledChanged(onChanged);\r\n\t\t};\r\n\t});\r\n\r\n\tconst rawValue = entry.getRawValue();\r\n\tconst modifiedValue = entry.getModifiedValue();\r\n\tconst hasFilter = entry.hasFilter(tableCollection, npcModifiedData);\r\n\tconst modifiersFromEntry = entry.getModifyingEntryData();\r\n\tconst modifiersFromEntryCount = entry.getModifyingEntryKeys().length;\r\n\tconst hasModifiers = modifiersFromEntryCount > 0;\r\n\tconst modifiersOfEntry = entry.getModifiedByEntryKeys();\r\n\tconst isModified = Object.keys(modifiersOfEntry).length > 0;\r\n\tconst stringifyDeps = entry.getStringifyDependencies();\r\n\tconst stringifySubscribed = entry.stringifyLinker.getSubscribedKeys();\r\n\tconst generationDependencies = entry.getGenerationDependencies();\r\n\tconst generationDependedOnBy = entry.generationDependencyLinker.getSubscribedKeys();\r\n\tconst canRegenerate = entry.getCanReroll();\r\n\tconst collectionEntryKeys = entry.getCollectionEntryKeys();\r\n\tconst collectionEntryObj = collectionEntryKeys.reduce((accum, entryKey) =>\r\n\t{\r\n\t\tconst collectionEntry = npc.getEntry(entryKey);\r\n\t\tif (collectionEntry && !collectionEntry.isValueEquivalentToNone())\r\n\t\t\taccum[entryKey] = collectionEntry.toString();\r\n\t\treturn accum;\r\n\t}, {})\r\n\r\n\tif (active)\r\n\t{\r\n\t\t//console.log(entry, entry.isEnabled());\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Menu secondary style={{ marginBottom: 0 }}>\r\n\t\t\t\t<Menu.Item fitted>\r\n\t\t\t\t\t{entry.isOptional() && <Checkbox\r\n\t\t\t\t\t\ttoggle\r\n\t\t\t\t\t\tdisabled={!entry.areAllDependenciesUsable()}\r\n\t\t\t\t\t\tchecked={entry.isEnabled()}\r\n\t\t\t\t\t\tonChange={(_, {checked}) => entry.setIsEnabled(checked)}\r\n\t\t\t\t\t/>}\r\n\t\t\t\t\t<Accordion.Title\r\n\t\t\t\t\t\tindex={propertyKey}\r\n\t\t\t\t\t\tactive={!isMissingSourceTable && active && entry.isUsable()}\r\n\t\t\t\t\t\tonClick={(evt, { index }) => { if (entry.isUsable()) onClick(evt, { index })}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{!isMissingSourceTable && <Icon name='dropdown' />}\r\n\t\t\t\t\t\t{camelCaseToTitle(propertyKey)}\r\n\t\t\t\t\t\t{entry.isUsable() &&\r\n\t\t\t\t\t\t\t<span> - {entry.toString()} {isMissingSourceTable && (\r\n\t\t\t\t\t\t\t\t<span> - No generator available</span>\r\n\t\t\t\t\t\t\t)}</span>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Accordion.Title>\r\n\t\t\t\t</Menu.Item>\r\n\t\t\t\t{!isMissingSourceTable && canRegenerate && <Menu.Item fitted position='right'>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tstyle={{ margin: 2 }}\r\n\t\t\t\t\t\ticon={'refresh'}\r\n\t\t\t\t\t\tdisabled={!entry.isUsable()}\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tentry.regenerate(npcModifiedData);\r\n\t\t\t\t\t\t\tnpc.save();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tcontent={camelCaseToTitle(propertyKey)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tstyle={{ margin: 2 }}\r\n\t\t\t\t\t\ticon='refresh' content='Children'\r\n\t\t\t\t\t\tdisabled={!entry.isUsable()}\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tentry.regenerateChildren(npcModifiedData);\r\n\t\t\t\t\t\t\tnpc.save();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Menu.Item>}\r\n\t\t\t</Menu>\r\n\t\t\t{!isMissingSourceTable && active && entry.isUsable() && <Accordion.Content\r\n\t\t\t>\r\n\t\t\t\t<div style={{\r\n\t\t\t\t\tborderLeft: '2px solid rgba(34,36,38,.15)',\r\n\t\t\t\t\tpaddingLeft: '10px',\r\n\t\t\t\t\tmarginLeft: '7px',\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t<Form.Group widths={'equal'} style={hasFilter && !entry.hasValue() ? { margin: 0 } : {}}>\r\n\t\t\t\t\t\t\t{hasFilter && (\r\n\t\t\t\t\t\t\t\t<Form.Field\r\n\t\t\t\t\t\t\t\t\tlabel={'Filter'}\r\n\t\t\t\t\t\t\t\t\tcontrol={TableFilter}\r\n\t\t\t\t\t\t\t\t\ttableCollection={tableCollection}\r\n\t\t\t\t\t\t\t\t\ttableKey={sourceTableKey !== undefined ? inlineEval(sourceTableKey, npcModifiedData) : undefined}\r\n\t\t\t\t\t\t\t\t\tstorageKey={entry.getKeyPath()}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{entry.hasValue() && (typeof rawValue !== 'object') && <Form.Field>\r\n\t\t\t\t\t\t\t\t<label>Generated Value</label>\r\n\t\t\t\t\t\t\t\t{rawValue !== undefined ? rawValue : (\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: 'red' }}>Not Generated</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Form.Field>}\r\n\t\t\t\t\t\t\t{entry.hasValue() && (typeof modifiedValue !== 'object') && <Form.Field>\r\n\t\t\t\t\t\t\t\t<label>Value with Modifiers</label>\r\n\t\t\t\t\t\t\t\t{modifiedValue !== undefined ? modifiedValue : (\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: 'red' }}>Not Generated</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Form.Field>}\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t\t<Form.Group widths={'equal'} style={\r\n\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\thasModifiers\r\n\t\t\t\t\t\t\t\t|| isModified\r\n\t\t\t\t\t\t\t\t|| stringifyDeps.length > 0\r\n\t\t\t\t\t\t\t\t|| stringifySubscribed.length > 0\r\n\t\t\t\t\t\t\t\t|| generationDependencies.length > 0\r\n\t\t\t\t\t\t\t\t|| generationDependedOnBy.length > 0\r\n\t\t\t\t\t\t\t) ? { margin: 0 } : {}\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t{hasModifiers && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Modifies', 'Modifies Entries', modifiersFromEntry\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{isModified && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Modified By', 'Modified by Entries', modifiersOfEntry\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{stringifyDeps.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'String Dependencies', 'String Dependencies', stringifyDeps\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{stringifySubscribed.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'String Subscriptions', 'String Subscriptions', stringifySubscribed\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{generationDependencies.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Dependencies', 'Generation Dependencies', generationDependencies\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{generationDependedOnBy.length > 0 && <Form.Field>{makeModifierPopup(\r\n\t\t\t\t\t\t\t\t'Depended On By', 'Generations That Depend on entry', generationDependedOnBy\r\n\t\t\t\t\t\t\t)}</Form.Field>}\r\n\t\t\t\t\t\t\t{collectionEntryKeys.length > 0 && <Form.Field>\r\n\t\t\t\t\t\t\t\t{makeModifierPopup('Other Values', 'Collective Values', collectionEntryObj)}\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t{lodash.toPairs(collectionEntryObj).map(([entryKey, stringified]) => (\r\n\t\t\t\t\t\t\t\t\t\t<li key={entryKey}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Popup key={entryKey}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger={(<p>{stringified}</p>)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontent={(`Source: ${entryKey}`)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</Form.Field>}\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t\t{entry.hasChildren() && <StorageAccordion\r\n\t\t\t\t\t\tstorageKey={storageKey}\r\n\t\t\t\t\t\tentryComponentType={EntryView}\r\n\t\t\t\t\t\tentries={lodash.toPairs(entry.getChildren()).reduce((accum, [childKey, childEntry]) =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taccum[childKey] = {\r\n\t\t\t\t\t\t\t\ttableCollection: tableCollection,\r\n\t\t\t\t\t\t\t\tnpcSchema: npcSchema,\r\n\t\t\t\t\t\t\t\tnpc: npc,\r\n\t\t\t\t\t\t\t\tnpcModifiedData: npcModifiedData,\r\n\t\t\t\t\t\t\t\tpropertyKey: childKey,\r\n\t\t\t\t\t\t\t\tstorageKey: `${storageKey}.${childKey}`,\r\n\t\t\t\t\t\t\t\tentry: childEntry,\r\n\t\t\t\t\t\t\t\tparentEntry: childEntry.schemaEntry,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\treturn accum;\r\n\t\t\t\t\t\t}, {})}\r\n\t\t\t\t\t/>}\r\n\t\t\t\t</div>\r\n\t\t\t</Accordion.Content>}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport function DataViewEntry({\r\n\tpropertyKey, tableCollection, entryKey, storageKey,\r\n\tactive, onClick, forceCollapse,\r\n})\r\n{\r\n\tconst npcSchema = tableCollection ? tableCollection.getNpcSchema() : null;\r\n\tconst npc = NpcData.get();\r\n\tconst entry = npc.getEntry(entryKey);\r\n\r\n\tconst parentEntry = entry.getField();\r\n\r\n\treturn (\r\n\t\t<EntryView\r\n\t\t\ttableCollection={tableCollection} npcSchema={npcSchema} npc={npc}\r\n\r\n\t\t\tpropertyKey={propertyKey} storageKey={storageKey}\r\n\t\t\tentry={entry} parentEntry={parentEntry}\r\n\r\n\t\t\tactive={active} onClick={onClick} forceCollapse={forceCollapse}\r\n\t\t/>\r\n\t)\r\n}\r\n","import React from 'react';\r\nimport NpcData from '../../storage/NpcData';\r\nimport lodash from 'lodash';\r\nimport { Header, Button, List, Popup, Table } from 'semantic-ui-react';\r\nimport * as shortid from 'shortid';\r\nimport pluralize from '../../lib/pluralize';\r\n\r\nfunction toFeet(n)\r\n{\r\n\tconst realFeet = ((n * 0.393700) / 12);\r\n\tconst feet = Math.floor(realFeet);\r\n\tconst inches = Math.floor((realFeet - feet) * 12);\r\n\treturn feet + \"'\" + inches + '\"';\r\n}\r\n\r\nfunction toSentenceCase(sentence)\r\n{\r\n\treturn sentence.length <= 0 ? '' : (\r\n\t\tsentence[0].toUpperCase() + sentence.slice(1)\r\n\t);\r\n}\r\n\r\nfunction getRenderedText(text, entry, globalData)\r\n{\r\n\tif (typeof text === 'function')\r\n\t{\r\n\t\treturn text(entry);\r\n\t}\r\n\telse if (text !== undefined)\r\n\t{\r\n\t\treturn text;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn entry.getArticleContent(globalData);\r\n\t}\r\n}\r\n\r\nfunction InlineEntryComponent({ entry, getComponent })\r\n{\r\n\tconst refresh = React.useState(undefined)[1];\r\n\tReact.useEffect(() => {\r\n\t\tfunction onChanged(evt) { refresh(shortid.generate()); }\r\n\t\tentry.addListenerOnChanged(onChanged);\r\n\t\tentry.addListenerOnUpdateString(onChanged);\r\n\t\tentry.addListenerOnModified(onChanged);\r\n\t\tentry.addListenerOnUpdateCollection(onChanged);\r\n\t\tentry.addListenerOnEnabledChanged(onChanged);\r\n\t\treturn () => {\r\n\t\t\tentry.removeListenerOnChanged(onChanged)\r\n\t\t\tentry.removeListenerOnUpdateString(onChanged);\r\n\t\t\tentry.removeListenerOnModified(onChanged);\r\n\t\t\tentry.removeListenerOnUpdateCollection(onChanged);\r\n\t\t\tentry.removeListenerOnEnabledChanged(onChanged);\r\n\t\t};\r\n\t});\r\n\treturn getComponent(entry) || <span/>;\r\n}\r\n\r\nfunction InlineEntryItem({\r\n\tentry, rerollAs, globalData, text,\r\n})\r\n{\r\n\treturn (\r\n\t\t<InlineEntryComponent\r\n\t\t\tentry={entry}\r\n\t\t\tgetComponent={(e) => {\r\n\t\t\t\tconst renderedText = getRenderedText(text, e, globalData);\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\thoverable={true}\r\n\t\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t\t<span style={{ color: \"#4400ff\", fontWeight: 'bold' }}>{renderedText}</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\tcontent={(\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tpath={rerollAs || e.getKeyPath()} size='mini'\r\n\t\t\t\t\t\t\t\t\t\ticon='refresh'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\te.regenerate(globalData);\r\n\t\t\t\t\t\t\t\t\t\t\te.npc.save();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{e.getName()}\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t{renderedText}\r\n\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tpath={rerollAs || e.getKeyPath()} size='mini'\r\n\t\t\t\t\t\t\t\t\ticon='refresh' content='Children'\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\te.regenerateChildren(globalData);\r\n\t\t\t\t\t\t\t\t\t\te.npc.save();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport function ArticleContent({ usePlainText })\r\n{\r\n\tconst npc = NpcData.get();\r\n\tconst globalData = npc.getModifiedData();\r\n\r\n\tconst createEntryItem = (entry, text=undefined, rerollAs=undefined) =>\r\n\t{\r\n\t\tif (!entry) { return <div />; }\r\n\t\tif (usePlainText || !entry.getCanReroll())\r\n\t\t{\r\n\t\t\treturn getRenderedText(text, entry, globalData);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<InlineEntryItem\r\n\t\t\t\tentry={entry}\r\n\t\t\t\trerollAs={rerollAs}\r\n\t\t\t\tglobalData={globalData}\r\n\t\t\t\ttext={text}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\t\r\n\tconst strength = npc.getEntry('stats.abilityScores.strength');\r\n\tconst dexterity = npc.getEntry('stats.abilityScores.dexterity');\r\n\tconst constitution = npc.getEntry('stats.abilityScores.constitution');\r\n\tconst intelligence = npc.getEntry('stats.abilityScores.intelligence');\r\n\tconst wisdom = npc.getEntry('stats.abilityScores.wisdom');\r\n\tconst charisma = npc.getEntry('stats.abilityScores.charisma');\r\n\tconst ethicalPositive = npc.getEntry('stats.alignmentTendancies.ethical.positive');\r\n\tconst ethicalNeutral = npc.getEntry('stats.alignmentTendancies.ethical.neutral');\r\n\tconst ethicalNegative = npc.getEntry('stats.alignmentTendancies.ethical.negative');\r\n\tconst moralPositive = npc.getEntry('stats.alignmentTendancies.moral.positive');\r\n\tconst moralNeutral = npc.getEntry('stats.alignmentTendancies.moral.neutral');\r\n\tconst moralNegative = npc.getEntry('stats.alignmentTendancies.moral.negative');\r\n\r\n\tconst name = npc.getEntry('identity.name');\r\n\tconst surname = npc.getEntry('identity.surname');\r\n\tconst pronouns = npc.getEntry('identity.pronouns');\r\n\tconst genderIdentity = npc.getEntry('identity.genderIdentity');\r\n\tconst genderExpression = npc.getEntry('identity.genderExpression');\r\n\tconst sex = npc.getEntry('identity.sex');\r\n\tconst romanticIdentity = npc.getEntry('identity.romanticIdentity');\r\n\tconst sexualIdentity = npc.getEntry('identity.sexualIdentity');\r\n\tconst sexualOrientation = npc.getEntry('identity.sexualOrientation');\r\n\r\n\tconst profession = npc.getEntry('occupation.profession');\r\n\tconst occupationalArea = npc.getEntry('occupation.area');\r\n\r\n\tconst age = npc.getEntry('description.age');\r\n\tconst eyeColor = npc.getEntry('description.eyeColor');\r\n\tconst height = npc.getEntry('description.height');\r\n\tconst weight = npc.getEntry('description.weight');\r\n\tconst face = npc.getEntry('description.face');\r\n\tconst race = npc.getEntry('description.race');\r\n\tconst hair = npc.getEntry('description.race.hair');\r\n\tconst skin = npc.getEntry('description.race.skin');\r\n\tconst beard = npc.getEntry('description.race.beard');\r\n\r\n\tconst physicalTraitsMap = npc.getEntry('description.specialPhysical').getChildren();\r\n\tconst physicalTraits = lodash.values(physicalTraitsMap).map((entry) => (\r\n\t\t<List.Item key={entry.getKeyPath()} as='li'>\r\n\t\t\t{createEntryItem(entry, (e) => toSentenceCase(e.toString()))}\r\n\t\t</List.Item>\r\n\t));\r\n\r\n\tconst deity = npc.getEntry('personality.religion.deity');\r\n\tconst worship = npc.getEntry('personality.religion.worship');\r\n\tconst quirks = npc.getEntry('personality.quirks');\r\n\tconst quirkList = quirks.getCollectionEntryKeys()\r\n\t\t.map((entryKey) => npc.getEntry(entryKey))\r\n\t\t.filter((entry) => !entry.isValueEquivalentToNone())\r\n\t\t.map((entry) => (\r\n\t\t\t<List.Item key={entry.getKeyPath()} as='li'>\r\n\t\t\t\t{createEntryItem(entry, (e) => toSentenceCase(e.toString()))}\r\n\t\t\t</List.Item>\r\n\t\t));\r\n\r\n\tconst hooks = npc.getEntry('hooks.hook');\r\n\tconst relationshipStatus = npc.getEntry('relations.relationship');\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t{usePlainText && (\r\n\t\t\t\t<p>View generation at <a href={NpcData.getLink()}>D&amp;D-Generator</a></p>\r\n\t\t\t)}\r\n\r\n\t\t\t<Header as='h1' content='Description' />\r\n\t\t\t<List bulleted as='ul'>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{createEntryItem(name)}{surname.hasValue() && createEntryItem(surname, (e) => ` ${e.toString()}`)}\r\n\t\t\t\t\t&nbsp; is a &nbsp;\r\n\t\t\t\t\t{createEntryItem(age)} year old &nbsp;\r\n\t\t\t\t\t{createEntryItem(race)}\r\n\t\t\t\t\t{genderIdentity.isUsable() ? <span>&nbsp; {createEntryItem(genderIdentity)}.</span> : '.'}\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t{profession.isUsable() && <List.Item as='li'>\r\n\t\t\t\t\t<InlineEntryComponent entry={pronouns}\r\n\t\t\t\t\t\tgetComponent={(e) => (\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{toSentenceCase(e.getRawValue().singular)}\r\n\t\t\t\t\t\t\t\t&nbsp; {pluralize(e.getRawValue(), 'works', 'work')} as a &nbsp;\r\n\t\t\t\t\t\t\t\t{createEntryItem(profession)} ({createEntryItem(occupationalArea)}).\r\n\t\t\t\t\t\t\t\t<InlineEntryComponent entry={profession}\r\n\t\t\t\t\t\t\t\t\tgetComponent={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tconst desc = e.getDescriptionString(globalData);\r\n\t\t\t\t\t\t\t\t\t\tif (desc === undefined) return undefined;\r\n\t\t\t\t\t\t\t\t\t\treturn <span>&nbsp;({desc})</span>;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>}\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t<InlineEntryComponent entry={pronouns}\r\n\t\t\t\t\t\tgetComponent={(e) => (\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{toSentenceCase(e.getRawValue().singular)}\r\n\t\t\t\t\t\t\t\t&nbsp; {pluralize(e.getRawValue(), 'has', 'have')} &nbsp;\r\n\t\t\t\t\t\t\t\t{createEntryItem(eyeColor, (e) => `${e.toString()} eyes`)}\r\n\t\t\t\t\t\t\t\t{ beard === undefined\r\n\t\t\t\t\t\t\t\t\t? <span> and {createEntryItem(hair)}.</span>\r\n\t\t\t\t\t\t\t\t\t: <span>, {createEntryItem(hair)}, and {createEntryItem(beard)}.</span>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t<InlineEntryComponent entry={pronouns}\r\n\t\t\t\t\t\tgetComponent={(e) => (\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{toSentenceCase(e.getRawValue().singular)}\r\n\t\t\t\t\t\t\t\t&nbsp; {pluralize(e.getRawValue(), 'has', 'have')} &nbsp;\r\n\t\t\t\t\t\t\t\t{createEntryItem(skin)}.\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t<InlineEntryComponent entry={pronouns}\r\n\t\t\t\t\t\tgetComponent={(e) => (\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{toSentenceCase(e.getRawValue().singular)}\r\n\t\t\t\t\t\t\t\t&nbsp; {pluralize(e.getRawValue(), 'stands', 'stand')} &nbsp;\r\n\t\t\t\t\t\t\t\t{createEntryItem(height, (e) => `${e.toString()}cm (${toFeet(e.getModifiedValue())})`)}\r\n\t\t\t\t\t\t\t\t&nbsp; tall and {pluralize(e.getRawValue(), 'has', 'have')} a &nbsp;\r\n\t\t\t\t\t\t\t\t{createEntryItem(weight)} build.\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t<InlineEntryComponent entry={pronouns}\r\n\t\t\t\t\t\tgetComponent={(e) => (\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{toSentenceCase(e.getRawValue().singular)}\r\n\t\t\t\t\t\t\t\t&nbsp; {pluralize(e.getRawValue(), 'has', 'have')} an &nbsp;\r\n\t\t\t\t\t\t\t\t{createEntryItem(face)} face.\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t{physicalTraits}\r\n\t\t\t</List>\r\n\r\n\t\t\t<Header as='h1' content='Identity' />\r\n\t\t\t<Table compact='very' size='small' striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t{ pronouns.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Pronouns</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(pronouns)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t\t{ genderIdentity.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Gender Identity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(genderIdentity)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t\t{ genderExpression.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Gender Expression</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(genderExpression)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t\t{ sex.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Sex</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(sex)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t\t{ romanticIdentity.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Romantic Identity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(romanticIdentity)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t\t{ sexualIdentity.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Sexual Identity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(sexualIdentity)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t\t{ sexualOrientation.isUsable() && <Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Sexual Orientation</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(sexualOrientation)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row> }\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\r\n\t\t\t<Header as='h1' content='Personality' />\r\n\t\t\t<List bulleted as='ul'>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t<InlineEntryComponent entry={pronouns}\r\n\t\t\t\t\t\tgetComponent={(e) => (\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{toSentenceCase(e.getRawValue().singular)}\r\n\t\t\t\t\t\t\t\t&nbsp; {createEntryItem(worship)} {pluralize(e.getRawValue(), 'worships', 'worship')} {createEntryItem(deity)}.\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>\r\n\t\t\t\t{quirkList}\r\n\t\t\t</List>\r\n\r\n\t\t\t{ relationshipStatus.isUsable() && <Header as='h1' content='Relations' />}\r\n\t\t\t{ relationshipStatus.isUsable() && <span>\r\n\t\t\t\t<b>Relationship Status:</b>&nbsp;{createEntryItem(relationshipStatus)}\t\r\n\t\t\t</span>}\r\n\t\t\t\r\n\t\t\t{ hooks.isUsable() && <Header as='h1' content='Hooks' /> }\r\n\t\t\t{ hooks.isUsable() && <List bulleted as='ul'>\r\n\t\t\t\t<List.Item as='li'>\r\n\t\t\t\t\t{createEntryItem(hooks, toSentenceCase(hooks.toString()))}\r\n\t\t\t\t</List.Item>\r\n\t\t\t</List>\r\n \t\t\t}\r\n\r\n\t\t\t<Header as='h1' content='Stats' />\r\n\r\n\t\t\t<Header as='h2' content='Ability Scores' />\r\n\t\t\t<Table striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Strength</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{strength.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Dexterity</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{dexterity.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Constitution</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{constitution.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Intelligence</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{intelligence.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Wisdom</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{wisdom.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Charisma</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{charisma.toString()}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\t\t\t\r\n\t\t\t<Header as='h2' content='Alignment Tendencies' />\r\n\t\t\t<Header as='h3' content='Ethical' />\r\n\t\t\t<Table compact='very' size='small' striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Lawful</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(ethicalPositive)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Neutral</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(ethicalNeutral)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Chaotic</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(ethicalNegative)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\t\t\t<Header as='h3' content='Moral' />\r\n\t\t\t<Table compact='very' size='small' striped textAlign='center'>\r\n\t\t\t\t<Table.Body>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Good</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(moralPositive)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Neutral</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(moralNeutral)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t<Table.Cell>Evil</Table.Cell>\r\n\t\t\t\t\t\t<Table.Cell>{createEntryItem(moralNegative)}</Table.Cell>\r\n\t\t\t\t\t</Table.Row>\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\r\n\t\t</div>\r\n\t);\r\n}","import React from 'react';\r\nimport { Header, Button, Icon, Popup, Menu, Dropdown } from 'semantic-ui-react';\r\nimport {\r\n\tgetDisplayIconForMode,\r\n} from './EDisplayModes';\r\nimport NpcData from '../../storage/NpcData';\r\nimport copyToClipboard from '../../lib/clipboard';\r\nimport Filter from '../../storage/Filter';\r\nimport { renderToString } from 'react-dom/server';\r\nimport { ArticleContent } from './ArticleContent';\r\n\r\nexport function MenuBar({\r\n\tswitchDisplayMode,\r\n\tdisplayMode,\r\n\tmenuItemsRight,\r\n\tgetEntryLink,\r\n})\r\n{\r\n\t// TODO: Figure out how to keep the switch view mode popup open when the item is clicked\r\n\treturn (\r\n\t\t<Menu borderless pointing secondary>\r\n\t\t\t<Menu.Item onClick={switchDisplayMode}>\r\n\t\t\t\t<Popup\r\n\t\t\t\t\tposition='bottom right'\r\n\t\t\t\t\tcontent={'Switch view mode'/*getDisplayModeSwitchLabel(displayMode)*/}\r\n\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t<Icon name={getDisplayIconForMode(displayMode)} />\r\n\t\t\t\t\t\t\t<Header.Content>NPC</Header.Content>\r\n\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t)}\r\n\t\t\t\t/>\r\n\t\t\t</Menu.Item>\r\n\t\t\t<Menu.Menu position='right'>\r\n\t\t\t\t{menuItemsRight || []}\r\n\t\t\t\t<Dropdown key='export' item text={'Copy To Clipboard'}>\r\n\t\t\t\t\t<Dropdown.Menu>\r\n\t\t\t\t\t\t<Dropdown.Item icon='linkify' text='Generator Link' onClick={() => copyToClipboard(NpcData.getLink())} />\r\n\t\t\t\t\t\t<Dropdown.Item icon='file text' text='Article' onClick={() => {\r\n\t\t\t\t\t\t\tcopyToClipboard(renderToString(\r\n\t\t\t\t\t\t\t\t<ArticleContent usePlainText={true} />\r\n\t\t\t\t\t\t\t));\r\n\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<Dropdown.Item icon='code' text='JSON' onClick={() => copyToClipboard(JSON.stringify(NpcData.getState()))} />\r\n\t\t\t\t\t</Dropdown.Menu>\r\n\t\t\t\t</Dropdown>\r\n\t\t\t\t<Menu.Item>\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\tposition='bottom right'\r\n\t\t\t\t\t\tcontent={'Clear All Filters'}\r\n\t\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\ticon\r\n\t\t\t\t\t\t\t\tonClick={Filter.clear}\r\n\t\t\t\t\t\t\t\tstyle={{ marginLeft: 2, marginRight: 2, }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Icon.Group>\r\n\t\t\t\t\t\t\t\t\t<Icon name='filter' />\r\n\t\t\t\t\t\t\t\t\t<Icon name='cancel' corner='bottom right' />\r\n\t\t\t\t\t\t\t\t</Icon.Group>\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\tposition='bottom right'\r\n\t\t\t\t\t\tcontent={'Delete generated data'}\r\n\t\t\t\t\t\ttrigger={(\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\ticon={'trash'}\r\n\t\t\t\t\t\t\t\tonClick={NpcData.clear}\r\n\t\t\t\t\t\t\t\tstyle={{ marginLeft: 2, marginRight: 2, }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Menu.Item>\r\n\t\t\t</Menu.Menu>\r\n\t\t</Menu>\r\n\t);\r\n}","import React from 'react';\r\nimport { Accordion, Icon } from 'semantic-ui-react';\r\nimport { camelCaseToTitle } from '../../lib/str';\r\nimport { StorageAccordion } from '../StorageAccordion';\r\nimport { DISPLAY_MODES } from './EDisplayModes';\r\nimport { DataViewEntry } from './DetailViewEntry';\r\nimport NpcData from '../../storage/NpcData';\r\nimport { MenuBar } from './MenuBar';\r\n\r\nfunction DetailViewCategory({\r\n\tpropertyKey, tableCollection,\r\n\tcategoryFields, storageKey,\r\n\tactive, onClick,\r\n})\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Accordion.Title\r\n\t\t\t\tindex={propertyKey}\r\n\t\t\t\tactive={active}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t\tstyle={{ marginBottom: 0 }}\r\n\t\t\t>\r\n\t\t\t\t<Icon name='dropdown' />\r\n\t\t\t\t{camelCaseToTitle(propertyKey)}\r\n\t\t\t</Accordion.Title>\r\n\t\t\t<Accordion.Content\r\n\t\t\t\tactive={active}\r\n\t\t\t>\r\n\t\t\t\t<div style={{\r\n\t\t\t\t\tpaddingLeft: '1em'\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<StorageAccordion\r\n\t\t\t\t\t\tstorageKey={storageKey}\r\n\t\t\t\t\t\tentryComponentType={DataViewEntry}\r\n\t\t\t\t\t\tactive={active}\r\n\t\t\t\t\t\tentries={categoryFields.reduce((accum, fieldKey) =>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taccum[fieldKey] = {\r\n\t\t\t\t\t\t\t\tpropertyKey: fieldKey,\r\n\t\t\t\t\t\t\t\ttableCollection: tableCollection,\r\n\t\t\t\t\t\t\t\tentryKey: `${propertyKey}.${fieldKey}`,\r\n\t\t\t\t\t\t\t\tstorageKey: `${storageKey}.${fieldKey}`,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\treturn accum;\r\n\t\t\t\t\t\t}, {})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Accordion.Content>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport function DetailView(props)\r\n{\r\n\tconst npcSchema = props.tableCollection.getNpcSchema();\r\n\tconst storageKey = `npc.${DISPLAY_MODES.Detailed}.expandedEntries`;\r\n\tconsole.log(props.tableCollection, npcSchema, NpcData.get());\r\n\tconst npc = NpcData.get();\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<MenuBar\r\n\t\t\t\tswitchDisplayMode={props.switchDisplayMode}\r\n\t\t\t\tdisplayMode={props.displayMode}\r\n\t\t\t/>\r\n\r\n\t\t\t<StorageAccordion\r\n\t\t\t\tstorageKey={storageKey}\r\n\t\t\t\tentryComponentType={DetailViewCategory}\r\n\t\t\t\tentries={npc.getCategories().reduce((accum, category) =>\r\n\t\t\t\t{\r\n\t\t\t\t\taccum[category] = {\r\n\t\t\t\t\t\tpropertyKey: category,\r\n\t\t\t\t\t\ttableCollection: props.tableCollection,\r\n\t\t\t\t\t\tcategoryFields: npc.getEntriesForCategory(category),\r\n\t\t\t\t\t\tstorageKey: `${storageKey}.${category}`,\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn accum;\r\n\t\t\t\t}, {})}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport { MenuBar } from './MenuBar';\r\nimport { ArticleContent } from './ArticleContent';\r\n\r\nexport function ArticleView(props)\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<MenuBar\r\n\t\t\t\tswitchDisplayMode={props.switchDisplayMode}\r\n\t\t\t\tdisplayMode={props.displayMode}\r\n\t\t\t/>\r\n\t\t\t<ArticleContent/>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport TableCollection from '../storage/TableCollection';\r\nimport { Loader, Icon } from 'semantic-ui-react';\r\nimport shortid from 'shortid';\r\nimport { DetailView } from '../components/NPC/DetailView';\r\nimport storage from 'local-storage';\r\nimport {\r\n\tDISPLAY_MODES,\r\n\tgetNextDisplayMode,\r\n} from '../components/NPC/EDisplayModes';\r\nimport NpcData from '../storage/NpcData';\r\nimport { ArticleView } from '../components/NPC/ArticleView';\r\n\r\nconst CURRENT_DISPLAYMODE_STORAGE = `npc.displayMode`;\r\n\r\nexport function NpcView(props)\r\n{\r\n\tconst parsedNpcData = NpcData.getCurrentLinkData();\r\n\tif (parsedNpcData !== undefined)\r\n\t{\r\n\t\t// filter out the npc data\r\n\t\t// warning: this will remove ALL url params\r\n\t\twindow.location.replace(\r\n\t\t\t`${window.location.protocol}//${window.location.host}${window.location.pathname}`\r\n\t\t);\r\n\t}\r\n\r\n\tconst refreshWith = useState(0)[1];\r\n\tconst [displayMode, setDisplayMode] = useState(storage.get(CURRENT_DISPLAYMODE_STORAGE) || DISPLAY_MODES.Readable);\r\n\tconst switchDisplayMode = () => {\r\n\t\tconst nextMode = getNextDisplayMode(displayMode);\r\n\t\tstorage.set(CURRENT_DISPLAYMODE_STORAGE, nextMode);\r\n\t\tsetDisplayMode(nextMode);\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tfunction onTableCollectionChanged({ detail })\r\n\t\t{\r\n\t\t\trefreshWith(shortid.generate());\r\n\t\t};\r\n\t\tTableCollection.addOnChanged(onTableCollectionChanged);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tTableCollection.removeOnChanged(onTableCollectionChanged);\r\n\t\t}\r\n\t});\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tfunction onNpcInitialized({ detail })\r\n\t\t{\r\n\t\t\trefreshWith(shortid.generate());\r\n\t\t};\r\n\t\tNpcData.toggleOnInitialized('on', onNpcInitialized);\r\n\t\tif (!NpcData.get())\r\n\t\t{\r\n\t\t\tNpcData.initialize((npc) => {\r\n\t\t\t\tif (parsedNpcData !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\tnpc.setState(parsedNpcData);\r\n\t\t\t\t}\r\n\t\t\t\tnpc.regenerateAll(NpcData.getState() || {});\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tNpcData.toggleOnInitialized('off', onNpcInitialized);\r\n\t\t}\r\n\t});\r\n\r\n\tconst tableCollection = TableCollection.get();\r\n\tconst npcData = NpcData.get();\r\n\tif (!tableCollection || !npcData)\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Loader active>Loading</Loader>\r\n\t\t);\r\n\t}\r\n\r\n\tswitch (displayMode)\r\n\t{\r\n\t\tcase DISPLAY_MODES.Readable: return (\r\n\t\t\t<ArticleView\r\n\t\t\t\tlocation={props.location}\r\n\t\t\t\ttableCollection={tableCollection}\r\n\t\t\t\tswitchDisplayMode={switchDisplayMode}\r\n\t\t\t\tdisplayMode={displayMode}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tcase DISPLAY_MODES.Detailed: return (\r\n\t\t\t<DetailView\r\n\t\t\t\tlocation={props.location}\r\n\t\t\t\ttableCollection={tableCollection}\r\n\t\t\t\tswitchDisplayMode={switchDisplayMode}\r\n\t\t\t\tdisplayMode={displayMode}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tdefault: return (\r\n\t\t\t<div>\r\n\t\t\t\tSomething went wrong, I'm confused... <Icon name='question' />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","\r\nconst EVENTS = new EventTarget();\r\n\r\nexport class View\r\n{\r\n\r\n\tstatic set(view)\r\n\t{\r\n\t\tif (view === View.get()) { return; }\r\n\t\twindow.sessionStorage.setItem(\"view\", view);\r\n\t\tEVENTS.dispatchEvent(new CustomEvent('onChanged_view', { detail: view }));\r\n\t}\r\n\r\n\tstatic get()\r\n\t{\r\n\t\treturn window.sessionStorage.getItem(\"view\");\r\n\t}\r\n\r\n\tstatic subscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.addEventListener('onChanged_view', callback);\r\n\t}\r\n\r\n\tstatic unsubscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.removeEventListener('onChanged_view', callback);\r\n\t}\r\n\r\n}\r\n\r\nexport class Table\r\n{\r\n\r\n\tstatic set(value)\r\n\t{\r\n\t\tif (value === Table.get()) { return; }\r\n\t\twindow.sessionStorage.setItem(\"table\", value);\r\n\t\tEVENTS.dispatchEvent(new CustomEvent('onChanged_table', { detail: value }));\r\n\t}\r\n\r\n\tstatic get()\r\n\t{\r\n\t\treturn window.sessionStorage.getItem(\"table\");\r\n\t}\r\n\r\n\tstatic subscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.addEventListener('onChanged_table', callback);\r\n\t}\r\n\r\n\tstatic unsubscribeOnChanged(callback)\r\n\t{\r\n\t\tEVENTS.removeEventListener('onChanged_table', callback);\r\n\t}\r\n\r\n}","import React from 'react';\r\nimport TableCollection from '../storage/TableCollection';\r\nimport {useTable} from 'react-table';\r\nimport { Table, Header, Container } from 'semantic-ui-react';\r\nimport * as DataTable from '../storage/Table';\r\n\r\nfunction getDataTable(tableKey)\r\n{\r\n\tconst tableCollection = TableCollection.get();\r\n\tif (!tableCollection) { return undefined; }\r\n\treturn tableKey !== undefined ? tableCollection.getTableAtPath(tableKey) : undefined;\r\n}\r\n\r\n// ReactHooks: https://reactjs.org/docs/hooks-effect.html\r\n// Memos: https://reactjs.org/docs/hooks-reference.html#usememo\r\nexport default function DataTableView({ tableKey })\r\n{\r\n\tconst dataTable = getDataTable(tableKey);\r\n\t\r\n\tconst columns = React.useMemo(() => DataTable.default.COLUMNS, []);\r\n\r\n\tconst [rowCount, setRowCount] = React.useState(dataTable === undefined ? 0 : dataTable.length());\r\n\tReact.useEffect(() => {\r\n\r\n\t\tif (dataTable === undefined) { return; }\r\n\r\n\t\tfunction onChangedRowCount({ details })\r\n\t\t{\r\n\t\t\tsetRowCount(details.next);\r\n\t\t}\r\n\r\n\t\tdataTable.subscribeOnChangedRowCount(onChangedRowCount);\r\n\r\n\t\treturn () => {\r\n\t\t\tdataTable.unsubscribeOnChangedRowCount(onChangedRowCount);\r\n\t\t};\r\n\t});\r\n\r\n\tconst data = React.useMemo(() => {\r\n\t\tconst table = getDataTable(tableKey);\r\n\t\tif (table === undefined) { return []; }\r\n\t\treturn table.getRows();\r\n\t}, [tableKey]);\r\n\r\n\t// React-Table API: https://github.com/tannerlinsley/react-table/blob/master/docs/api.md#usetable\r\n\t// React-Table Examples: https://github.com/tannerlinsley/react-table/blob/master/docs/examples.md\r\n\tconst {\r\n\t\tgetTableProps,\r\n\t\tgetTableBodyProps,\r\n    headerGroups,\r\n    rows,\r\n    prepareRow,\r\n\t} = useTable({\r\n\t\tcolumns, data,\r\n\t});\r\n\r\n\tif (dataTable === undefined)\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Header>\r\n\t\t\t\t403: No table found\r\n\t\t\t</Header>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<Header>{dataTable.getKey()} ({rowCount} rows)</Header>\r\n\t\t\t<Table {...getTableProps()}>\r\n\t\t\t\t<Table.Header>\r\n\t\t\t\t\t{headerGroups.map((headerGroup) => (\r\n\t\t\t\t\t\t<Table.Row {...headerGroup.getHeaderGroupProps()}>\r\n\t\t\t\t\t\t\t{headerGroup.headers.map((column) => (\r\n\t\t\t\t\t\t\t\t<Table.HeaderCell {...column.getHeaderProps()}>\r\n\t\t\t\t\t\t\t\t\t{column.render('Header')}\r\n\t\t\t\t\t\t\t\t</Table.HeaderCell>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Table.Header>\r\n\t\t\t\t<Table.Body {...getTableBodyProps()}>\r\n\t\t\t\t\t{rows.map((row, i) => prepareRow(row) || (\r\n\t\t\t\t\t\t<Table.Row {...row.getRowProps()}>\r\n\t\t\t\t\t\t\t{row.cells.map(cell => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Table.Cell {...cell.getCellProps()}>\r\n\t\t\t\t\t\t\t\t\t\t{cell.render('Cell')}\r\n\t\t\t\t\t\t\t\t\t</Table.Cell>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Table.Body>\r\n\t\t\t</Table>\r\n\t\t</Container>\r\n\t);\r\n}\r\n\r\n/*\r\nexport class DataTableView extends React.Component\r\n{\r\n\tgetTableData()\r\n\t{\r\n\t\tconst tableCollection = TableCollection.get();\r\n\t\tif (!tableCollection) { return undefined; }\r\n\t\tconst tableKey = this.props.tableKey;\r\n\t\treturn tableKey !== undefined ? tableCollection.getTable(tableKey) : undefined;\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tconsole.log(DataTable.default.COLUMNS);\r\n\t\treturn 'T2';\r\n\t\tconsole.log(COLUMNS);\r\n\r\n\t\tconst tableData = this.getTableData();\r\n\t\tif (tableData === undefined)\r\n\t\t{\r\n\t\t}\r\n\r\n\t\tconsole.log(tableData);\r\n\r\n\t}\r\n\r\n}\r\n\t\t//*/\r\n","import React from 'react';\r\nimport lodash from 'lodash';\r\nimport TableCollection from '../storage/TableCollection';\r\nimport Tree from 'react-animated-tree';\r\nimport { View, Table } from '../storage/Session';\r\nimport * as queryString from 'query-string';\r\nimport DataTableView from '../components/DataTableView';\r\n\r\nexport function DataView()\r\n{\r\n\tconst urlParams = queryString.parse(window.location.search);\r\n\tif (urlParams.table !== undefined)\r\n\t{\r\n\t\treturn <DataTableView tableKey={urlParams.table} />\r\n\t}\r\n\r\n\tfunction makeTreeNode([pathItem, nodeDetails])\r\n\t{\r\n\t\tconst allNodeProperties = Object.keys(nodeDetails);\r\n\t\tconst subNodeProperties = allNodeProperties.filter((item) => item !== 'table');\r\n\t\tconst hasTable = allNodeProperties.includes('table');\r\n\t\treturn (\r\n\t\t\t<Tree key={pathItem}\r\n\t\t\t\tcontent={(\r\n\t\t\t\t\thasTable ? (\r\n\t\t\t\t\t\t<a href={(\r\n\t\t\t\t\t\t\t`${window.location.protocol}//${window.location.host}${window.location.pathname}?table=${nodeDetails.table.getKeyPath()}`\r\n\t\t\t\t\t\t)}>{pathItem}</a>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\tsubNodeProperties.length > 0 ? pathItem : `Unknown: ${pathItem}`\r\n\t\t\t\t\t)\r\n\t\t\t\t)}\r\n\t\t\t\tonClick={(\r\n\t\t\t\t\t!hasTable ? undefined : () =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tView.set(\"data\");\r\n\t\t\t\t\t\tTable.set(nodeDetails.table.getKeyPath());\r\n\t\t\t\t\t}\r\n\t\t\t\t)}\r\n\t\t\t>\r\n\t\t\t\t{(\r\n\t\t\t\t\tsubNodeProperties.map(\r\n\t\t\t\t\t\t(propKey) => ([propKey, nodeDetails[propKey]])\r\n\t\t\t\t\t).map(makeTreeNode)\r\n\t\t\t\t)}\r\n\t\t\t</Tree>\r\n\t\t);\r\n\t}\r\n\r\n\tconst tableCollection = TableCollection.get();\r\n\tif (tableCollection)\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Tree\r\n\t\t\t\tcontent={'Tables'}\r\n\t\t\t>\r\n\t\t\t\t{lodash.toPairs(tableCollection.getTableTree()).map(makeTreeNode)}\r\n\t\t\t</Tree>\r\n\t\t);\r\n\t}\r\n}","import React from 'react';\r\nimport { Header } from 'semantic-ui-react';\r\n\r\nexport class HomeView extends React.Component\r\n{\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Header>HOME</Header>\r\n\t\t);\r\n\t}\r\n}","import React from 'react';\r\nimport { NpcView } from \"./view/NpcView\";\r\nimport { DataView } from \"./view/DataView\";\r\nimport { HomeView } from './view/HomeView';\r\n\r\nconst routes = {\r\n\t\"home\": () => <HomeView />,\r\n\t\"npc\": () => <NpcView />,\r\n  \"data\": () => <DataView />,\r\n};\r\n\r\nexport default routes;","import React from 'react';\r\nimport { Menu } from 'semantic-ui-react';\r\nimport { View } from '../storage/Session';\r\n\r\nexport function HeaderBarLink({ path, children })\r\n{\r\n\treturn (\r\n\t\t<Menu.Item\r\n\t\t\tname={path}\r\n\t\t\tactive={View.get() === path}\r\n\t\t\tonClick={() => {\r\n\t\t\t\tView.set(path);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</Menu.Item>\r\n\t);\r\n}","import React from 'react';\r\nimport { Menu, Button, Icon } from 'semantic-ui-react';\r\nimport { HeaderBarLink } from './HeaderBarLink';\r\nimport TableCollection from '../storage/TableCollection';\r\n\r\nexport class HeaderBar extends React.Component\r\n{\r\n\r\n\tonClearStorage()\r\n\t{\r\n\t\tconsole.log('Syncing tables');\r\n\t\tTableCollection.clear();\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Menu>\r\n\t\t\t\t<HeaderBarLink path={'home'}>Home</HeaderBarLink>\r\n\t\t\t\t<HeaderBarLink path={'npc'}>NPC</HeaderBarLink>\r\n\t\t\t\t<HeaderBarLink path={'data'}>Data</HeaderBarLink>\r\n\r\n\t\t\t\t<Menu.Item position='right'>\r\n\t\t\t\t\t<Button color='red' onClick={this.onClearStorage.bind(this)}>\r\n\t\t\t\t\t\t<Icon name='sync' /> Sync\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Menu.Item>\r\n      </Menu>\r\n\t\t);\r\n\t}\r\n}","import React from 'react';\r\nimport { HeaderBar } from '../components/HeaderBar';\r\nimport { Container } from 'semantic-ui-react';\r\n\r\nexport class ViewContainer extends React.Component\r\n{\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<Container>\r\n\t\t\t\t<HeaderBar page={this.props.page} />\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t</Container>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { Container } from \"semantic-ui-react\";\r\nimport Routes from './routes';\r\nimport { HomeView } from \"./view/HomeView\";\r\nimport shortid from 'shortid';\r\nimport TableCollection from './storage/TableCollection';\r\nimport { ViewContainer } from './view/ViewContainer';\r\nimport { View } from './storage/Session';\r\nimport NpcData from './storage/NpcData';\r\n\r\nfunction getRoute(view)\r\n{\r\n\tif (Routes.hasOwnProperty(view)) return Routes[view]();\r\n\telse return (<HomeView />);\r\n}\r\n\r\nexport default function App()\r\n{\r\n\tconst refreshWith = React.useState(undefined)[1];\r\n\r\n\tif (NpcData.getCurrentLinkData() !== undefined)\r\n\t{\r\n\t\tView.set(\"npc\");\r\n\t}\r\n \r\n\tReact.useEffect(() => {\r\n\t\tconst onViewChanged = () => refreshWith(shortid.generate());\r\n\t\tView.subscribeOnChanged(onViewChanged);\r\n\t\treturn () => {\r\n\t\t\tView.unsubscribeOnChanged(onViewChanged);\r\n\t\t};\r\n\t});\r\n\r\n\tReact.useEffect(() =>\r\n\t{\r\n\t\tfunction onTableCollectionChanged()\r\n\t\t{\r\n\t\t\trefreshWith(shortid.generate());\r\n\t\t};\r\n\t\tTableCollection.addOnChanged(onTableCollectionChanged);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\tTableCollection.removeOnChanged(onTableCollectionChanged);\r\n\t\t}\r\n\t});\r\n\r\n\tif (!TableCollection.get())\r\n\t{\r\n\t\tTableCollection.initialize();\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Container id={'App'} fluid>\r\n\t\t\t<ViewContainer page={window.location.pathname}>\r\n\t\t\t\t{getRoute(View.get())}\r\n\t\t\t</ViewContainer>\r\n\t\t</Container>\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'semantic-ui-css/semantic.min.css';\r\n\r\n// https://www.npmjs.com/package/semver\r\nconsole.log('Versions:', {\r\n\treact: React.version,\r\n\tnode: process.versions.node,\r\n});\r\nconsole.log(`Serving at public url: ${process.env.PUBLIC_URL}`);\r\n\r\nReactDOM.render((\r\n\t<App />\r\n), document.getElementById('root'));","module.exports = (values) =>\r\n{\r\n\treturn values[Math.floor(Math.random() * values.length)];\r\n}","var map = {\n\t\"./tables/bonus/ability/cha/high.json\": 224,\n\t\"./tables/bonus/ability/cha/index.json\": 225,\n\t\"./tables/bonus/ability/cha/low.json\": 226,\n\t\"./tables/bonus/ability/cha/medium.json\": 227,\n\t\"./tables/bonus/ability/const/high.json\": 228,\n\t\"./tables/bonus/ability/const/index.json\": 229,\n\t\"./tables/bonus/ability/const/low.json\": 230,\n\t\"./tables/bonus/ability/const/medium.json\": 231,\n\t\"./tables/bonus/ability/dex/high.json\": 232,\n\t\"./tables/bonus/ability/dex/index.json\": 233,\n\t\"./tables/bonus/ability/dex/low.json\": 234,\n\t\"./tables/bonus/ability/dex/medium.json\": 235,\n\t\"./tables/bonus/ability/index.json\": 236,\n\t\"./tables/bonus/ability/int/high.json\": 237,\n\t\"./tables/bonus/ability/int/index.json\": 238,\n\t\"./tables/bonus/ability/int/low.json\": 239,\n\t\"./tables/bonus/ability/int/medium.json\": 240,\n\t\"./tables/bonus/ability/str/high.json\": 241,\n\t\"./tables/bonus/ability/str/index.json\": 242,\n\t\"./tables/bonus/ability/str/low.json\": 243,\n\t\"./tables/bonus/ability/str/medium.json\": 244,\n\t\"./tables/bonus/ability/wis/high.json\": 245,\n\t\"./tables/bonus/ability/wis/index.json\": 246,\n\t\"./tables/bonus/ability/wis/low.json\": 247,\n\t\"./tables/bonus/ability/wis/medium.json\": 248,\n\t\"./tables/bonus/index.json\": 249,\n\t\"./tables/common/color.json\": 250,\n\t\"./tables/common/frequency.json\": 251,\n\t\"./tables/common/index.json\": 252,\n\t\"./tables/common/language.json\": 253,\n\t\"./tables/common/rightLeft.json\": 254,\n\t\"./tables/common/rightLeftBoth.json\": 255,\n\t\"./tables/deity/archdevil.json\": 256,\n\t\"./tables/deity/demon.json\": 257,\n\t\"./tables/deity/dragon.json\": 258,\n\t\"./tables/deity/drow.json\": 259,\n\t\"./tables/deity/dwarf.json\": 260,\n\t\"./tables/deity/elf.json\": 261,\n\t\"./tables/deity/evil.json\": 262,\n\t\"./tables/deity/gnome.json\": 263,\n\t\"./tables/deity/good.json\": 264,\n\t\"./tables/deity/halfling.json\": 265,\n\t\"./tables/deity/index.json\": 266,\n\t\"./tables/deity/orc.json\": 267,\n\t\"./tables/filters.json\": 268,\n\t\"./tables/hooks/all.json\": 269,\n\t\"./tables/hooks/contest.json\": 270,\n\t\"./tables/hooks/furniture.json\": 271,\n\t\"./tables/hooks/index.json\": 272,\n\t\"./tables/hooks/organization.json\": 273,\n\t\"./tables/hooks/personality.json\": 274,\n\t\"./tables/hooks/werebeast.json\": 275,\n\t\"./tables/identity/genderExpression.json\": 276,\n\t\"./tables/identity/genderIdentity.json\": 277,\n\t\"./tables/identity/index.json\": 278,\n\t\"./tables/identity/pronouns/index.json\": 279,\n\t\"./tables/identity/pronouns/man.json\": 280,\n\t\"./tables/identity/pronouns/nonbinary.json\": 281,\n\t\"./tables/identity/pronouns/woman.json\": 282,\n\t\"./tables/identity/romanticIdentity.json\": 283,\n\t\"./tables/identity/sex.json\": 284,\n\t\"./tables/identity/sexualIdentity.json\": 285,\n\t\"./tables/identity/sexualOrientation.json\": 286,\n\t\"./tables/identity/sexualOrientation/gayLesbian/index.json\": 287,\n\t\"./tables/identity/sexualOrientation/gayLesbian/man.json\": 288,\n\t\"./tables/identity/sexualOrientation/gayLesbian/nonbinary.json\": 289,\n\t\"./tables/identity/sexualOrientation/gayLesbian/woman.json\": 290,\n\t\"./tables/identity/sexualOrientation/index.json\": 291,\n\t\"./tables/index.json\": 292,\n\t\"./tables/items/aliment.json\": 293,\n\t\"./tables/items/clothes.json\": 294,\n\t\"./tables/items/index.json\": 295,\n\t\"./tables/items/mundanePlural.json\": 296,\n\t\"./tables/items/precious.json\": 297,\n\t\"./tables/items/preciousPrefixed.json\": 298,\n\t\"./tables/items/weapon.json\": 299,\n\t\"./tables/items/weapon/index.json\": 300,\n\t\"./tables/items/weapon/martialfinesse.json\": 301,\n\t\"./tables/items/weapon/martialranged.json\": 302,\n\t\"./tables/items/weapon/martialweapon.json\": 303,\n\t\"./tables/items/weapon/simplefinesse.json\": 304,\n\t\"./tables/items/weapon/simpleranged.json\": 305,\n\t\"./tables/items/weapon/simpleweapon.json\": 306,\n\t\"./tables/misc/abstractWord.json\": 307,\n\t\"./tables/misc/index.json\": 308,\n\t\"./tables/misc/monster.json\": 309,\n\t\"./tables/npc-full.json\": 310,\n\t\"./tables/npc.json\": 311,\n\t\"./tables/occupation/Class/Caster.json\": 312,\n\t\"./tables/occupation/Class/Category.json\": 313,\n\t\"./tables/occupation/Class/Martial.json\": 314,\n\t\"./tables/occupation/Class/Misc.json\": 315,\n\t\"./tables/occupation/Class/index.json\": 316,\n\t\"./tables/occupation/Craftsperson.json\": 317,\n\t\"./tables/occupation/Entertainer.json\": 318,\n\t\"./tables/occupation/Government.json\": 319,\n\t\"./tables/occupation/Independent.json\": 320,\n\t\"./tables/occupation/Martial.json\": 321,\n\t\"./tables/occupation/Merchant.json\": 322,\n\t\"./tables/occupation/Outlaw.json\": 323,\n\t\"./tables/occupation/PhilosopherFields.json\": 324,\n\t\"./tables/occupation/PublicServant.json\": 325,\n\t\"./tables/occupation/Religious.json\": 326,\n\t\"./tables/occupation/Scholar.json\": 327,\n\t\"./tables/occupation/Traveler.json\": 328,\n\t\"./tables/occupation/all.json\": 329,\n\t\"./tables/occupation/index.json\": 330,\n\t\"./tables/occupation/type.json\": 331,\n\t\"./tables/personality/index.json\": 332,\n\t\"./tables/personality/worship.json\": 333,\n\t\"./tables/quirks.json\": 334,\n\t\"./tables/quirks/general.json\": 335,\n\t\"./tables/quirks/index.json\": 336,\n\t\"./tables/quirks/military.json\": 337,\n\t\"./tables/quirks/modifier/collection.json\": 338,\n\t\"./tables/quirks/modifier/index.json\": 339,\n\t\"./tables/quirks/modifier/inheritance.json\": 340,\n\t\"./tables/quirks/modifier/pet/animal.json\": 341,\n\t\"./tables/quirks/modifier/pet/index.json\": 342,\n\t\"./tables/quirks/modifier/pet/name.json\": 343,\n\t\"./tables/quirks/modifier/raceAllergy.json\": 344,\n\t\"./tables/quirks/modifier/relation.json\": 345,\n\t\"./tables/quirks/modifier/relation/familyMember.json\": 346,\n\t\"./tables/quirks/modifier/relation/index.json\": 347,\n\t\"./tables/quirks/modifier/size.json\": 348,\n\t\"./tables/quirks/nature.json\": 349,\n\t\"./tables/quirks/poor.json\": 350,\n\t\"./tables/quirks/religious.json\": 351,\n\t\"./tables/quirks/rich.json\": 352,\n\t\"./tables/quirks/traits-1.json\": 353,\n\t\"./tables/quirks/traits-2.json\": 354,\n\t\"./tables/quirks/weird.json\": 355,\n\t\"./tables/race.json\": 356,\n\t\"./tables/race/Aasimar/deity.json\": 357,\n\t\"./tables/race/Aasimar/index.json\": 358,\n\t\"./tables/race/Aasimar/name-man.json\": 359,\n\t\"./tables/race/Aasimar/name-nonbinary.json\": 360,\n\t\"./tables/race/Aasimar/name-woman.json\": 361,\n\t\"./tables/race/Aasimar/quirk-evil.json\": 362,\n\t\"./tables/race/Aasimar/quirk-good.json\": 363,\n\t\"./tables/race/Dragonborn/color.json\": 364,\n\t\"./tables/race/Dragonborn/deity.json\": 365,\n\t\"./tables/race/Dragonborn/hair.json\": 366,\n\t\"./tables/race/Dragonborn/index.json\": 367,\n\t\"./tables/race/Dragonborn/name-man.json\": 368,\n\t\"./tables/race/Dragonborn/name-nonbinary.json\": 369,\n\t\"./tables/race/Dragonborn/name-woman.json\": 370,\n\t\"./tables/race/Dragonborn/quirks.json\": 371,\n\t\"./tables/race/Dwarf.json\": 372,\n\t\"./tables/race/Dwarf/beard.json\": 373,\n\t\"./tables/race/Dwarf/deity.json\": 374,\n\t\"./tables/race/Dwarf/index.json\": 375,\n\t\"./tables/race/Dwarf/name-man.json\": 376,\n\t\"./tables/race/Dwarf/name-nonbinary.json\": 377,\n\t\"./tables/race/Dwarf/name-woman.json\": 378,\n\t\"./tables/race/Dwarf/quirks.json\": 379,\n\t\"./tables/race/Dwarf/skin.json\": 380,\n\t\"./tables/race/Dwarf/surname.json\": 381,\n\t\"./tables/race/Elf.json\": 382,\n\t\"./tables/race/Elf/Drow/index.json\": 383,\n\t\"./tables/race/Elf/Drow/quirks.json\": 384,\n\t\"./tables/race/Elf/deity.json\": 385,\n\t\"./tables/race/Elf/index.json\": 386,\n\t\"./tables/race/Elf/name-man.json\": 387,\n\t\"./tables/race/Elf/name-nonbinary.json\": 388,\n\t\"./tables/race/Elf/name-woman.json\": 389,\n\t\"./tables/race/Elf/quirks.json\": 390,\n\t\"./tables/race/Elf/skin.json\": 391,\n\t\"./tables/race/Elf/skin/color.json\": 392,\n\t\"./tables/race/Elf/skin/index.json\": 393,\n\t\"./tables/race/Elf/surname.json\": 394,\n\t\"./tables/race/Firbolg/deity.json\": 395,\n\t\"./tables/race/Firbolg/index.json\": 396,\n\t\"./tables/race/Firbolg/name-man.json\": 397,\n\t\"./tables/race/Firbolg/name-nonbinary.json\": 398,\n\t\"./tables/race/Firbolg/name-woman.json\": 399,\n\t\"./tables/race/Firbolg/quirks.json\": 400,\n\t\"./tables/race/Firbolg/skin.json\": 401,\n\t\"./tables/race/Gnome.json\": 402,\n\t\"./tables/race/Gnome/deity.json\": 403,\n\t\"./tables/race/Gnome/index.json\": 404,\n\t\"./tables/race/Gnome/name-man.json\": 405,\n\t\"./tables/race/Gnome/name-nonbinary.json\": 406,\n\t\"./tables/race/Gnome/name-woman.json\": 407,\n\t\"./tables/race/Gnome/name/any.json\": 408,\n\t\"./tables/race/Gnome/name/index.json\": 409,\n\t\"./tables/race/Gnome/name/man-1.json\": 410,\n\t\"./tables/race/Gnome/name/man-2.json\": 411,\n\t\"./tables/race/Gnome/name/man-3.json\": 412,\n\t\"./tables/race/Gnome/name/man-4.json\": 413,\n\t\"./tables/race/Gnome/name/man.json\": 414,\n\t\"./tables/race/Gnome/name/woman-1.json\": 415,\n\t\"./tables/race/Gnome/name/woman-2.json\": 416,\n\t\"./tables/race/Gnome/name/woman-3.json\": 417,\n\t\"./tables/race/Gnome/name/woman-4.json\": 418,\n\t\"./tables/race/Gnome/name/woman.json\": 419,\n\t\"./tables/race/Gnome/quirks.json\": 420,\n\t\"./tables/race/Goblin/deity.json\": 421,\n\t\"./tables/race/Goblin/index.json\": 422,\n\t\"./tables/race/Goblin/name-man.json\": 423,\n\t\"./tables/race/Goblin/name-nonbinary.json\": 424,\n\t\"./tables/race/Goblin/name-woman.json\": 425,\n\t\"./tables/race/Goliath/deity.json\": 426,\n\t\"./tables/race/Goliath/hair.json\": 427,\n\t\"./tables/race/Goliath/hairTattoos.json\": 428,\n\t\"./tables/race/Goliath/index.json\": 429,\n\t\"./tables/race/Goliath/name-man.json\": 430,\n\t\"./tables/race/Goliath/name-nonbinary.json\": 431,\n\t\"./tables/race/Goliath/name-woman.json\": 432,\n\t\"./tables/race/Goliath/names/adjective.json\": 433,\n\t\"./tables/race/Goliath/names/animal-action.json\": 434,\n\t\"./tables/race/Goliath/names/animal-noun.json\": 435,\n\t\"./tables/race/Goliath/names/craft-action.json\": 436,\n\t\"./tables/race/Goliath/names/craft-noun.json\": 437,\n\t\"./tables/race/Goliath/names/fighting-action.json\": 438,\n\t\"./tables/race/Goliath/names/fighting-noun.json\": 439,\n\t\"./tables/race/Goliath/names/index.json\": 440,\n\t\"./tables/race/Goliath/names/mystic-action.json\": 441,\n\t\"./tables/race/Goliath/names/mystic-noun.json\": 442,\n\t\"./tables/race/Goliath/names/noun.json\": 443,\n\t\"./tables/race/Goliath/quirks-1.json\": 444,\n\t\"./tables/race/Goliath/quirks-2.json\": 445,\n\t\"./tables/race/Half-Dwarf/deity.json\": 446,\n\t\"./tables/race/Half-Dwarf/index.json\": 447,\n\t\"./tables/race/Half-Dwarf/name-man.json\": 448,\n\t\"./tables/race/Half-Dwarf/name-nonbinary.json\": 449,\n\t\"./tables/race/Half-Dwarf/name-woman.json\": 450,\n\t\"./tables/race/Half-Elf/deity.json\": 451,\n\t\"./tables/race/Half-Elf/index.json\": 452,\n\t\"./tables/race/Half-Elf/name-man.json\": 453,\n\t\"./tables/race/Half-Elf/name-nonbinary.json\": 454,\n\t\"./tables/race/Half-Elf/name-woman.json\": 455,\n\t\"./tables/race/Half-Orc/deity.json\": 456,\n\t\"./tables/race/Half-Orc/index.json\": 457,\n\t\"./tables/race/Half-Orc/name-man.json\": 458,\n\t\"./tables/race/Half-Orc/name-nonbinary.json\": 459,\n\t\"./tables/race/Half-Orc/name-woman.json\": 460,\n\t\"./tables/race/Half-Orc/skin.json\": 461,\n\t\"./tables/race/Halfling.json\": 462,\n\t\"./tables/race/Halfling/deity.json\": 463,\n\t\"./tables/race/Halfling/index.json\": 464,\n\t\"./tables/race/Halfling/name-man.json\": 465,\n\t\"./tables/race/Halfling/name-nonbinary.json\": 466,\n\t\"./tables/race/Halfling/name-woman.json\": 467,\n\t\"./tables/race/Halfling/quirks.json\": 468,\n\t\"./tables/race/Halfling/surname.json\": 469,\n\t\"./tables/race/Human/deity.json\": 470,\n\t\"./tables/race/Human/index.json\": 471,\n\t\"./tables/race/Human/name-man.json\": 472,\n\t\"./tables/race/Human/name-nonbinary.json\": 473,\n\t\"./tables/race/Human/name-woman.json\": 474,\n\t\"./tables/race/Human/surname.json\": 475,\n\t\"./tables/race/Kenku/deity.json\": 476,\n\t\"./tables/race/Kenku/index.json\": 477,\n\t\"./tables/race/Kenku/name-man.json\": 478,\n\t\"./tables/race/Kenku/name-nonbinary.json\": 479,\n\t\"./tables/race/Kenku/name-woman.json\": 480,\n\t\"./tables/race/Kenku/names/index.json\": 481,\n\t\"./tables/race/Kenku/names/kenkunameanimal.json\": 482,\n\t\"./tables/race/Kenku/names/kenkunamefighting.json\": 483,\n\t\"./tables/race/Kenku/names/kenkunamemetal.json\": 484,\n\t\"./tables/race/Kenku/names/kenkunamequiet.json\": 485,\n\t\"./tables/race/Kenku/quirks.json\": 486,\n\t\"./tables/race/Kenku/skin.json\": 487,\n\t\"./tables/race/Kenku/skin/color.json\": 488,\n\t\"./tables/race/Kenku/skin/featherTexture.json\": 489,\n\t\"./tables/race/Kenku/skin/index.json\": 490,\n\t\"./tables/race/Lizardfolk/deity.json\": 491,\n\t\"./tables/race/Lizardfolk/index.json\": 492,\n\t\"./tables/race/Lizardfolk/name-man.json\": 493,\n\t\"./tables/race/Lizardfolk/name-nonbinary.json\": 494,\n\t\"./tables/race/Lizardfolk/name-woman.json\": 495,\n\t\"./tables/race/Lizardfolk/quirks-1.json\": 496,\n\t\"./tables/race/Lizardfolk/quirks-2.json\": 497,\n\t\"./tables/race/Orc/deity.json\": 498,\n\t\"./tables/race/Orc/index.json\": 499,\n\t\"./tables/race/Orc/name-man.json\": 500,\n\t\"./tables/race/Orc/name-nonbinary.json\": 501,\n\t\"./tables/race/Orc/name-woman.json\": 502,\n\t\"./tables/race/Orc/skin.json\": 503,\n\t\"./tables/race/Orc/skin/color.json\": 504,\n\t\"./tables/race/Orc/skin/index.json\": 505,\n\t\"./tables/race/Orc/surname.json\": 506,\n\t\"./tables/race/Tabaxi/deity.json\": 507,\n\t\"./tables/race/Tabaxi/index.json\": 508,\n\t\"./tables/race/Tabaxi/name-man.json\": 509,\n\t\"./tables/race/Tabaxi/name-nonbinary.json\": 510,\n\t\"./tables/race/Tabaxi/name-woman.json\": 511,\n\t\"./tables/race/Tabaxi/name/first.json\": 512,\n\t\"./tables/race/Tabaxi/name/index.json\": 513,\n\t\"./tables/race/Tabaxi/name/last.json\": 514,\n\t\"./tables/race/Tabaxi/name/noun.json\": 515,\n\t\"./tables/race/Tabaxi/name/number.json\": 516,\n\t\"./tables/race/Tabaxi/quirkObsession.json\": 517,\n\t\"./tables/race/Tabaxi/quirks.json\": 518,\n\t\"./tables/race/Tabaxi/skin.json\": 519,\n\t\"./tables/race/Tabaxi/skin/color.json\": 520,\n\t\"./tables/race/Tabaxi/skin/index.json\": 521,\n\t\"./tables/race/Tabaxi/skin/pattern.json\": 522,\n\t\"./tables/race/Tabaxi/skin/texture.json\": 523,\n\t\"./tables/race/Tiefling/deity.json\": 524,\n\t\"./tables/race/Tiefling/index.json\": 525,\n\t\"./tables/race/Tiefling/name-evil.json\": 526,\n\t\"./tables/race/Tiefling/name-good.json\": 527,\n\t\"./tables/race/Tiefling/name-man.json\": 528,\n\t\"./tables/race/Tiefling/name-nonbinary.json\": 529,\n\t\"./tables/race/Tiefling/name-woman.json\": 530,\n\t\"./tables/race/Tiefling/name/evil.json\": 531,\n\t\"./tables/race/Tiefling/name/good.json\": 532,\n\t\"./tables/race/Tiefling/name/index.json\": 533,\n\t\"./tables/race/Tiefling/name/neutral.json\": 534,\n\t\"./tables/race/Tiefling/name/unaligned.json\": 535,\n\t\"./tables/race/Tiefling/skin.json\": 536,\n\t\"./tables/race/Triton/deity.json\": 537,\n\t\"./tables/race/Triton/hair-color.json\": 538,\n\t\"./tables/race/Triton/hair.json\": 539,\n\t\"./tables/race/Triton/index.json\": 540,\n\t\"./tables/race/Triton/name-man.json\": 541,\n\t\"./tables/race/Triton/name-nonbinary.json\": 542,\n\t\"./tables/race/Triton/name-woman.json\": 543,\n\t\"./tables/race/Triton/quirks.json\": 544,\n\t\"./tables/race/Triton/skin.json\": 545,\n\t\"./tables/race/Triton/surname.json\": 546,\n\t\"./tables/race/Troglodyte/deity.json\": 547,\n\t\"./tables/race/Troglodyte/index.json\": 548,\n\t\"./tables/race/Troglodyte/name-man.json\": 549,\n\t\"./tables/race/Troglodyte/name-nonbinary.json\": 550,\n\t\"./tables/race/Troglodyte/name-woman.json\": 551,\n\t\"./tables/race/common/index.json\": 552,\n\t\"./tables/race/common/name-nonbinary.json\": 553,\n\t\"./tables/race/index.json\": 554,\n\t\"./tables/relationship/any.json\": 555,\n\t\"./tables/relationship/index.json\": 556,\n\t\"./tables/relationship/relative.json\": 557,\n\t\"./tables/relationship/status.json\": 558,\n\t\"./tables/traits/age.json\": 559,\n\t\"./tables/traits/age/additive.json\": 560,\n\t\"./tables/traits/age/bonusRegular.json\": 561,\n\t\"./tables/traits/age/bonusSmall.json\": 562,\n\t\"./tables/traits/age/index.json\": 563,\n\t\"./tables/traits/age/multiplier3.json\": 564,\n\t\"./tables/traits/age/multiplier6.json\": 565,\n\t\"./tables/traits/alignment/index.json\": 566,\n\t\"./tables/traits/alignment/tendancy.json\": 567,\n\t\"./tables/traits/alignmentMoral.json\": 568,\n\t\"./tables/traits/bodyPart.json\": 569,\n\t\"./tables/traits/bodyPart/extra/finger.json\": 570,\n\t\"./tables/traits/bodyPart/extra/index.json\": 571,\n\t\"./tables/traits/bodyPart/head.json\": 572,\n\t\"./tables/traits/bodyPart/head/index.json\": 573,\n\t\"./tables/traits/bodyPart/head/sided.json\": 574,\n\t\"./tables/traits/bodyPart/head/sidedPlural.json\": 575,\n\t\"./tables/traits/bodyPart/head/unsided.json\": 576,\n\t\"./tables/traits/bodyPart/index.json\": 577,\n\t\"./tables/traits/bodyPart/missing/eye.json\": 578,\n\t\"./tables/traits/bodyPart/missing/fingers.json\": 579,\n\t\"./tables/traits/bodyPart/missing/index.json\": 580,\n\t\"./tables/traits/bodyPart/missing/limb.json\": 581,\n\t\"./tables/traits/bodyPart/sided.json\": 582,\n\t\"./tables/traits/bodyPart/sidedPlural.json\": 583,\n\t\"./tables/traits/bodyPart/unsided.json\": 584,\n\t\"./tables/traits/brand.json\": 585,\n\t\"./tables/traits/degree/degree.json\": 586,\n\t\"./tables/traits/degree/degree2.json\": 587,\n\t\"./tables/traits/degree/index.json\": 588,\n\t\"./tables/traits/descriptor.json\": 589,\n\t\"./tables/traits/eyecolor.json\": 590,\n\t\"./tables/traits/face/attractiveness.json\": 591,\n\t\"./tables/traits/face/beard.json\": 592,\n\t\"./tables/traits/face/beard/index.json\": 593,\n\t\"./tables/traits/face/beard/length.json\": 594,\n\t\"./tables/traits/face/beard/shape.json\": 595,\n\t\"./tables/traits/face/index.json\": 596,\n\t\"./tables/traits/face/looks/bad.json\": 597,\n\t\"./tables/traits/face/looks/badModifier.json\": 598,\n\t\"./tables/traits/face/looks/good.json\": 599,\n\t\"./tables/traits/face/looks/goodModifier.json\": 600,\n\t\"./tables/traits/face/looks/index.json\": 601,\n\t\"./tables/traits/face/looks/normal.json\": 602,\n\t\"./tables/traits/face/looks/normalModifier.json\": 603,\n\t\"./tables/traits/face/shape.json\": 604,\n\t\"./tables/traits/hair.json\": 605,\n\t\"./tables/traits/hair/color.json\": 606,\n\t\"./tables/traits/hair/index.json\": 607,\n\t\"./tables/traits/hair/length.json\": 608,\n\t\"./tables/traits/hair/style.json\": 609,\n\t\"./tables/traits/height.json\": 610,\n\t\"./tables/traits/index.json\": 611,\n\t\"./tables/traits/modifier.json\": 612,\n\t\"./tables/traits/physical.json\": 613,\n\t\"./tables/traits/physical/index.json\": 614,\n\t\"./tables/traits/physical/piercingAmount.json\": 615,\n\t\"./tables/traits/physical/traits-1.json\": 616,\n\t\"./tables/traits/physical/traits-2.json\": 617,\n\t\"./tables/traits/skin/human.json\": 618,\n\t\"./tables/traits/skin/humanColor.json\": 619,\n\t\"./tables/traits/skin/index.json\": 620,\n\t\"./tables/traits/skin/nonhuman.json\": 621,\n\t\"./tables/traits/skin/nonhumanColor.json\": 622,\n\t\"./tables/traits/skin/scales.json\": 623,\n\t\"./tables/traits/skin/scalesColor.json\": 624,\n\t\"./tables/traits/skin/scalesTexture.json\": 625,\n\t\"./tables/traits/skin/textureSkin.json\": 626,\n\t\"./tables/traits/skin/tone.json\": 627,\n\t\"./tables/traits/smell/bad.json\": 628,\n\t\"./tables/traits/smell/good.json\": 629,\n\t\"./tables/traits/smell/index.json\": 630,\n\t\"./tables/traits/tattoo.json\": 631,\n\t\"./tables/traits/tattoo/animal.json\": 632,\n\t\"./tables/traits/tattoo/index.json\": 633,\n\t\"./tables/traits/tattoo/tattooadj.json\": 634,\n\t\"./tables/traits/tattoo/text.json\": 635,\n\t\"./tables/traits/weight.json\": 636\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 223;"],"sourceRoot":""}